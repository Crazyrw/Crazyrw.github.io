

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="æ¢¦æƒ³å¾ˆçè´µï¼ŒåŠªåŠ›ç‰¹åˆ«é…·ã€‚-xback">
  <meta name="author" content="Crazyrw">
  <meta name="keywords" content="">
  <title>Spring5 - Crazyrw&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":true,"baidu":"7d2fd3d56f2287a0bda354d214258de6","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Crazyrw's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/images/bg/post.webp') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Spring5">
              
            </span>

            <p class="h2"><a id="rainbow" href=''>ğŸŒˆ è·å–ä¸­...</a></p>
            <script>
              fetch('https://api.eatrice.top')
                .then(response => response.json())
                .then(data => {
                  var rainbow = document.getElementById('rainbow');
                  rainbow.innerHTML = data.Content;
                  rainbow.href = "https://rainbow.eatrice.top/?ID=" + data.ID;
                })
                .catch(console.error)
              </script>


            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-11-27 22:58" pubdate>
        November 27, 2020 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      19.6k å­—
    </span>
  

  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Spring5</h1>
            
              <p class="note note-info">
                
                  æœ¬æ–‡æœ€åæ›´æ–°äºï¼š24 days ago
                
              </p>
            
            <div class="markdown-body">
              <h2 id="1-Spring"><a href="#1-Spring" class="headerlink" title="1. Spring"></a>1. Spring</h2><h3 id="1-1-ç®€ä»‹"><a href="#1-1-ç®€ä»‹" class="headerlink" title="1.1 ç®€ä»‹"></a>1.1 ç®€ä»‹</h3><ul>
<li><p>Spring:æ˜¥å¤©-&gt;ç»™è½¯ä»¶è¡Œä¸šå¸¦æ¥äº†æ˜¥å¤©</p>
</li>
<li><p>2002ï¼Œé¦–æ¬¡æ¨å‡ºäº†springæ¡†æ¶çš„é›å½¢:interface21æ¡†æ¶</p>
</li>
<li><p>Springæ¡†æ¶å³ä»¥interface21æ¡†æ¶ä¸ºåŸºç¡€ï¼Œç»è¿‡é‡æ–°è®¾è®¡ï¼Œå¹¶ä¸æ–­ä¸°å¯Œå…¶å†…æ¶µï¼Œäº2004å¹´3æœˆ24 å‘å¸ƒäº†1.0æ­£å¼ç‰ˆæœ¬ã€‚</p>
</li>
<li><p><strong><em>Rod Johnson</em></strong>   SpringFrameworkåˆ›å§‹äººï¼Œè‘—åä½œè€…ã€‚ä»–æ˜¯<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%82%89%E5%B0%BC%E5%A4%A7%E5%AD%A6">æ‚‰å°¼å¤§å­¦</a>çš„åšå£«ï¼Œç„¶è€Œä»–çš„ä¸“ä¸šä¸æ˜¯è®¡ç®—æœºï¼Œè€Œæ˜¯éŸ³ä¹å­¦ã€‚</p>
</li>
<li><p>Springç†å¿µï¼šä½¿ç°æœ‰çš„æŠ€æœ¯æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ª<strong>å¤§æ‚çƒ©</strong>ï¼Œæ•´åˆäº†ç°æœ‰çš„æŠ€æœ¯æ¡†æ¶ã€‚</p>
</li>
</ul>
<ul>
<li>SSHï¼šStruct2 + Spring + Hinernateï¼ˆå…¨è‡ªåŠ¨åŒ–ï¼‰</li>
<li>SSMï¼šSpringMVC + Spring + MyBatisï¼ˆåŠè‡ªåŠ¨åŒ–ï¼‰</li>
</ul>
<p>å®˜ç½‘åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://spring.io/projects/spring-framework#learn">https://spring.io/projects/spring-framework#learn</a></p>
<p>å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/reference/html/overview.html#overview">https://docs.spring.io/spring-framework/docs/current/reference/html/overview.html#overview</a></p>
<p>ä¸‹è½½zipåœ°å€ï¼š<a target="_blank" rel="noopener" href="https://repo.spring.io/release/org/springframework/spring/">https://repo.spring.io/release/org/springframework/spring/</a></p>
<p>GitHubï¼š<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-framework">https://github.com/spring-projects/spring-framework</a></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>

<h3 id="1-2-ä¼˜ç‚¹"><a href="#1-2-ä¼˜ç‚¹" class="headerlink" title="1.2 ä¼˜ç‚¹"></a>1.2 ä¼˜ç‚¹</h3><ul>
<li>Springæ˜¯ä¸€ä¸ªå¼€æºçš„å…è´¹çš„æ¡†æ¶ï¼ˆå®¹å™¨ï¼‰ï¼</li>
<li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ã€éå…¥ä¾µå¼çš„æ¡†æ¶ï¼ï¼ˆéå…¥ä¾µå¼ï¼šå¼•å…¥ä¸å¯¹é¡¹ç›®çš„å…¶ä»–ä¸œè¥¿é€ æˆå½±å“ï¼‰</li>
<li>æ§åˆ¶åè½¬ï¼ˆIOCï¼‰ã€é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰ï¼</li>
<li>æ”¯æŒäº‹åŠ¡çš„å¤„ç†ï¼Œå¯¹æ¡†æ¶æ•´åˆçš„æ”¯æŒï¼</li>
</ul>
<p>==<strong>æ€»ç»“ï¼š</strong> Springå°±æ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬ï¼ˆIOCï¼‰å’Œé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰çš„æ¡†æ¶ï¼==</p>
<h3 id="1-3-ç»„æˆ"><a href="#1-3-ç»„æˆ" class="headerlink" title="1.3 ç»„æˆ"></a>1.3 ç»„æˆ</h3><p><img src="/images/Spring5/1078856-20170205160357354-490660449.gif" srcset="/img/loading.gif" alt="img"></p>
<h3 id="1-4-æ‰©å±•"><a href="#1-4-æ‰©å±•" class="headerlink" title="1.4 æ‰©å±•"></a>1.4 æ‰©å±•</h3><p><img src="/images/Spring5/image-20201114221151976.png" srcset="/img/loading.gif" alt="image-20201114221151976"></p>
<p>Spring:ç°ä»£åŒ–çš„å¼€å‘!è¯´ç™½äº†å°±æ˜¯åŸºäºSpringçš„å¼€å‘ï¼</p>
<ul>
<li>Build Anything æ„å»ºä¸€åˆ‡</li>
<li>Coordinate Anything åè°ƒä¸€åˆ‡</li>
<li>Connect Everything è¿æ¥ä¸€åˆ‡</li>
</ul>
<ol>
<li><strong>Spring Boot</strong></li>
</ol>
<ul>
<li>ä¸€ä¸ªå¿«é€Ÿå¼€å‘çš„è„šæ‰‹æ¶</li>
<li>åŸºäºSpringBootå¯ä»¥å¿«é€Ÿçš„å¼€å‘å•ä¸ªå¾®æœåŠ¡ã€‚</li>
<li>çº¦å®šå¤§äºé…ç½®</li>
</ul>
<ol start="2">
<li><strong>Spring Cloud</strong></li>
</ol>
<ul>
<li>SpringCloudæ˜¯åŸºäºSpringBootå®ç°çš„</li>
</ul>
<p>å› ä¸ºç°åœ¨å¤§å¤šæ•°å…¬å¸éƒ½åœ¨ä½¿ç”¨SpringBootè¿›è¡Œå¿«é€Ÿå¼€å‘ï¼Œå­¦ä¹ SpringBootçš„å‰æï¼Œéœ€è¦å®Œå…¨æŒæ¡Springä»¥åŠSpringMVCã€‚æ‰¿ä¸Šå¯ä¸‹çš„ä½œç”¨ï¼</p>
<p><strong>å¼Šç«¯ï¼šå‘å±•äº†å¤ªä¹…ä¹‹åï¼Œè¿èƒŒäº†åŸæ¥çš„ç†å¿µï¼é…ç½®ååˆ†ç¹çï¼Œäººç§°â€œé…ç½®åœ°ç‹±â€ã€‚</strong></p>
<h2 id="2-IOCç†è®ºæ¨å¯¼"><a href="#2-IOCç†è®ºæ¨å¯¼" class="headerlink" title="2. IOCç†è®ºæ¨å¯¼"></a>2. IOCç†è®ºæ¨å¯¼</h2><p><strong>å¼•å…¥èƒŒæ™¯ï¼š</strong></p>
<p>åœ¨ä¹‹å‰çš„æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬å®ç°ä¸šåŠ¡ï¼Œä¸€èˆ¬åˆ†ä¸ºDaoæ¥å£ã€Daoæ¥å£å®ç°ç±»ã€Serviceæ¥å£ã€Serviceå®ç°ç±»ã€‚</p>
<p>å‡è®¾UserDao.javaã€UserDaoImpl.javaã€UserService.javaã€UserServiceImpl.java</p>
<p>å¦‚æœUserDaoæ¥å£å¯¹åº”ä¸€ä¸ªå®ç°ç±»ï¼Œé‚£ä¹ˆUserServiceä¸­ä¸€èˆ¬ä¼šå†™ï¼š</p>
<pre><code class="hljs java">UserDao userDao = <span class="hljs-keyword">new</span> UserDaoImpl()</code></pre>

<p>ç”¨æˆ·ä½¿ç”¨æ—¶ç›´æ¥è°ƒç”¨serviceï¼Œæ˜¯è°ƒç”¨ä¸åˆ°daoå±‚çš„ã€‚å› æ­¤ï¼Œç¨‹åºä¼šä¸€ç›´é»˜è®¤éƒ½æ˜¯è°ƒç”¨çš„UserDaoImplå®ç°ç±»ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœUserDaoæœ‰å¤šä¸ªå®ç°ç±»å‘¢ï¼Ÿä¾‹å¦‚ï¼ŒUserDaoImplã€UserDaoMySqlImplã€UserDaoOracleImpç­‰ã€‚</p>
<p>å¦‚æœç¨‹åºå‘˜æ ¹æ®éœ€æ±‚æ”¹åŠ¨serviceä»£ç ï¼Œå°±ä¼šæ˜¾å¾—éå¸¸çš„ä¸çµæ´»ï¼š</p>
<pre><code class="hljs java">UserDao userDao = <span class="hljs-keyword">new</span> UserDaoMySqlImpl();</code></pre>

<img src="/images/Spring5/image-20201115105127424.png" srcset="/img/loading.gif" alt="image-20201115105127424" style="zoom:50%;" />

<hr>
<p><strong>åŸºäºè¿™ï¼Œæˆ‘ä»¬æƒ³åˆ°ï¼Œå¯ä»¥ä½¿ç”¨setè¿›è¡ŒåŠ¨æ€å®ç°å€¼çš„æ³¨å…¥ï¼<img src="/images/Spring5/image-20201115103836967.png" srcset="/img/loading.gif" alt="image-20201115103836967"></strong></p>
<pre><code class="hljs java"><span class="hljs-keyword">private</span> UserDao userDao;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserDao</span><span class="hljs-params">(UserDao userDao)</span></span>&#123;
	<span class="hljs-keyword">this</span>.userDao = userDao;
&#125;</code></pre>

<img src="/images/Spring5/image-20201115105233723.png" srcset="/img/loading.gif" alt="image-20201115105233723" style="zoom:50%;" />

<hr>
<p>åœ¨ä¹‹å‰çš„ä¸šåŠ¡ä¸­ï¼Œç”¨æˆ·çš„éœ€æ±‚å¯èƒ½ä¼šå½±å“æˆ‘ä»¬åŸæ¥çš„ä»£ç ï¼Œæˆ‘ä»¬æ ¹æ®ç”¨æˆ·çš„éœ€æ±‚å»ä¿®æ”¹æºä»£ç ã€‚å¦‚æœç¨‹åºä»£ç é‡ååˆ†å¤§ï¼Œä¿®æ”¹ä¸€æ¬¡çš„æˆæœ¬ä»£ä»·ååˆ†æ˜‚è´µï¼</p>
<p>ä½¿ç”¨setä¹‹åï¼Œå‘ç”Ÿäº†é©å‘½æ€§çš„å˜åŒ–ï¼</p>
<ul>
<li>ä¹‹å‰ï¼Œç¨‹åºæ˜¯ä¸»åŠ¨åˆ›å»ºå¯¹è±¡ï¼Œæ§åˆ¶æƒåœ¨ç¨‹åºå‘˜èº«ä¸Šï¼</li>
<li>ä½¿ç”¨setæ³¨å…¥ä¹‹åï¼Œç¨‹åºä¸å†å…·æœ‰ä¸»åŠ¨æ€§ï¼Œè€Œæ˜¯å˜æˆäº†è¢«åŠ¨çš„æ¥å—å¯¹è±¡ï¼</li>
</ul>
<hr>
<p>è¿™ç§æ€æƒ³ä»æœ¬è´¨ä¸Šè§£å†³äº†é—®é¢˜ï¼Œæˆ‘ä»¬ç¨‹åºå‘˜ä¸ç”¨å†å»ç®¡ç†å¯¹è±¡çš„åˆ›å»ºã€‚ç³»ç»Ÿçš„è€¦åˆæ€§å¤§å¤§é™ä½ï¼Œå¯ä»¥æ›´åŠ ä¸“æ³¨çš„åœ¨ä¸šåŠ¡çš„å®ç°ä¸Šï¼</p>
<p>è¿™æ˜¯IOCçš„åŸå‹ï¼ï¼ˆIOCï¼šæ§åˆ¶åè½¬ï¼‰</p>
<h2 id="3-IOCæœ¬è´¨"><a href="#3-IOCæœ¬è´¨" class="headerlink" title="3. IOCæœ¬è´¨"></a>3. IOCæœ¬è´¨</h2><p><strong>æ§åˆ¶åè½¬IOCï¼ˆInversion of Controlï¼‰ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼ŒDIï¼ˆä¾èµ–æ³¨å…¥ï¼‰æ˜¯å®ç°IOCçš„ä¸€ç§æ–¹æ³•ã€‚</strong></p>
<p>åœ¨æ²¡æœ‰IOCçš„ç¨‹åºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå¯¹è±¡çš„åˆ›å»ºä¸å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å®Œå…¨ç¡¬ç¼–ç åœ¨ç¨‹åºä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºç”±ç¨‹åºè‡ªå·±æ§åˆ¶ï¼Œæ§åˆ¶åè½¬åå°†å¯¹è±¡çš„åˆ›å»ºè½¬ç§»ç»™ç¬¬ä¸‰æ–¹ï¼Œä¸ªäººè®¤ä¸ºæ‰€è°“æ§åˆ¶åè½¬å°±æ˜¯ï¼šè·å¾—ä¾èµ–å¯¹è±¡çš„æ–¹å¼åè½¬äº†ã€‚</p>
<img src="/images/Spring5/6a63f6246b600c337b73ab94174c510fd9f9a160" srcset="/img/loading.gif" alt="img" style="zoom:50%;" />

<p><strong>IOCæ˜¯Springæ¡†æ¶çš„æ ¸å¿ƒå†…å®¹ï¼Œ</strong>ä½¿ç”¨å¾ˆå¤šæ–¹å¼å®Œç¾çš„å®ç°äº†IOCï¼Œå¯ä»¥ä½¿ç”¨XMLé…ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£ï¼Œæ–°ç‰ˆæœ¬çš„Springä¹Ÿå¯ä»¥é›¶é…ç½®å®ç°IOCã€‚</p>
<p>Springå®¹å™¨åœ¨åˆå§‹åŒ–æ—¶å…ˆè¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æˆ–å…ƒæ•°æ®åˆ›å»ºä¸ç»„ç»‡å¯¹è±¡å­˜å…¥å®¹å™¨ä¸­ï¼Œç¨‹åºä½¿ç”¨æ—¶å†ä»IOCå®¹å™¨ä¸­å–å‡ºéœ€è¦çš„å¯¹è±¡ã€‚</p>
<img src="/images/Spring5/image-20201115111043907.png" srcset="/img/loading.gif" alt="image-20201115111043907" style="zoom:50%;" />

<p>é‡‡ç”¨XMLæ–¹å¼é…ç½®Beançš„æ—¶å€™ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯æ˜¯å’Œå®ç°åˆ†ç¦»çš„ï¼Œè€Œé‡‡ç”¨æ³¨è§£çš„æ–¹å¼å¯ä»¥æŠŠä¸¤è€…åˆä¸ºä¸€ä½“ï¼ŒBeançš„å®šä¹‰ä¿¡æ¯ç›´æ¥ä»¥æ³¨è§£çš„å½¢å¼å®šä¹‰åœ¨å®ç°ç±»ä¸­ï¼Œä»è€Œè¾¾åˆ°é›¶é…ç½®çš„ç›®çš„ã€‚</p>
<p><strong>æ§åˆ¶åè½¬æ˜¯é€šè¿‡æè¿°ï¼ˆXMLæˆ–æ³¨è§£ï¼‰å¹¶é€šè¿‡ç¬¬ä¸‰æ–¹å»ç”Ÿäº§æˆ–è·å–ç‰¹å®šå¯¹è±¡çš„æ–¹å¼ã€‚åœ¨Springä¸­å®ç°æ§åˆ¶åè½¬çš„æ˜¯IOCå®¹å™¨ï¼Œå…¶å®ç°æ–¹æ³•æ˜¯ä¾èµ–æ³¨å…¥DIï¼ˆDependency Injection, DIï¼‰</strong></p>
<h4 id="4-HelloSpring"><a href="#4-HelloSpring" class="headerlink" title="4. HelloSpring"></a>4. HelloSpring</h4><p>æˆ‘ä»¬ç†è§£äº†IOCçš„åŸºæœ¬æ€æƒ³ï¼Œæˆ‘ä»¬ç°åœ¨æ¥çœ‹ä¸‹Springçš„åº”ç”¨ï¼š</p>
<ol>
<li>å¯¼å…¥jaråŒ…</li>
</ol>
<blockquote>
<p>æ³¨ : spring éœ€è¦å¯¼å…¥commons-loggingè¿›è¡Œæ—¥å¿—è®°å½• . æˆ‘ä»¬åˆ©ç”¨maven , ä»–ä¼šè‡ªåŠ¨ä¸‹è½½å¯¹åº”çš„ä¾èµ–é¡¹ .</p>
</blockquote>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework/spring-webmvc --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>

<ol start="2">
<li>ç¼–å†™Helloå®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hello</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> name;
    &#125;
  <span class="hljs-comment">//ä¸€å®šè¦æœ‰setæ–¹æ³•ï¼Œä¸ç„¶beans.xmlä¸­æ— æ³•å®ç°èµ‹å€¼</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span>+ name );
    &#125;
&#125;</code></pre>

<ol start="3">
<li>ç¼–å†™beans.xml</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!--ä½¿ç”¨Springæ¥åˆ›å»ºå¯¹è±¡ï¼Œåœ¨Springä¸­è¿™äº›éƒ½å«åšBean--&gt;</span>
    <span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">        idï¼šç›¸å½“äºå˜é‡åï¼Œclassåˆ™æ˜¯æƒ³è¦åˆ›å»ºçš„å¯¹è±¡çš„ç±»å‹</span>
<span class="hljs-comment">        property : å¯¹è±¡çš„å±æ€§ï¼Œvalueè®¾ç½®å…·ä½“çš„å€¼ï¼Œ</span>
<span class="hljs-comment">				å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡åˆ™ä½¿ç”¨refæ¥è®¾ç½®ï¼ŒrefæŒ‡å‘çš„æ˜¯beans.xmlä¸­å·²ç»å®šä¹‰å¥½çš„å¯¹è±¡ã€‚</span>
<span class="hljs-comment">    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="4">
<li>æµ‹è¯•ï¼š</li>
</ol>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);
        <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
        Hello hello = (Hello) applicationContext.getBean(<span class="hljs-string">&quot;hello&quot;</span>);

        System.out.println(hello.toString());

    &#125;</code></pre>

<img src="/images/Spring5/image-20201115132219497.png" srcset="/img/loading.gif" alt="image-20201115132219497" style="zoom:50%;" />

<hr>
<p><strong>æ€è€ƒï¼š</strong></p>
<ul>
<li>Hello å¯¹è±¡æ˜¯è°åˆ›å»ºçš„ ?             hello å¯¹è±¡æ˜¯ç”±Springåˆ›å»ºçš„</li>
<li>Hello å¯¹è±¡çš„å±æ€§æ˜¯æ€ä¹ˆè®¾ç½®çš„ ?     hello å¯¹è±¡çš„å±æ€§æ˜¯ç”±Springå®¹å™¨è®¾ç½®çš„</li>
</ul>
<p>è¿™ä¸ªè¿‡ç¨‹å°±å«æ§åˆ¶åè½¬ :</p>
<ul>
<li><strong>æ§åˆ¶</strong> : è°æ¥æ§åˆ¶å¯¹è±¡çš„åˆ›å»º , ä¼ ç»Ÿåº”ç”¨ç¨‹åºçš„å¯¹è±¡æ˜¯ç”±ç¨‹åºæœ¬èº«æ§åˆ¶åˆ›å»ºçš„ , ä½¿ç”¨Springå , å¯¹è±¡æ˜¯ç”±Springæ¥åˆ›å»ºçš„</li>
<li><strong>åè½¬</strong> : ç¨‹åºæœ¬èº«ä¸åˆ›å»ºå¯¹è±¡ , è€Œå˜æˆè¢«åŠ¨çš„æ¥æ”¶å¯¹è±¡ .</li>
</ul>
<p><strong>ä¾èµ–æ³¨å…¥</strong> : å°±æ˜¯åˆ©ç”¨setæ–¹æ³•æ¥è¿›è¡Œæ³¨å…¥çš„.</p>
<p> <strong>IOCæ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œç”±ä¸»åŠ¨çš„ç¼–ç¨‹å˜æˆè¢«åŠ¨çš„æ¥æ”¶ã€‚</strong></p>
<p>å¯ä»¥é€šè¿‡newClassPathXmlApplicationContextå»æµè§ˆä¸€ä¸‹åº•å±‚æºç  ã€‚</p>
<p>==ä¹‹å‰è¯´æ˜¯ç”±ç”¨æˆ·ä¸»åŠ¨è¿›è¡Œè®¾ç½®å¯¹è±¡ï¼Œå…¶å®é…ç½®æ–‡ä»¶å°±æ˜¯ç›¸å½“äºç”¨æˆ·çš„ä¸€ä¸ªè§’è‰²ï¼Œè®©ç”¨æˆ·å»ä¿®æ”¹ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿œè¿œæ¯”ä¿®æ”¹æºä»£ç æ›´ç®€å•ï¼ï¼==</p>
<p><strong>OKï¼Œåˆ°äº†ç°åœ¨ï¼Œæˆ‘ä»¬å½»åº•ä¸ç”¨åœ¨ç¨‹åºä¸­ä¿®æ”¹ä»£ç å»å®ç°ä¸åŒçš„æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨xmlé…ç½®æ–‡ä»¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œæ‰€è°“çš„IOCï¼Œä¸€å¥è¯ï¼šå¯¹è±¡ç”±Springåˆ›å»ºã€ç®¡ç†ã€è£…é…ã€‚</strong></p>
<h2 id="4-IOCåˆ›å»ºå¯¹è±¡æ–¹å¼"><a href="#4-IOCåˆ›å»ºå¯¹è±¡æ–¹å¼" class="headerlink" title="4. IOCåˆ›å»ºå¯¹è±¡æ–¹å¼"></a>4. IOCåˆ›å»ºå¯¹è±¡æ–¹å¼</h2><h3 id="4-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#4-1-é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="4.1 é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>4.1 é€šè¿‡æ— å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h3><p><strong>æ— å‚æ„é€ æ˜¯é»˜è®¤çš„ï¼</strong></p>
<ol>
<li>å®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hello</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Hello</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;æ— å‚æ„é€ &quot;</span>);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> name;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span>+ name );
    &#125;
&#125;</code></pre>

<ol start="2">
<li>beans.xml</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);
        <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
        Hello hello = (Hello) applicationContext.getBean(<span class="hljs-string">&quot;hello&quot;</span>);

        <span class="hljs-comment">//System.out.println(hello.toString());</span>

    &#125;</code></pre>

<img src="/images/Spring5/image-20201115163212571.png" srcset="/img/loading.gif" alt="image-20201115163212571" style="zoom:50%;" />

<img src="/images/Spring5/image-20201115163454860.png" srcset="/img/loading.gif" alt="image-20201115163454860" style="zoom:50%;" />

<p>é€šè¿‡ç»“æœå‘ç°ï¼Œåœ¨è°ƒç”¨show()æ–¹æ³•ä¹‹å‰ï¼ŒHelloå¯¹è±¡åœ¨getBean()æ—¶å·²ç»é€šè¿‡æ— å‚æ„é€ åˆå§‹åŒ–äº†ï¼</p>
<h3 id="4-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"><a href="#4-2-é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º" class="headerlink" title="4.2 é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º"></a>4.2 é€šè¿‡æœ‰å‚æ„é€ æ–¹æ³•æ¥åˆ›å»º</h3><ol>
<li>å®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hello</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Hello</span><span class="hljs-params">(String name)</span></span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
        System.out.println(<span class="hljs-string">&quot;æœ‰å‚æ„é€ ï¼šname= &quot;</span>+<span class="hljs-keyword">this</span>.name);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> name;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span>+ name );
    &#125;
&#125;</code></pre>

<ol start="2">
<li>beans.xmlï¼ˆæœ‰ä¸‰ç§ç¼–å†™æ–¹å¼ï¼‰</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç¬¬ä¸€ç§æ ¹æ®indexå‚æ•°ä¸‹æ ‡è®¾ç½® --&gt;</span>
  <span class="hljs-comment">&lt;!-- indexæŒ‡æ„é€ æ–¹æ³• , ä¸‹æ ‡ä»0å¼€å§‹ --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;spring1&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
  <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
  ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);
  <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
  Hello hello = (Hello) applicationContext.getBean(<span class="hljs-string">&quot;hello&quot;</span>);
  hello.show();
&#125;</code></pre>

<img src="/images/Spring5/image-20201115164314916.png" srcset="/img/loading.gif" alt="image-20201115164314916" style="zoom:50%;" />

<p>å¦å¤–ä¸¤ç§ç¼–å†™æ–¹å¼ï¼š</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç¬¬äºŒç§æ ¹æ®å‚æ•°åå­—è®¾ç½® --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;spring2&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½® --&gt;</span>
  <span class="hljs-comment">&lt;!--ä¸å»ºè®®ä½¿ç”¨ï¼Œå¦‚æœä¸¤ä¸ªéƒ½æ˜¯Stringç±»å‹å°±ä¸å¥½äº†--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;spring3&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<hr>
<p>ç°åœ¨æˆ‘ä»¬æµ‹è¯•ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œ<img src="/images/Spring5/image-20201115165603497.png" srcset="/img/loading.gif" alt="image-20201115165603497"></p>
<ol>
<li>æˆ‘ä»¬å†åˆ›å»ºä¸€ä¸ªå®ä½“ç±»User.java</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;Useræ— å‚æ„é€ &quot;</span>);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> name;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;Hello,&quot;</span>+ name );
    &#125;
&#125;</code></pre>

<ol start="2">
<li>åœ¨beans.xmlä¸­æ³¨å…¥</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½® --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;spring3&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<p>æµ‹è¯•ï¼Œæˆ‘ä»¬åªget Helloå¯¹è±¡ï¼Œçœ‹ä¸€ä¸‹ç»“æœ</p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;beans.xml&quot;</span>);
        <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
        Hello hello = (Hello) applicationContext.getBean(<span class="hljs-string">&quot;hello&quot;</span>);
        hello.show();
    &#125;</code></pre>

<img src="/images/Spring5/image-20201115165819922.png" srcset="/img/loading.gif" alt="image-20201115165819922" style="zoom:50%;" />

<p>Userç«Ÿç„¶ä¹Ÿè¢«å®ä¾‹åŒ–äº†ï¼Ÿï¼ï¼</p>
<p>==åŸæ¥ï¼Œ<strong>åœ¨é…ç½®æ–‡ä»¶åŠ è½½çš„æ—¶å€™ã€‚å…¶ä¸­ç®¡ç†çš„å¯¹è±¡éƒ½å·²ç»åˆå§‹åŒ–äº†ï¼</strong> ä¹Ÿå°±æ˜¯è¯´ï¼Œé…ç½®æ–‡ä»¶åœ¨åŠ è½½çš„æ—¶å€™ï¼Œæ‰€æœ‰æ³¨å†Œåˆ°é‡Œé¢çš„å¯¹è±¡éƒ½è¢«å®ä¾‹åŒ–å¥½äº†ï¼Œå°±ç­‰ç€getBean()è°ƒç”¨äº†ï¼ï¼==<img src="/images/Spring5/image-20201115171224430.png" srcset="/img/loading.gif" alt="image-20201115171224430"></p>
<h2 id="5-Springé…ç½®è¯´æ˜"><a href="#5-Springé…ç½®è¯´æ˜" class="headerlink" title="5. Springé…ç½®è¯´æ˜"></a>5. Springé…ç½®è¯´æ˜</h2><h3 id="5-1-åˆ«å"><a href="#5-1-åˆ«å" class="headerlink" title="5.1 åˆ«å"></a>5.1 åˆ«å</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Hello&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ç¬¬ä¸‰ç§æ ¹æ®å‚æ•°ç±»å‹è®¾ç½® --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;java.lang.String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;spring3&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Spring&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;hello2&quot;</span>/&gt;</span></code></pre>

<p>èµ·åˆ«åä¹‹åï¼Œä¸¤ä¸ªåå­—éƒ½å¯ä»¥ç”¨ï¼Œéƒ½å¯ä»¥é€šè¿‡getBean()è·å–åˆ°Beanã€‚</p>
<h3 id="5-2-Beançš„é…ç½®"><a href="#5-2-Beançš„é…ç½®" class="headerlink" title="5.2 Beançš„é…ç½®"></a>5.2 Beançš„é…ç½®</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;user2,user3 user4;user5&quot;</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
<span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">         id æ˜¯beançš„æ ‡è¯†ç¬¦,è¦å”¯ä¸€,å¦‚æœæ²¡æœ‰é…ç½®id,nameå°±æ˜¯é»˜è®¤æ ‡è¯†ç¬¦</span>
<span class="hljs-comment">            nameå°±æ˜¯åˆ«åï¼Œæ‰€ä»¥è¯´aliasæ ‡ç­¾å°±æ²¡å•¥ç”¨äº†ï¼Œnameä¸­å¯ä»¥æœ‰å¾ˆå¤šåˆ«åï¼Œç©ºæ ¼ã€é€—å·ã€åˆ†å·  åˆ†éš”éƒ½å¯ä»¥</span>
<span class="hljs-comment">         classæ˜¯beançš„å…¨é™å®šå=åŒ…å+ç±»å</span>
<span class="hljs-comment">    --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">alias</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hello&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;hello2&quot;</span>/&gt;</span></code></pre>

<h3 id="5-3-import"><a href="#5-3-import" class="headerlink" title="5.3 import"></a>5.3 import</h3><p>importï¼Œä¸€èˆ¬ç”¨äºå›¢é˜Ÿå¼€å‘ä½¿ç”¨ï¼Œå®ƒå¯ä»¥å°†å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¼å…¥åˆå¹¶ä¸ºä¸€ä¸ªã€‚</p>
<img src="/images/Spring5/image-20201115174123736.png" srcset="/img/loading.gif" alt="image-20201115174123736" style="zoom:50%;" />

<p>å°†beans.xmlå¯¼å…¥åˆ°æ€»çš„é…ç½®æ–‡ä»¶ä¸­ï¼ŒapplicationContext.xmlã€‚</p>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥ä½¿ç”¨æ€»çš„æ˜¯applicationContext.xml</p>
<img src="/images/Spring5/image-20201115174337377.png" srcset="/img/loading.gif" alt="image-20201115174337377" style="zoom:50%;" />

<h2 id="6-DIä¾èµ–æ³¨å…¥"><a href="#6-DIä¾èµ–æ³¨å…¥" class="headerlink" title="6. DIä¾èµ–æ³¨å…¥"></a>6. DIä¾èµ–æ³¨å…¥</h2><h3 id="6-1-æ„é€ å™¨æ³¨å…¥"><a href="#6-1-æ„é€ å™¨æ³¨å…¥" class="headerlink" title="6.1 æ„é€ å™¨æ³¨å…¥"></a>6.1 æ„é€ å™¨æ³¨å…¥</h3><p>å‰é¢å·²ç»è¯´è¿‡</p>
<img src="/images/Spring5/image-20201116140844471.png" srcset="/img/loading.gif" alt="image-20201116140844471" style="zoom:50%;" />

<h3 id="6-2-Setteræ³¨å…¥â€”å±æ€§æ³¨å…¥ã€é‡ç‚¹ã€‘"><a href="#6-2-Setteræ³¨å…¥â€”å±æ€§æ³¨å…¥ã€é‡ç‚¹ã€‘" class="headerlink" title="6.2 Setteræ³¨å…¥â€”å±æ€§æ³¨å…¥ã€é‡ç‚¹ã€‘"></a>6.2 Setteræ³¨å…¥â€”å±æ€§æ³¨å…¥ã€é‡ç‚¹ã€‘</h3><ul>
<li>ä¾èµ–ï¼šæŒ‡Beanå¯¹è±¡çš„åˆ›å»ºä¾èµ–äºå®¹å™¨ . Beanå¯¹è±¡çš„ä¾èµ–èµ„æº .</li>
<li>æ³¨å…¥ï¼šBeanå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œç”±å®¹å™¨æ¥æ³¨å…¥ã€‚</li>
</ul>
<p>è¦æ±‚è¢«æ³¨å…¥çš„å±æ€§ï¼Œå¿…é¡»æœ‰setæ–¹æ³• ï¼Œsetæ–¹æ³•çš„æ–¹æ³•åç”±set + å±æ€§é¦–å­—æ¯å¤§å†™ ï¼Œå¦‚æœå±æ€§æ˜¯booleanç±»å‹ ï¼Œæ²¡æœ‰setæ–¹æ³• ï¼Œæ˜¯ is ã€‚</p>
<p>æµ‹è¯•POJOç±»ï¼š</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Address</span> </span>&#123;

    <span class="hljs-keyword">private</span> String address;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getAddress</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> address;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAddress</span><span class="hljs-params">(String address)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.address = address;
    &#125;
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.pojo;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.Properties;
<span class="hljs-keyword">import</span> java.util.Set;

<span class="hljs-comment">//ä½¿ç”¨æ³¨è§£æ¥ä»£æ›¿æ‰€æœ‰çš„getter setter</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> Address address;
    <span class="hljs-keyword">private</span> String[] books;
    <span class="hljs-keyword">private</span> List&lt;String&gt; hobbys;
    <span class="hljs-keyword">private</span> Map&lt;String,String&gt; card;
    <span class="hljs-keyword">private</span> Set&lt;String&gt; games;<span class="hljs-comment">//é›†åˆ</span>
    <span class="hljs-keyword">private</span> String wife;<span class="hljs-comment">//ç©ºæŒ‡é’ˆ</span>
    <span class="hljs-keyword">private</span> Properties info;<span class="hljs-comment">//é…ç½®ç±»</span>


    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">show</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;name=&quot;</span>+ name
                + <span class="hljs-string">&quot;,address=&quot;</span>+ address.getAddress()
                + <span class="hljs-string">&quot;,books=&quot;</span>
        );
        <span class="hljs-keyword">for</span> (String book:books)&#123;
            System.out.print(<span class="hljs-string">&quot;&lt;&lt;&quot;</span>+book+<span class="hljs-string">&quot;&gt;&gt;\t&quot;</span>);
        &#125;
        System.out.println(<span class="hljs-string">&quot;\nçˆ±å¥½:&quot;</span>+hobbys);

        System.out.println(<span class="hljs-string">&quot;card:&quot;</span>+card);

        System.out.println(<span class="hljs-string">&quot;games:&quot;</span>+games);

        System.out.println(<span class="hljs-string">&quot;wife:&quot;</span>+wife);

        System.out.println(<span class="hljs-string">&quot;info:&quot;</span>+info);

    &#125;
&#125;
</code></pre>

<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span>
  
  
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<h4 id="6-2-1-å¸¸é‡æ³¨å…¥"><a href="#6-2-1-å¸¸é‡æ³¨å…¥" class="headerlink" title="6.2.1 å¸¸é‡æ³¨å…¥"></a>6.2.1 å¸¸é‡æ³¨å…¥</h4><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Student&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--1.æ™®é€šå€¼æ³¨å…¥--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä»»æ–‡&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<p>æµ‹è¯•ç±»ï¼š</p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
  <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
  ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
  <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
  Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
  System.out.println(student.getName());
&#125;</code></pre>

<p>//output: ä»»æ–‡</p>
<h4 id="6-2-2-Beanæ³¨å…¥"><a href="#6-2-2-Beanæ³¨å…¥" class="headerlink" title="6.2.2 Beanæ³¨å…¥"></a>6.2.2 <strong>Beanæ³¨å…¥</strong></h4><p>(Address)</p>
<p><strong>æ³¨æ„ç‚¹ï¼šè¿™é‡Œçš„å€¼æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œref</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Address&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;é’å²›&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Student&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--1.æ™®é€šå€¼æ³¨å…¥--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä»»æ–‡&quot;</span>/&gt;</span>
  <span class="hljs-comment">&lt;!--2. Beanæ³¨å…¥--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;address&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
  <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
  ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
  <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
  Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
  System.out.println(student.getAddress().getAddress());
&#125;</code></pre>

<p>//output: é’å²›</p>
<h4 id="6-2-3-æ•°ç»„æ³¨å…¥"><a href="#6-2-3-æ•°ç»„æ³¨å…¥" class="headerlink" title="6.2.3 æ•°ç»„æ³¨å…¥"></a>6.2.3 æ•°ç»„æ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> String[] books;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Student&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!--1.æ™®é€šå€¼æ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä»»æ–‡&quot;</span>/&gt;</span>
    <span class="hljs-comment">&lt;!--2. Beanæ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;address&quot;</span>/&gt;</span>
    <span class="hljs-comment">&lt;!--3.String[] æ•°ç»„æ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;books&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book2<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book3<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
    Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
    System.out.println(Arrays.toString(student.getBooks()));
&#125;</code></pre>

<p>//output: [book1, book2, book3]</p>
<h4 id="6-2-4-Listæ³¨å…¥"><a href="#6-2-4-Listæ³¨å…¥" class="headerlink" title="6.2.4 Listæ³¨å…¥"></a>6.2.4 Listæ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> List&lt;String&gt; hobbys;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;student&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Student&quot;</span>&gt;</span>
    <span class="hljs-comment">&lt;!--1.æ™®é€šå€¼æ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;ä»»æ–‡&quot;</span>/&gt;</span>
    <span class="hljs-comment">&lt;!--2. Beanæ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;address&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;address&quot;</span>/&gt;</span>
    <span class="hljs-comment">&lt;!--3.String[] æ•°ç»„æ³¨å…¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;books&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book1<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book2<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>book3<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;hobbys&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>å”±æ­Œ<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>ç”»ç”»<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>è·‘æ­¥<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
    Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
    System.out.println(student.getHobbys().toString());
&#125;</code></pre>

<p>//output: [å”±æ­Œ, ç”»ç”», è·‘æ­¥]</p>
<h4 id="6-2-5-Mapæ³¨å…¥"><a href="#6-2-5-Mapæ³¨å…¥" class="headerlink" title="6.2.5 Mapæ³¨å…¥"></a>6.2.5 Mapæ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> Map&lt;String,String&gt; card;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;card&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">map</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;é‚®æ”¿&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;111&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">entry</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;å»ºè¡Œ&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;222&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">map</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
    Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
    System.out.println(student.getCard().toString());
&#125;</code></pre>

<p>//output: {é‚®æ”¿=111, å»ºè¡Œ=222}</p>
<h4 id="6-2-6-setæ³¨å…¥"><a href="#6-2-6-setæ³¨å…¥" class="headerlink" title="6.2.6 setæ³¨å…¥"></a>6.2.6 setæ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> Set&lt;String&gt; games;<span class="hljs-comment">//é›†åˆ</span></code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;games&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>bbb<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>ccc<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>aaa<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
    Student student = (Student) applicationContext.getBean(<span class="hljs-string">&quot;student&quot;</span>);
    System.out.println(student.getGames().toString());
&#125;</code></pre>

<p>output: [bbb, ccc, aaa]</p>
<h4 id="6-2-7-Nullæ³¨å…¥"><a href="#6-2-7-Nullæ³¨å…¥" class="headerlink" title="6.2.7 Nullæ³¨å…¥"></a>6.2.7 Nullæ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> String wife;<span class="hljs-comment">//ç©ºæŒ‡é’ˆ</span></code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;wife&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">null</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre>

<pre><code class="hljs java">System.out.println(student.getWife());</code></pre>

<p>//outputï¼šnull</p>
<blockquote>
<p>å…¶å®ç»è¿‡æµ‹è¯•ï¼Œå‘ç°æ— è®ºè¿›ä¸è¿›è¡ŒNULLçš„æ³¨å…¥ï¼Œè¾“å‡ºçš„ç»“æœéƒ½æ˜¯null</p>
</blockquote>
<h4 id="6-2-8-Propertiesæ³¨å…¥"><a href="#6-2-8-Propertiesæ³¨å…¥" class="headerlink" title="6.2.8 Propertiesæ³¨å…¥"></a>6.2.8 Propertiesæ³¨å…¥</h4><pre><code class="hljs java"><span class="hljs-keyword">private</span> Properties info;</code></pre>

<p>Propertiesï¼šè¡¨ç¤ºä¸€ä¸ªæŒä¹…çš„å±æ€§é›†.å±æ€§åˆ—è¡¨ä¸­æ¯ä¸ªé”®åŠå…¶å¯¹åº”å€¼éƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">props</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;name&quot;</span>&gt;</span>222<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;sex&quot;</span>&gt;</span>555<span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">props</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span></code></pre>

<pre><code class="hljs java">System.out.println(student.getInfo());</code></pre>

<p>æ€»ä½“æµ‹è¯•ï¼š</p>
<pre><code class="hljs java">student.show();</code></pre>

<img src="/images/Spring5/image-20201115192239414.png" srcset="/img/loading.gif" alt="image-20201115192239414" style="zoom:50%;" />

<h4 id="6-2-9-på‘½åå’Œcå‘½åæ³¨å…¥"><a href="#6-2-9-på‘½åå’Œcå‘½åæ³¨å…¥" class="headerlink" title="6.2.9 på‘½åå’Œcå‘½åæ³¨å…¥"></a>6.2.9 på‘½åå’Œcå‘½åæ³¨å…¥</h4><p>User.java ï¼šã€æ³¨æ„ï¼šè¿™é‡Œæ²¡æœ‰æœ‰å‚æ„é€ å™¨ï¼ã€‘</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> age;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(<span class="hljs-keyword">int</span> age)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.age = age;
    &#125;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;User&#123;&quot;</span> +
                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +
                <span class="hljs-string">&quot;, age=&quot;</span> + age +
                <span class="hljs-string">&#x27;&#125;&#x27;</span>;
    &#125;
&#125;</code></pre>

<ol>
<li><strong>På‘½åç©ºé—´æ³¨å…¥</strong></li>
</ol>
<p>éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶:</p>
<pre><code class="hljs xml">xmlns:p=&quot;http://www.springframework.org/schema/p&quot;

<span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:p</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/p&quot;</span>&gt;</span>
  
   <span class="hljs-comment">&lt;!--P(å±æ€§: properties)å‘½åç©ºé—´ , å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•  éœ€è¦æœ‰æ— å‚æ„é€ å™¨å’Œsetæ–¹æ³•--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span> <span class="hljs-attr">p:name</span>=<span class="hljs-string">&quot;ä»»æ–‡&quot;</span> <span class="hljs-attr">p:age</span>=<span class="hljs-string">&quot;100&quot;</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//è·å–ApplicationContextï¼šæ‹¿åˆ°Springå®¹å™¨</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    <span class="hljs-comment">//getBean : å‚æ•°å³ä¸ºspringé…ç½®æ–‡ä»¶ä¸­beançš„id .</span>
    User user = (User) applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>);
    System.out.println(user.toString());

&#125;</code></pre>

<img src="/images/Spring5/image-20201115214244836.png" srcset="/img/loading.gif" alt="image-20201115214244836" style="zoom:50%;" />

<ol start="2">
<li><strong>c å‘½åç©ºé—´æ³¨å…¥</strong></li>
</ol>
<p>éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­åŠ å…¥çº¦æŸæ–‡ä»¶</p>
<pre><code class="hljs xml">xmlns:c=&quot;http://www.springframework.org/schema/c&quot;

<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span> <span class="hljs-attr">c:name</span>=<span class="hljs-string">&quot;renwen&quot;</span> <span class="hljs-attr">c:age</span>=<span class="hljs-string">&quot;101&quot;</span>/&gt;</span>
<span class="hljs-comment">&lt;!--è¿™ä¸ªéœ€è¦Userå®ä½“ç±»ä¸­æœ‰å…¨å‚çš„æ„é€ å™¨ï¼ï¼å±æ€§ä¾ç„¶è¦è®¾ç½®setæ–¹æ³•--&gt;</span></code></pre>

<img src="/images/Spring5/image-20201115214800388.png" srcset="/img/loading.gif" alt="image-20201115214800388" style="zoom:50%;" />

<p>æ³¨æ„ç‚¹ï¼š</p>
<ul>
<li>på‘½åæ³¨å…¥å’Œcå‘½åæ³¨å…¥éƒ½éœ€è¦å¯¼å…¥çº¦æŸï¼</li>
</ul>
<pre><code class="hljs xml">xmlns:p=&quot;http://www.springframework.org/schema/p&quot;
xmlns:c=&quot;http://www.springframework.org/schema/c&quot;</code></pre>

<h3 id="6-3-Bean-Scopesï¼ˆBeançš„ä½œç”¨åŸŸï¼‰"><a href="#6-3-Bean-Scopesï¼ˆBeançš„ä½œç”¨åŸŸï¼‰" class="headerlink" title="6.3 Bean Scopesï¼ˆBeançš„ä½œç”¨åŸŸï¼‰"></a>6.3 Bean Scopesï¼ˆBeançš„ä½œç”¨åŸŸï¼‰</h3><img src="/images/Spring5/image-20201115215212779.png" srcset="/img/loading.gif" alt="image-20201115215212779" style="zoom:50%;" />

<ul>
<li><strong>Singleton</strong> </li>
</ul>
<p>åœ¨Spring IOCå®¹å™¨ä¸­ä»…å­˜åœ¨ä¸€ä¸ªBeanå®ä¾‹ï¼ŒBeanä»¥å•ä¾‹æ–¹å¼å­˜åœ¨ï¼Œé»˜è®¤å€¼ã€‚</p>
<ul>
<li><h4 id="Prototype"><a href="#Prototype" class="headerlink" title="Prototype"></a>Prototype</h4></li>
</ul>
<p>æ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨Beanæ—¶ï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå³æ¯æ¬¡è°ƒç”¨getBeanæ—¶ï¼Œç›¸å½“äºæ‰§è¡Œnew xxBean()</p>
<ul>
<li><strong>Request</strong></li>
</ul>
<p>æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanï¼Œè¯¥ä½œç”¨åŸŸä»…é€‚ç”¨äºWebApplicationContextç¯å¢ƒã€‚</p>
<ul>
<li><strong>Session</strong></li>
</ul>
<p>åŒä¸€ä¸ªHTTP Sessionå…±äº«ä¸€ä¸ªBeanï¼Œä¸åŒçš„Sessionä½¿ç”¨ä¸åŒBeanï¼Œä»…é€‚ç”¨äºWebApplicationContextç¯å¢ƒ</p>
<h4 id="6-3-1-The-Singleton-Scope"><a href="#6-3-1-The-Singleton-Scope" class="headerlink" title="6.3.1 The Singleton Scope"></a>6.3.1 The Singleton Scope</h4><p>å•ä¾‹æ¨¡å¼</p>
<img src="/images/Spring5/image-20201115215615293.png" srcset="/img/loading.gif" alt="image-20201115215615293" style="zoom:50%;" />

<p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSingletonï¼Œé‚£ä¹ˆSpring IoCå®¹å™¨ä¸­<strong>åªä¼šå­˜åœ¨ä¸€ä¸ªå…±äº«çš„beanå®ä¾‹</strong>ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹beançš„è¯·æ±‚ï¼Œåªè¦idä¸è¯¥beanå®šä¹‰ç›¸åŒ¹é…ï¼Œåˆ™åªä¼šè¿”å›beançš„åŒä¸€å®ä¾‹ã€‚Singletonæ˜¯å•ä¾‹ç±»å‹ï¼Œå°±æ˜¯åœ¨åˆ›å»ºèµ·å®¹å™¨æ—¶å°±åŒæ—¶è‡ªåŠ¨åˆ›å»ºäº†ä¸€ä¸ªbeançš„å¯¹è±¡ï¼Œä¸ç®¡ä½ æ˜¯å¦ä½¿ç”¨ï¼Œä»–éƒ½å­˜åœ¨äº†ï¼Œæ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ³¨æ„ï¼ŒSingletonä½œç”¨åŸŸæ˜¯Springä¸­çš„ç¼ºçœä½œç”¨åŸŸã€‚è¦åœ¨XMLä¸­å°†beanå®šä¹‰æˆsingletonï¼Œå¯ä»¥è¿™æ ·é…ç½®(Springé»˜è®¤æœºåˆ¶):</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;accountService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.something.DefaultAccountService&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span>/&gt;</span></code></pre>

<h4 id="6-3-2-The-Prototype-Scope"><a href="#6-3-2-The-Prototype-Scope" class="headerlink" title="6.3.2 The Prototype Scope"></a>6.3.2 The Prototype Scope</h4><p>åŸå‹æ¨¡å¼</p>
<p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºPrototypeï¼Œè¡¨ç¤ºä¸€ä¸ªbeanå®šä¹‰å¯¹åº”å¤šä¸ªå¯¹è±¡å®ä¾‹ã€‚Prototypeä½œç”¨åŸŸçš„beanä¼šå¯¼è‡´åœ¨æ¯æ¬¡å¯¹è¯¥beanè¯·æ±‚ï¼ˆå°†å…¶æ³¨å…¥åˆ°å¦ä¸€ä¸ªbeanä¸­ï¼Œæˆ–è€…ä»¥ç¨‹åºçš„æ–¹å¼è°ƒç”¨å®¹å™¨çš„getBean()æ–¹æ³•ï¼‰æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„beanå®ä¾‹ã€‚Prototypeæ˜¯åŸå‹ç±»å‹ï¼Œå®ƒåœ¨æˆ‘ä»¬åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¹¶æ²¡æœ‰å®ä¾‹åŒ–ï¼Œè€Œæ˜¯å½“æˆ‘ä»¬è·å–beançš„æ—¶å€™æ‰ä¼šå»åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸”æˆ‘ä»¬æ¯æ¬¡è·å–åˆ°çš„å¯¹è±¡éƒ½ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚æ ¹æ®ç»éªŒï¼Œå¯¹æœ‰çŠ¶æ€çš„beanåº”è¯¥ä½¿ç”¨prototypeä½œç”¨åŸŸï¼Œè€Œå¯¹æ— çŠ¶æ€çš„beanåˆ™åº”è¯¥ä½¿ç”¨singletonä½œç”¨åŸŸã€‚åœ¨XMLä¸­å°†beanå®šä¹‰æˆprototypeï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;account&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.DefaultAccount&quot;</span><span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;prototype&quot;</span>/&gt;</span>  
  æˆ–è€…
 <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;account&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.DefaultAccount&quot;</span><span class="hljs-attr">singleton</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span></code></pre>

<h4 id="6-3-3-Request"><a href="#6-3-3-Request" class="headerlink" title="6.3.3 Request"></a>6.3.3 Request</h4><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºRequestï¼Œè¡¨ç¤ºåœ¨ä¸€æ¬¡HTTPè¯·æ±‚ä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ï¼›å³æ¯ä¸ªHTTPè¯·æ±‚éƒ½ä¼šæœ‰å„è‡ªçš„beanå®ä¾‹ï¼Œå®ƒä»¬ä¾æ®æŸä¸ªbeanå®šä¹‰åˆ›å»ºè€Œæˆã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;loginAction&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">cn.csdn.LoginAction</span>&quot; <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;request&quot;</span>/&gt;</span></code></pre>

<p>é’ˆå¯¹æ¯æ¬¡HTTPè¯·æ±‚ï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®loginAction beançš„å®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„LoginAction beanå®ä¾‹ï¼Œä¸”è¯¥loginAction beanå®ä¾‹ä»…åœ¨å½“å‰HTTP requestå†…æœ‰æ•ˆï¼Œå› æ­¤å¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œå…¶ä»–è¯·æ±‚ä¸­æ ¹æ®loginAction beanå®šä¹‰åˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªè¯·æ±‚çš„çŠ¶æ€å˜åŒ–ã€‚å½“å¤„ç†è¯·æ±‚ç»“æŸï¼Œrequestä½œç”¨åŸŸçš„beanå®ä¾‹å°†è¢«é”€æ¯ã€‚</p>
<h4 id="6-3-4-Session"><a href="#6-3-4-Session" class="headerlink" title="6.3.4 Session"></a>6.3.4 Session</h4><p>å½“ä¸€ä¸ªbeançš„ä½œç”¨åŸŸä¸ºSessionï¼Œè¡¨ç¤ºåœ¨ä¸€ä¸ªHTTP Sessionä¸­ï¼Œä¸€ä¸ªbeanå®šä¹‰å¯¹åº”ä¸€ä¸ªå®ä¾‹ã€‚è¯¥ä½œç”¨åŸŸä»…åœ¨åŸºäºwebçš„Spring ApplicationContextæƒ…å½¢ä¸‹æœ‰æ•ˆã€‚è€ƒè™‘ä¸‹é¢beanå®šä¹‰ï¼š</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userPreferences&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.foo.UserPreferences&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;session&quot;</span>/&gt;</span></code></pre>

<p>é’ˆå¯¹æŸä¸ªHTTP Sessionï¼ŒSpringå®¹å™¨ä¼šæ ¹æ®userPreferences beanå®šä¹‰åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„userPreferences beanå®ä¾‹ï¼Œä¸”è¯¥userPreferences beanä»…åœ¨å½“å‰HTTP Sessionå†…æœ‰æ•ˆã€‚ä¸requestä½œç”¨åŸŸä¸€æ ·ï¼Œå¯ä»¥æ ¹æ®éœ€è¦æ”¾å¿ƒçš„æ›´æ”¹æ‰€åˆ›å»ºå®ä¾‹çš„å†…éƒ¨çŠ¶æ€ï¼Œè€Œåˆ«çš„HTTP Sessionä¸­æ ¹æ®userPreferencesåˆ›å»ºçš„å®ä¾‹ï¼Œå°†ä¸ä¼šçœ‹åˆ°è¿™äº›ç‰¹å®šäºæŸä¸ªHTTP Sessionçš„çŠ¶æ€å˜åŒ–ã€‚å½“HTTP Sessionæœ€ç»ˆè¢«åºŸå¼ƒçš„æ—¶å€™ï¼Œåœ¨è¯¥HTTP Sessionä½œç”¨åŸŸå†…çš„beanä¹Ÿä¼šè¢«åºŸå¼ƒæ‰ã€‚</p>
<h4 id="6-3-5-å°ç»“"><a href="#6-3-5-å°ç»“" class="headerlink" title="6.3.5 å°ç»“"></a>6.3.5 å°ç»“</h4><p>requestã€sessionã€applicationï¼Œè¿™äº›åªèƒ½åœ¨webå¼€å‘ä¸­ä½¿ç”¨ã€‚</p>
<h2 id="7-Beançš„è‡ªåŠ¨è£…é…"><a href="#7-Beançš„è‡ªåŠ¨è£…é…" class="headerlink" title="7. Beançš„è‡ªåŠ¨è£…é…"></a>7. Beançš„è‡ªåŠ¨è£…é…</h2><img src="/images/Spring5/image-20201115221023159.png" srcset="/img/loading.gif" alt="image-20201115221023159" style="zoom:50%;" />

<p>ä»¥ä¸Šæ‰€æœ‰beançš„å±æ€§éƒ½æ˜¯æ‰‹åŠ¨è®¾ç½®çš„ã€‚</p>
<p>å› æ­¤å¼•å…¥äº†è‡ªåŠ¨è£…é…çš„æ¦‚å¿µã€‚</p>
<ul>
<li>è‡ªåŠ¨è£…é…æ—¶Springæ»¡è¶³beanä¾èµ–çš„ä¸€ç§æ–¹å¼ï¼</li>
<li>Springä¼šåœ¨ä¸Šä¸‹æ–‡ä¸­è‡ªåŠ¨å¯»æ‰¾ï¼Œå¹¶è‡ªåŠ¨ç»™beanè£…é…å±æ€§ã€‚</li>
</ul>
<p>Springä¸­beanæœ‰ä¸‰ç§è£…é…æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>åœ¨xmlä¸­æ˜¾ç¤ºé…ç½®ï¼›</li>
<li>åœ¨javaä¸­æ˜¾ç¤ºé…ç½®ï¼›</li>
<li>éšå¼çš„beanå‘ç°æœºåˆ¶å’Œè‡ªåŠ¨è£…é…ï¼›ã€é‡è¦ã€‘</li>
</ul>
<p>Springçš„è‡ªåŠ¨è£…é…éœ€è¦ä»ä¸¤ä¸ªè§’åº¦å®ç°ï¼Œæˆ–è€…è¯´æ˜¯ä¸¤ä¸ªæ“ä½œï¼š</p>
<ol>
<li>ç»„ä»¶æ‰«æï¼ˆcomponent scanningï¼‰:<strong>Springä¼šè‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ä¸­æ‰€åˆ›å»ºçš„beanï¼›</strong></li>
<li>è‡ªåŠ¨è£…é…(autowriting)ï¼š<strong>Springè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–</strong>ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¯´çš„IOC/DI</li>
</ol>
<p>ç»„ä»¶æ‰«æå’Œè‡ªåŠ¨è£…é…ç»„åˆå‘ä¼šå·¨å¤§å¨åŠ›ï¼Œä½¿å¾—æ˜¾ç¤ºçš„é…ç½®é™ä½åˆ°æœ€å°‘ã€‚</p>
<p>==<strong>æ¨èï¼šä¸ä½¿ç”¨è‡ªåŠ¨è£…é…xmlé…ç½®ï¼Œä½¿ç”¨æ³¨è§£ï¼</strong>==</p>
<hr>
<p>ä¸ªäººç†è§£ï¼šæ‰€è°“çš„è‡ªåŠ¨è£…é…ï¼Œå¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼Œspringä¼šè‡ªåŠ¨åœ¨springå®¹å™¨ä¸­å¯»æ‰¾æˆ‘ä»¬éœ€è¦è£…é…çš„beanå¯¹è±¡ã€‚</p>
<hr>
<h3 id="7-1-æµ‹è¯•ç¯å¢ƒæ­å»º"><a href="#7-1-æµ‹è¯•ç¯å¢ƒæ­å»º" class="headerlink" title="7.1 æµ‹è¯•ç¯å¢ƒæ­å»º"></a>7.1 æµ‹è¯•ç¯å¢ƒæ­å»º</h3><ol>
<li>åˆ›å»ºå®ä½“ç±»Catã€Dogã€User</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;miao~&quot;</span>);
    &#125;
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shout</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;wang~&quot;</span>);
    &#125;
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> Cat cat;
    <span class="hljs-keyword">private</span> Dog dog;
    <span class="hljs-keyword">private</span> String str;


&#125;</code></pre>

<p>æµ‹è¯•ï¼š</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
        User user = applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>, User.class);
        user.getDog().shout();
        user.getCat().shout();
    &#125;</code></pre>

<img src="/images/Spring5/image-20201116140915343.png" srcset="/img/loading.gif" alt="image-20201116140915343" style="zoom:50%;" />

<p>æµ‹è¯•æˆåŠŸï¼ï¼</p>
<h3 id="7-2-autowire-â€œbyNameâ€-æŒ‰ç…§åç§°è‡ªåŠ¨è£…é…-autowriting"><a href="#7-2-autowire-â€œbyNameâ€-æŒ‰ç…§åç§°è‡ªåŠ¨è£…é…-autowriting" class="headerlink" title="7.2 autowire  â€œbyNameâ€ æŒ‰ç…§åç§°è‡ªåŠ¨è£…é…-autowriting"></a>7.2 autowire  â€œbyNameâ€ æŒ‰ç…§åç§°è‡ªåŠ¨è£…é…-autowriting</h3><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span> <span class="hljs-attr">autowire</span>=<span class="hljs-string">&quot;byName&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;str&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;renwen&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<p>å»é™¤åŸæ¥çš„åŸæ¥çš„propertyå¼•å…¥ï¼Œæ¢æˆautowireè‡ªåŠ¨è£…é…ï¼Œæµ‹è¯•ä¾ç„¶æˆåŠŸã€‚</p>
<hr>
<p>autowire-byNameçš„å·¥ä½œæœºåˆ¶ï¼š</p>
<p>å½“ä¸€ä¸ªbeanèŠ‚ç‚¹å¸¦æœ‰ autowire byNameçš„å±æ€§æ—¶ã€‚</p>
<ul>
<li>å…ˆæŸ¥æ‰¾è¯¥beanä¸­æ‰€æœ‰setæ–¹æ³•ï¼Œå½“æ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªsetæ–¹æ³•æ—¶ï¼Œå¦‚setCatï¼Œå®ƒå°†ä¼šè‡ªåŠ¨å°†setå»é™¤ï¼Œå‰©ä½™Catï¼Œå¹¶å°†Catå¤§å†™çš„é¦–å­—æ¯è½¬æ¢æˆå°å†™cat</li>
<li>è½¬æ¢ä¹‹åï¼Œå»Springå®¹å™¨ä¸­å¯»æ‰¾beanidä¸ºcatçš„beanèŠ‚ç‚¹</li>
<li>å¦‚æœæ‰¾åˆ°ï¼Œå°±å–å‡ºæ³¨å…¥ï¼›æ²¡æœ‰æ‰¾åˆ°ï¼Œå°±æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼</li>
</ul>
<hr>
<p>å¦‚æœæˆ‘ä»¬å°†catçš„beanidæ¢æˆåˆ«çš„ï¼Œå¦‚catccï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ï¼</p>
<img src="/images/Spring5/image-20201116142333671.png" srcset="/img/loading.gif" alt="image-20201116142333671" style="zoom:50%;" />

<img src="/images/Spring5/image-20201116142344885.png" srcset="/img/loading.gif" alt="image-20201116142344885" style="zoom:50%;" />

<img src="/images/Spring5/image-20201116142344885-1606489287311.png" srcset="/img/loading.gif" alt="image-20201116142344885" style="zoom:50%;" />

<h3 id="7-3-autowire-â€œbyTypeâ€-æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…-autowriting"><a href="#7-3-autowire-â€œbyTypeâ€-æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…-autowriting" class="headerlink" title="7.3 autowire â€œbyTypeâ€ æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…-autowriting"></a>7.3 autowire â€œbyTypeâ€ æŒ‰ç…§ç±»å‹è‡ªåŠ¨è£…é…-autowriting</h3><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†catçš„beanidæ”¹æˆäº†catccï¼Œspringæ‰¾ä¸åˆ°äº†ï¼Œå› ä¸ºåå­—ä¸ä¸€æ ·äº†ï¼Œä½†æ˜¯ï¼</p>
<p>æˆ‘ä»¬å¯ä»¥å°†<strong>autowireæ”¹æˆbyType</strong>ï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯<strong>é€šè¿‡æŸ¥æ‰¾springä¸­ä¸è‡ªå·±å¯¹è±¡å±æ€§ç›¸åŒçš„beanå¯¹è±¡è¿›è¡Œè£…é…</strong>ã€‚è¿™æ ·ä¸€æ¥ï¼Œä»£ç å°±èƒ½æ­£å¸¸è¿è¡Œäº†!</p>
<img src="/images/Spring5/image-20201116142952541.png" srcset="/img/loading.gif" alt="image-20201116142952541" style="zoom:50%;" />

<p><strong>ä½†æ˜¯</strong>ï¼Œè¿™ä¸ªä¹Ÿæœ‰ä¸€å®šçš„å¼Šç«¯ï¼Œå¦‚æœspringå®¹å™¨ä¸­ï¼Œè¿˜æœ‰Catç±»å‹ æ³¨å†Œçš„å¯¹è±¡ï¼Œå¦‚ä¸‹é¢çš„cat2</p>
<img src="/images/Spring5/image-20201116143151850.png" srcset="/img/loading.gif" alt="image-20201116143151850" style="zoom:50%;" />

<p>è¿™æ ·ä¸€æ¥ï¼Œå®¹å™¨ä¸­å‡ºç°ä¸¤ä¸ªç›¸åŒç±»å‹çš„beanå¯¹è±¡ï¼Œåœ¨å¯¹userè¿›è¡ŒæŒ‰ç±»å‹è‡ªåŠ¨è£…é…æ—¶å°±ä¼šæŠ¥é”™ï¼Œå‡ºç°ä¸å”¯ä¸€çš„å¼‚å¸¸ï¼å› æ­¤ï¼Œ<strong>è¦ä¿è¯åŒä¸€ç±»å‹çš„å¯¹è±¡ï¼Œåœ¨springå®¹å™¨ä¸­å”¯ä¸€ã€‚</strong></p>
<p>åœ¨byTypeä¸­ï¼Œå³ä½¿beanæ²¡æœ‰idï¼Œä½†æ˜¯è¦ä¿è¯å”¯ä¸€ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥è‡ªåŠ¨è£…é…ï¼Œå› ä¸ºæ˜¯æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…çš„ï¼Œä¸idæ— å…³ï¼</p>
<h3 id="7-4-Springä¸­çš„è‡ªåŠ¨è£…é…å’ŒAutowired"><a href="#7-4-Springä¸­çš„è‡ªåŠ¨è£…é…å’ŒAutowired" class="headerlink" title="7.4 ==Springä¸­çš„è‡ªåŠ¨è£…é…å’ŒAutowired=="></a>7.4 ==Springä¸­çš„è‡ªåŠ¨è£…é…å’ŒAutowired==</h3><h4 id="1-è‡ªåŠ¨è£…é…"><a href="#1-è‡ªåŠ¨è£…é…" class="headerlink" title="1. è‡ªåŠ¨è£…é…"></a>1. è‡ªåŠ¨è£…é…</h4><p>å½“Springè£…é…Beanå±æ€§æ—¶ï¼Œåˆæ˜¯èƒ¡éå¸¸æ˜ç¡®ï¼Œå°±æ˜¯éœ€è¦å°†æŸä¸ªBeançš„å¼•ç”¨è£…é…ç»™æŒ‡å®šå±æ€§ã€‚</p>
<p>ä¸ºäº†åº”å¯¹è¿™ä¸ªæ˜ç¡®çš„è£…é…åœºæ™¯ï¼ŒSpringæä¾›äº†è‡ªåŠ¨è£…é…ï¼ˆautowritingï¼‰ã€‚ä¸å…¶æ˜¾å¼çš„è£…é…Beanå±æ€§ï¼Œä¸ºä½•ä¸è®©Springè¯†åˆ«å¯ä»¥è‡ªåŠ¨è£…é…çš„åœºæ™¯ã€‚</p>
<p>å½“æ¶‰åŠåˆ°è‡ªåŠ¨è£…é…Beançš„ä¾èµ–å…³ç³»æ—¶ï¼ŒSpringæœ‰å¤šç§å¤„ç†æ–¹å¼ã€‚å› æ­¤ï¼ŒSpringæä¾›äº†4ç§è£…é…ç­–ç•¥ã€‚</p>
<ol>
<li>byName</li>
</ol>
<p>æŠŠä¸Beançš„å±æ€§å…·æœ‰ç›¸åŒåå­—çš„å…¶ä»–Beanè‡ªåŠ¨è£…é…åˆ°Beançš„å¯¹åº”å±æ€§ä¸­ã€‚</p>
<ol start="2">
<li><p>byType</p>
</li>
<li><p>constructor</p>
</li>
</ol>
<p>å®ƒæ˜¯è¯´ï¼ŒæŠŠä¸Beançš„æ„é€ å™¨å…¥å‚å…·æœ‰ç›¸åŒç±»å‹çš„å…¶ä»–Beanè‡ªåŠ¨è£…é…åˆ°Beanæ„é€ å™¨çš„å¯¹åº”å…¥å‚ä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šå…·æœ‰ç›¸åŒç±»å‹çš„å…¶ä»–Beanè¿™å¥è¯è¯´æ˜å®ƒåœ¨æŸ¥æ‰¾å…¥å‚çš„æ—¶å€™ï¼Œè¿˜æ˜¯é€šè¿‡Beançš„ç±»å‹æ¥ç¡®å®šã€‚</p>
<p><strong>e.g.</strong></p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span></span>&#123;
	<span class="hljs-keyword">private</span> Role role;
  
	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(Role role)</span> </span>&#123;
		<span class="hljs-keyword">this</span>.role = role;
	&#125;
&#125;
 
&lt;bean id=&quot;user&quot; class=&quot;com.viewscenes.netsupervisor.entity.User&quot; autowire=&quot;constructor&quot;&gt;&lt;/bean&gt;
å¤åˆ¶ä»£ç </code></pre>

<ol start="4">
<li>autodetect</li>
</ol>
<p>è¿™ç§æ–¹æ³•è¢«æ ‡è®°ä¸ºæœå®æ–¹æ³•ï¼Œåœ¨Spring3.0ä¹‹åå·²ç»ä¸å†æ”¯æŒã€‚</p>
<p>å®ƒé¦–å…ˆä¼šå°è¯•ä½¿ç”¨constructorè¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦‚æœå¤±è´¥å†å°è¯•ä½¿ç”¨byTypeã€‚ä¸è¿‡ï¼Œå®ƒåœ¨Spring3.0ä¹‹åå·²ç»è¢«æ ‡è®°ä¸º@Deprecatedã€‚</p>
<ol start="5">
<li>é»˜è®¤è‡ªåŠ¨è£…é…</li>
</ol>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œdefault-autowiredå±æ€§è¢«è®¾ç½®ä¸ºnoneï¼Œè¡¨ç¤ºæ‰€æœ‰çš„Beanéƒ½ä¸ä½¿ç”¨è‡ªåŠ¨è£…é…ï¼Œé™¤éBeanä¸Šé…ç½®äº†autowiredå±æ€§ã€‚å¦‚æœéœ€è¦ä¸ºæ‰€æœ‰çš„Beané…ç½®ç›¸åŒçš„autowiredå±æ€§ï¼Œæœ‰ä¸ªåŠæ³•å¯ä»¥ç®€åŒ–è¿™ä¸€æ“ä½œã€‚åœ¨æ ¹å…ƒç´ Beansä¸Šå¢åŠ å±æ€§default-autowired=â€ByTypeâ€.</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">default-autowire</span>=<span class="hljs-string">&quot;byType&quot;</span>&gt;</span></code></pre>

<p><strong>Springè‡ªåŠ¨è£…é…çš„ä¼˜ç‚¹ä¸è¨€è€Œå–»ï¼Œä½†æ˜¯äº‹å®ä¸Šï¼Œåœ¨Spring XMLé…ç½®æ–‡ä»¶é‡Œçš„è‡ªåŠ¨è£…é…å¹¶ä¸æ¨èä½¿ç”¨ï¼Œå…¶ä¸­æœ€å¤§çš„ç¼ºç‚¹åœ¨äºä¸ç¡®å®šæ€§ã€‚æˆ–è€…é™¤éä½ å¯¹æ•´ä¸ªSpringåº”ç”¨ä¸­çš„æ‰€æœ‰Beançš„æƒ…å†µäº†å¦‚æŒ‡æŒï¼Œä¸ç„¶è™½åˆ™Beançš„å¢å¤šå’Œå…³ç³»å¤æ‚åº¦çš„ä¸Šå‡ï¼Œæƒ…å†µå¯èƒ½ä¼šæ›´ç³Ÿç³•ã€‚</strong></p>
<h4 id="2-Autowired"><a href="#2-Autowired" class="headerlink" title="2. Autowired"></a>2. Autowired</h4><p>ä»spring3.5 å¼€å§‹ï¼Œå¼€å§‹æ”¯æŒä½¿ç”¨æ³¨è§£æ¥è‡ªåŠ¨è£…é…Beanå±æ€§ã€‚å®ƒå…è®¸æ›´ç»†ç²’åº¦çš„è‡ªåŠ¨è£…é…ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ€§çš„æ ‡æ³¨æŸä¸€ä¸ªå±æ€§æ¥å¯¹å…¶åº”ç”¨è‡ªåŠ¨è£…é…ã€‚</p>
<p>Springæ”¯æŒé›†ä¸­ä¸åŒçš„åº”ç”¨äºè‡ªåŠ¨è£…é…çš„æ³¨è§£ã€‚</p>
<ul>
<li>Springè‡ªå¸¦çš„@Autowiredæ³¨è§£ã€‚</li>
<li>JSR-330çš„Injectæ³¨è§£ã€‚</li>
<li>JSR-250çš„@Resourceæ³¨è§£</li>
</ul>
<p>æˆ‘ä»¬ä»Šå¤©åªé‡ç‚¹å…³æ³¨Autowiredæ³¨è§£ï¼</p>
<p><strong>åªéœ€è¦åœ¨éœ€è¦æ³¨å…¥çš„å±æ€§åŠ å…¥æ³¨è§£å³å¯ï¼</strong></p>
<pre><code class="hljs java"><span class="hljs-meta">@Autowired</span>
UserService userService;</code></pre>

<p>ä¸è¿‡ï¼Œä½¿ç”¨å®ƒæœ‰å‡ ä¸ªç‚¹éœ€è¦æ³¨æ„ã€‚</p>
<ol>
<li>å¼ºåˆ¶æ€§</li>
</ol>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå…·æœ‰å¼ºåˆ¶å¥‘çº¦ç‰¹æ€§ï¼Œå…¶æ‰€æ ‡æ³¨çš„å±æ€§å¿…é¡»æ˜¯å¯è£…é…çš„ã€‚å¦‚æœæ²¡æœ‰Beanå¯ä»¥è£…é…åˆ°Autowiredæ‰€æ ‡æ³¨çš„å±æ€§æˆ–å‚æ•°ä¸­ï¼Œé‚£ä¹ˆä½ ä¼šçœ‹åˆ°NoSuchBeanDefinitionExceptionçš„å¼‚å¸¸ä¿¡æ¯ã€‚</p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">doResolveDependency</span><span class="hljs-params">(DependencyDescriptor descriptor, String beanName,</span></span>
<span class="hljs-function"><span class="hljs-params">			Set&lt;String&gt; autowiredBeanNames, TypeConverter typeConverter)</span> <span class="hljs-keyword">throws</span> BeansException </span>&#123;
	
	<span class="hljs-comment">//æŸ¥æ‰¾Bean</span>
	Map&lt;String, Object&gt; matchingBeans = findAutowireCandidates(beanName, type, descriptor);
	<span class="hljs-comment">//å¦‚æœæ‹¿åˆ°çš„Beané›†åˆä¸ºç©ºï¼Œä¸”isRequiredï¼Œå°±æŠ›å‡ºå¼‚å¸¸ã€‚</span>
	<span class="hljs-keyword">if</span> (matchingBeans.isEmpty()) &#123;
		<span class="hljs-keyword">if</span> (descriptor.isRequired()) &#123;
			raiseNoSuchBeanDefinitionException(type, <span class="hljs-string">&quot;&quot;</span>, descriptor);
		&#125;
		<span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
	&#125;
&#125;</code></pre>

<p>çœ‹åˆ°ä¸Šé¢çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿™ä¸€ä¿¡æ¯ï¼ŒBeané›†åˆä¸ºç©ºä¸è¦ç´§ï¼Œå…³é”®æ˜¯isRequiredæ¡ä»¶ä¸èƒ½æˆç«‹ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬ä¸ç¡®å®šå±æ€§æ˜¯å¦å¯ä»¥è£…é…ï¼Œå¯ä»¥è¿™æ ·æ¥ä½¿ç”¨Autowiredã€‚</p>
<pre><code class="hljs dart"><span class="hljs-meta">@Autowired</span>(<span class="hljs-keyword">required</span>=<span class="hljs-keyword">false</span>)
UserService userService</code></pre>

<ol start="2">
<li>è£…é…ç­–ç•¥</li>
</ol>
<p>æ›¾ç»æœ‰ä¸€ä¸ªé¢è¯•é¢˜ï¼š<strong>Autowiredæ˜¯æŒ‰ç…§ä»€ä¹ˆç­–ç•¥æ¥è‡ªåŠ¨è£…é…çš„å‘¢ï¼Ÿ</strong></p>
<p>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œä¸èƒ½ä¸€æ¦‚è€Œè®ºï¼Œä½ ä¸èƒ½ç®€å•çš„è¯´æŒ‰ç…§ç±»å‹æˆ–è€…æŒ‰ç…§åç§°ã€‚ä½†æ˜¯å¯ä»¥ç¡®å®šçš„ä¸€ç‚¹æ˜¯ï¼Œ<strong>å®ƒé»˜è®¤æ˜¯æŒ‰ç…§ç±»å‹æ¥è‡ªåŠ¨è£…é…çš„ï¼Œå³byTypeã€‚</strong></p>
<p>å…³é”®ç‚¹findAutowireCandidatesè¿™ä¸ªæ–¹æ³•ã€‚</p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> Map&lt;String, Object&gt; <span class="hljs-title">findAutowireCandidates</span><span class="hljs-params">(</span></span>
<span class="hljs-function"><span class="hljs-params">		String beanName, Class&lt;?&gt; requiredType, DependencyDescriptor descriptor)</span> </span>&#123;
	
	<span class="hljs-comment">//è·å–ç»™å®šç±»å‹çš„æ‰€æœ‰beanåç§°ï¼Œé‡Œé¢å®é™…å¾ªç¯æ‰€æœ‰çš„beanNameï¼Œè·å–å®ƒçš„å®ä¾‹</span>
	<span class="hljs-comment">//å†é€šè¿‡isTypeMatchæ–¹æ³•æ¥ç¡®å®š</span>
	String[] candidateNames = BeanFactoryUtils.beanNamesForTypeIncludingAncestors(
			<span class="hljs-keyword">this</span>, requiredType, <span class="hljs-keyword">true</span>, descriptor.isEager());
			
	Map&lt;String, Object&gt; result = <span class="hljs-keyword">new</span> LinkedHashMap&lt;String, Object&gt;(candidateNames.length);
	
	<span class="hljs-comment">//æ ¹æ®è¿”å›çš„beanNameï¼Œè·å–å…¶å®ä¾‹è¿”å›</span>
	<span class="hljs-keyword">for</span> (String candidateName : candidateNames) &#123;
		<span class="hljs-keyword">if</span> (!isSelfReference(beanName, candidateName) &amp;&amp; isAutowireCandidate(candidateName, descriptor)) &#123;
			result.put(candidateName, getBean(candidateName));
		&#125;
	&#125;
	<span class="hljs-keyword">return</span> result;
&#125;</code></pre>

<p>final: <strong>@Autowiredé»˜è®¤ä½¿ç”¨byTypeæ¥è£…é…å±æ€§ï¼Œå¦‚æœåŒ¹é…åˆ°ç±»å‹çš„å¤šä¸ªå®ä¾‹ï¼Œå†é€šè¿‡byNameæ¥ç¡®å®šBeanã€‚</strong></p>
<p>å¦‚æœé€šè¿‡åç§°è¿˜æ˜¯ç¡®å®šä¸äº†ã€‚è¿˜æ˜¯determineAutowireCandidateè¿™ä¸ªæ–¹æ³•ï¼Œå®ƒè¿˜æœ‰ä¸¤ç§æ–¹å¼æ¥ç¡®å®šã€‚</p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">determineAutowireCandidate</span><span class="hljs-params">(Map&lt;String, Object&gt; candidateBeans, </span></span>
<span class="hljs-function"><span class="hljs-params">				DependencyDescriptor descriptor)</span> </span>&#123;
	Class&lt;?&gt; requiredType = descriptor.getDependencyType();
	<span class="hljs-comment">//é€šè¿‡@Primaryæ³¨è§£æ¥æ ‡è¯†Bean</span>
	String primaryCandidate = determinePrimaryCandidate(candidateBeans, requiredType);
	<span class="hljs-keyword">if</span> (primaryCandidate != <span class="hljs-keyword">null</span>) &#123;
		<span class="hljs-keyword">return</span> primaryCandidate;
	&#125;
	<span class="hljs-comment">//é€šè¿‡@Priority(value = 0)æ³¨è§£æ¥æ ‡è¯†Bean valueä¸ºä¼˜å…ˆçº§å¤§å°</span>
	String priorityCandidate = determineHighestPriorityCandidate(candidateBeans, requiredType);
	<span class="hljs-keyword">if</span> (priorityCandidate != <span class="hljs-keyword">null</span>) &#123;
		<span class="hljs-keyword">return</span> priorityCandidate;
	&#125;
	<span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
&#125;</code></pre>

<ul>
<li>Primary</li>
</ul>
<p>å®ƒçš„ä½œç”¨æ˜¯çœ‹Beanä¸Šæ˜¯å¦åŒ…å«@Primaryæ³¨è§£ï¼Œå¦‚æœåŒ…å«å°±è¿”å›ã€‚å½“ç„¶äº†ï¼Œä½ ä¸èƒ½æŠŠå¤šä¸ªBeanéƒ½è®¾ç½®ä¸º@Primaryï¼Œä¸ç„¶å°†ä¼šå¾—åˆ°NoUniqueBeanDefinitionExceptionå¼‚å¸¸ã€‚</p>
<ul>
<li>Priority</li>
</ul>
<p>ä½ ä¹Ÿå¯ä»¥åœ¨Beanä¸Šé…ç½®@Priorityæ³¨è§£ï¼Œå®ƒæœ‰ä¸ªintç±»å‹çš„å±æ€§valueï¼Œå¯ä»¥é…ç½®ä¼˜å…ˆçº§å¤§å°ã€‚æ•°å­—è¶Šå°çš„ï¼Œå°±ä¼šè¢«ä¼˜å…ˆåŒ¹é…ã€‚åŒæ ·çš„ï¼Œä½ ä¹Ÿä¸èƒ½æŠŠå¤šä¸ªBeançš„ä¼˜å…ˆçº§é…ç½®æˆç›¸åŒå¤§å°çš„æ•°å€¼ï¼Œå¦åˆ™NoUniqueBeanDefinitionExceptionå¼‚å¸¸ç…§æ ·ä¼šå‡ºç°ã€‚</p>
<p><strong>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯ï¼šPriorityçš„åŒ…åœ¨javax.annotation.Priority  å¦‚æœæƒ³ä½¿ç”¨å®ƒè¿˜éœ€è¦å¼•å…¥ä¸€ä¸ªåæ ‡ã€‚</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>javax.annotation<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>javax.annotation-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
	<span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>

<h4 id="3-æ€»ç»“"><a href="#3-æ€»ç»“" class="headerlink" title="3. æ€»ç»“"></a>3. æ€»ç»“</h4><p>ä¸»è¦é˜è¿°äº†Springä¸­çš„è‡ªåŠ¨è£…é…çš„é›†ä¸­ç­–ç•¥ï¼Œåˆé€šè¿‡æºç åˆ†æäº†Autowiredæ³¨è§£çš„ä½¿ç”¨æ–¹æ³•ã€‚åœ¨Spring3.0ä¹‹åï¼Œæœ‰æ•ˆçš„è‡ªåŠ¨è£…é…ç­–ç•¥åˆ†ä¸ºbyTypeã€byNameã€constructorä¸‰ç§æ–¹å¼ã€‚æ³¨è§£Autowiredé»˜è®¤ä½¿ç”¨byTypeæ¥è‡ªåŠ¨è£…é…ï¼Œå¦‚æœå­˜åœ¨ç±»å‹çš„å¤šä¸ªå®ä¾‹å°±å°è¯•ä½¿ç”¨byNameåŒ¹é…ï¼Œå¦‚æœé€šè¿‡byNameä¹Ÿç¡®å®šä¸äº†ï¼Œå¯ä»¥é€šè¿‡Primaryå’ŒPriorityæ³¨è§£æ¥ç¡®å®šã€‚</p>
<h3 id="7-5-è‡ªåŠ¨è£…é…Autowired"><a href="#7-5-è‡ªåŠ¨è£…é…Autowired" class="headerlink" title="7.5 è‡ªåŠ¨è£…é…Autowired"></a>7.5 è‡ªåŠ¨è£…é…Autowired</h3><ol>
<li>æ³¨è§£å®ç°è‡ªåŠ¨è£…é…</li>
</ol>
<p>JDK1.5å¼€å§‹æ”¯æŒæ³¨è§£ï¼ŒSpring2.5å¼€å§‹å»å…¨é¢æ”¯æŒæ³¨è§£ã€‚</p>
<p>å‡†å¤‡å·¥ä½œï¼š<strong>åˆ©ç”¨æ³¨è§£çš„æ–¹å¼æ³¨å…¥å±æ€§ã€‚</strong></p>
<ol>
<li>åœ¨springé…ç½®æ–‡ä»¶ä¸­å¼•å…¥contextæ–‡ä»¶å¤´çº¦æŸ</li>
</ol>
<pre><code class="hljs xml"> xmlns:context=&quot;http://www.springframework.org/schema/context&quot;

http://www.springframework.org/schema/context
http://www.springframework.org/schema/context/spring-context.xsd</code></pre>

<ol start="2">
<li>å¼€å¯<strong>å±æ€§</strong>æ³¨è§£æ”¯æŒ</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span></code></pre>

<hr>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<img src="/images/Spring5/image-20201120084923684.png" srcset="/img/loading.gif" alt="image-20201120084923684" style="zoom:50%;" />

<hr>
<h4 id="Autowired"><a href="#Autowired" class="headerlink" title="@Autowired"></a><strong>@Autowired</strong></h4><p>ç›´æ¥åœ¨å±æ€§ä¸Šä½¿ç”¨å³å¯ï¼ä¹Ÿå¯ä»¥ç›´æ¥åœ¨setteræ–¹æ³•ä¸Šä½¿ç”¨ã€‚</p>
<p><strong>ä½¿ç”¨Autowired æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç¼–å†™setteræ–¹æ³•ï¼Œä½†æ˜¯å‰ææ˜¯è¿™ä¸ªè‡ªåŠ¨é…ç½®çš„å±æ€§åœ¨IOC(Spring)å®¹å™¨ä¸­å­˜åœ¨ï¼Œä¸”ç¬¦åˆåå­—byNameã€‚</strong></p>
<p><strong>æµ‹è¯•ï¼š</strong></p>
<ol>
<li>å°†å°†Userç±»ä¸­çš„setteræ–¹æ³•å»æ‰ï¼Œä½¿ç”¨@Autowiredæ³¨è§£ã€‚</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
  <span class="hljs-meta">@Autowired</span>
  <span class="hljs-keyword">private</span> Cat cat;
  <span class="hljs-meta">@Autowired</span>
  <span class="hljs-keyword">private</span> Dog dog;
  <span class="hljs-keyword">private</span> String str;

  <span class="hljs-function"><span class="hljs-keyword">public</span> Cat <span class="hljs-title">getCat</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> cat;
  &#125;

  <span class="hljs-function"><span class="hljs-keyword">public</span> Dog <span class="hljs-title">getDog</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> dog;
  &#125;

  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getStr</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> str;
  &#125;
&#125;
</code></pre>

<ol start="2">
<li>æ­¤æ—¶é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           &quot;</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•æˆåŠŸï¼Œè¾“å‡ºç»“æœï¼</li>
</ol>
<p><strong>ç§‘æ™®ï¼š</strong></p>
<ul>
<li>@Nullable  å­—æ®µæ ‡è®°äº†è¿™ä¸ªæ³¨è§£ï¼Œè¯´æ˜è¿™ä¸ªå­—æ®µå¯ä»¥ä¸ºnull</li>
<li>@Autowired(required = false)</li>
</ul>
<p>å¦‚æœæ˜¾å¼å®šä¹‰äº†Autowiredçš„requiredå±æ€§ä¸ºfalseï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡å¯ä»¥ä¸ºnullï¼Œå¦åˆ™ä¸å…è®¸ã€‚å› ä¸ºrequiredçš„å€¼é»˜è®¤ä¸ºtrueã€‚</p>
<h4 id="Qualifer"><a href="#Qualifer" class="headerlink" title="@Qualifer"></a>@Qualifer</h4><p><strong>@Autowired + @Qualifier</strong></p>
<ul>
<li><p>@Autowiredæ˜¯æ ¹æ®ç±»å‹è‡ªåŠ¨è£…é…çš„ï¼Œ<strong>åŠ ä¸Š</strong>@Qualifieråˆ™æ ¹æ®byNameçš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</p>
</li>
<li><p><strong>@Qualifierä¸èƒ½å•ç‹¬ä½¿ç”¨ã€‚</strong></p>
</li>
</ul>
<p>æµ‹è¯•å®éªŒæ­¥éª¤ï¼š</p>
<pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> Cat cat;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> Dog dog;

    <span class="hljs-keyword">private</span> String str;
&#125;</code></pre>

<p>é…ç½®æ–‡ä»¶ä¿®æ”¹å†…å®¹ï¼Œä¿è¯ç±»å‹å­˜åœ¨å¯¹è±¡ã€‚ä¸”åå­—ä¸ä¸ºç±»çš„é»˜è®¤åå­—ï¼</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           &quot;</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="2">
<li>æ²¡æœ‰åŠ Qualifieræµ‹è¯•ï¼Œç›´æ¥æŠ¥é”™</li>
</ol>
<img src="/images/Spring5/image-20201120104904576.png" srcset="/img/loading.gif" alt="image-20201120104904576" style="zoom:50%;" />

<p>å› ä¸ºæ˜¾ç¤ºæŒ‰ç…§ç±»å‹æ‰¾å¯»ï¼Œå‘ç°æœ‰ä¸¤ä¸ªï¼Œä¹‹åæŒ‰ç…§nameå¯»æ‰¾ï¼Œæ‰¾ä¸åˆ°ç›¸åŒ¹é…çš„é¡¹ï¼Œæ‰€ä»¥æŠ¥é”™äº†ï¼</p>
<ol start="3">
<li>åœ¨å±æ€§ä¸Šæ·»åŠ Qualifieræ³¨è§£</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
  <span class="hljs-meta">@Autowired</span>
  <span class="hljs-meta">@Qualifier(value = &quot;cat1&quot;)</span>
  <span class="hljs-keyword">private</span> Cat cat;
  <span class="hljs-meta">@Autowired</span>
  <span class="hljs-meta">@Qualifier(value = &quot;dog1&quot;)</span>
  <span class="hljs-keyword">private</span> Dog dog;

  <span class="hljs-keyword">private</span> String str;
&#125;</code></pre>

<ol start="4">
<li>æµ‹è¯•ï¼Œæµ‹è¯•æˆåŠŸï¼ŒæˆåŠŸè¾“å‡ºï¼</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    User user = applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>, User.class);
    user.getCat().shout();
  &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201120105240612.png" srcset="/img/loading.gif" alt="image-20201120105240612" style="zoom:50%;" />

<h4 id="Resources"><a href="#Resources" class="headerlink" title="@Resources"></a>@Resources</h4><ol>
<li>Resourceså¦‚æœ‰æŒ‡å®šçš„nameå±æ€§ï¼Œå…ˆæŒ‰ç…§è¯¥å±æ€§è¿›è¡ŒbyNameæ–¹å¼æŸ¥æ‰¾è£…é…ã€‚</li>
<li>å…¶æ¬¡å†è¿›è¡Œé»˜è®¤çš„byNameæ–¹å¼è¿›è¡Œè£…é…</li>
<li>å¦‚æœä»¥ä¸Šéƒ½ä¸æˆåŠŸï¼Œåˆ™æŒ‰byTypeçš„æ–¹å¼è‡ªåŠ¨è£…é…ã€‚</li>
<li>éƒ½ä¸æˆåŠŸï¼Œåˆ™æŠ¥å¼‚å¸¸</li>
</ol>
<p>æµ‹è¯•å®éªŒï¼š</p>
<ol>
<li>beansä¸­çš„é…ç½®</li>
</ol>
<p>Catè®¾ç½®ä¸¤ä¸ªï¼Œå¿…é¡»è®¾ç½®Resources æŒ‡å®šåç§°è¿›è¡ŒæŸ¥æ‰¾ã€‚Dogè®¾ç½®ä¸€ä¸ªï¼Œä¿è¯å¯ä»¥è‡ªåŠ¨æ‰¾åˆ°ï¼</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           &quot;</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="2">
<li>å®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;

  <span class="hljs-meta">@Resource(name = &quot;cat1&quot;)</span>
  <span class="hljs-keyword">private</span> Cat cat;

  <span class="hljs-meta">@Resource</span>
  <span class="hljs-keyword">private</span> Dog dog;

  <span class="hljs-keyword">private</span> String str;
&#125;</code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<p>æµ‹è¯•ç±»ï¼š</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
    User user = applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>, User.class);
    user.getCat().shout();
  &#125;
&#125;</code></pre>

<p>æµ‹è¯•æˆåŠŸï¼ï¼</p>
<img src="/images/Spring5/image-20201120111233221.png" srcset="/img/loading.gif" alt="image-20201120111233221" style="zoom:50%;" />

<p><strong>ç»“è®ºï¼š</strong></p>
<p>ä¸»è¦è¿‡ç¨‹ï¼šå…ˆè¿›è¡ŒbyNameæŸ¥æ‰¾ï¼Œå¤±è´¥ï¼›å†è¿›è¡ŒbyTypeæŸ¥æ‰¾ï¼ŒæˆåŠŸï¼</p>
<p>@Autowiredä¸@Resourceå¼‚åŒï¼š</p>
<p>1ã€@Autowiredä¸@Resourceéƒ½å¯ä»¥ç”¨æ¥è£…é…beanã€‚éƒ½å¯ä»¥å†™åœ¨å­—æ®µä¸Šï¼Œæˆ–å†™åœ¨setteræ–¹æ³•ä¸Šã€‚</p>
<p>2ã€@Autowiredé»˜è®¤æŒ‰ç±»å‹è£…é…ï¼ˆå±äºspringè§„èŒƒï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹å¿…é¡»è¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœè¦å…è®¸null å€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseï¼Œå¦‚ï¼š@Autowired(required=false) ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨åç§°è£…é…å¯ä»¥ç»“åˆ@Qualifieræ³¨è§£è¿›è¡Œä½¿ç”¨</p>
<p>3ã€@Resourceï¼ˆå±äºJ2EEå¤è¿”ï¼‰ï¼Œé»˜è®¤æŒ‰ç…§åç§°è¿›è¡Œè£…é…ï¼Œåç§°å¯ä»¥é€šè¿‡nameå±æ€§è¿›è¡ŒæŒ‡å®šã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šnameå±æ€§ï¼Œå½“æ³¨è§£å†™åœ¨å­—æ®µä¸Šæ—¶ï¼Œé»˜è®¤å–å­—æ®µåè¿›è¡ŒæŒ‰ç…§åç§°æŸ¥æ‰¾ï¼Œå¦‚æœæ³¨è§£å†™åœ¨setteræ–¹æ³•ä¸Šé»˜è®¤å–å±æ€§åè¿›è¡Œè£…é…ã€‚å½“æ‰¾ä¸åˆ°ä¸åç§°åŒ¹é…çš„beanæ—¶æ‰æŒ‰ç…§ç±»å‹è¿›è¡Œè£…é…ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœnameå±æ€§ä¸€æ—¦æŒ‡å®šï¼Œå°±åªä¼šæŒ‰ç…§åç§°è¿›è¡Œè£…é…ã€‚</p>
<p>å®ƒä»¬çš„ä½œç”¨ç›¸åŒéƒ½æ˜¯ç”¨æ³¨è§£æ–¹å¼æ³¨å…¥å¯¹è±¡ï¼Œä½†æ‰§è¡Œé¡ºåºä¸åŒã€‚@Autowiredå…ˆbyTypeï¼Œ@Resourceå…ˆbyNameã€‚</p>
<h2 id="8-Springæ³¨è§£å¼€å‘"><a href="#8-Springæ³¨è§£å¼€å‘" class="headerlink" title="8. Springæ³¨è§£å¼€å‘"></a>8. Springæ³¨è§£å¼€å‘</h2><img src="/images/Spring5/image-20201120114001211.png" srcset="/img/loading.gif" alt="image-20201120114001211" style="zoom:50%;" />

<p>åœ¨spring4 ä¹‹åï¼Œæƒ³è¦ä½¿ç”¨æ³¨è§£å½¢å¼ï¼Œå¿…é¡»è¦å¼•å…¥aopåŒ…ã€‚å…¶å®åœ¨å¼•å…¥webmvcçš„ä¾èµ–ä¹‹åï¼Œå°±å·²ç»å¼•å…¥aopçš„åŒ…ã€‚</p>
<p>åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿˜å¾—è¦å¼•å…¥ä¸€ä¸ªcontextçº¦æŸï¼</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">                           https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">                           http://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">                           &quot;</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;user&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;cat2&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Cat&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dog1&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.pojo.Dog&quot;</span>/&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<h3 id="8-1-Beançš„å®ç°"><a href="#8-1-Beançš„å®ç°" class="headerlink" title="8.1 Beançš„å®ç°"></a>8.1 Beançš„å®ç°</h3><p>æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯ä½¿ç”¨beançš„æ ‡ç­¾è¿›è¡Œbeanæ³¨å…¥ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šä½¿ç”¨æ³¨è§£ï¼</p>
<ol>
<li>é…ç½®æ‰«æå“ªäº›åŒ…ä¸‹çš„æ³¨è§£</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">                           https://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

<span class="hljs-comment">&lt;!--æŒ‡å®šæ³¨è§£æ‰«æåŒ…--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">context:component-scan</span> <span class="hljs-attr">base-package</span>=<span class="hljs-string">&quot;com.wen.pojo&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="2">
<li>åœ¨æŒ‡å®šåŒ…ä¸‹ç¼–å†™ç±»ï¼Œå¢åŠ æ³¨è§£</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span>
<span class="hljs-comment">/* ç›¸å½“äº &lt;bean id=&quot;user&quot; class=&quot;com.wen.pojo.User&quot;&gt;*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;

  <span class="hljs-keyword">private</span> String name = <span class="hljs-string">&quot;2222&quot;</span>;
&#125;</code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<img src="/images/Spring5/image-20201120142244915.png" srcset="/img/loading.gif" alt="image-20201120142244915" style="zoom:50%;" />

<h3 id="8-2-å±æ€§å¦‚ä½•æ³¨å…¥"><a href="#8-2-å±æ€§å¦‚ä½•æ³¨å…¥" class="headerlink" title="8.2 å±æ€§å¦‚ä½•æ³¨å…¥"></a>8.2 å±æ€§å¦‚ä½•æ³¨å…¥</h3><p>ä½¿ç”¨æ³¨è§£æ³¨å…¥å±æ€§ã€‚</p>
<ol>
<li>å¯ä»¥ä¸ä½¿ç”¨setæ–¹æ³•ï¼Œç›´æ¥åœ¨å®šä¹‰å±æ€§åä¸Šæ–¹æ·»åŠ @Value(â€œå€¼â€)</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span>
<span class="hljs-comment">/* ç›¸å½“äº &lt;bean id=&quot;user&quot; class=&quot;com.wen.pojo.User&quot;&gt;*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;

  <span class="hljs-meta">@Value(&quot;333&quot;)</span>
  <span class="hljs-comment">/* ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;property name=&quot;name&quot; value=&quot;333&quot;&gt;*/</span>
  <span class="hljs-keyword">private</span> String name;
&#125;</code></pre>

<img src="/images/Spring5/image-20201120142530432.png" srcset="/img/loading.gif" alt="image-20201120142530432" style="zoom:50%;" />

<ol start="2">
<li>å¦‚æœæä¾›äº†setæ–¹æ³•ï¼Œåœ¨setæ–¹æ³•ä¸Šæ·»åŠ @Value(â€œå€¼â€)</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span>
<span class="hljs-comment">/* ç›¸å½“äº &lt;bean id=&quot;user&quot; class=&quot;com.wen.pojo.User&quot;&gt;*/</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;

  <span class="hljs-comment">//    @Value(&quot;333&quot;)</span>
  <span class="hljs-comment">/* ç›¸å½“äºé…ç½®æ–‡ä»¶ä¸­ &lt;property name=&quot;name&quot; value=&quot;333&quot;&gt;*/</span>
  <span class="hljs-keyword">private</span> String name;

  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> name;
  &#125;

  <span class="hljs-meta">@Value(&quot;444&quot;)</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
    <span class="hljs-keyword">this</span>.name = name;
  &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201120142815550.png" srcset="/img/loading.gif" alt="image-20201120142815550" style="zoom:50%;" />

<h3 id="8-3-è¡ç”Ÿçš„æ³¨è§£"><a href="#8-3-è¡ç”Ÿçš„æ³¨è§£" class="headerlink" title="8.3 è¡ç”Ÿçš„æ³¨è§£"></a>8.3 è¡ç”Ÿçš„æ³¨è§£</h3><p>æˆ‘ä»¬çš„è¿™äº›æ³¨è§£ï¼Œå°±æ˜¯ä»£æ›¿äº†åœ¨é…ç½®æ–‡ä»¶å½“ä¸­é…ç½®æ­¥éª¤è€Œå·²ï¼æ›´åŠ çš„æ–¹ä¾¿å¿«æ·ï¼</p>
<p><strong>@Componentä¸‰ä¸ªè¡ç”Ÿæ³¨è§£</strong></p>
<p>ä¸ºäº†æ›´å¥½çš„è¿›è¡Œåˆ†å±‚ï¼ŒSpringå¯ä»¥ä½¿ç”¨å…¶ä»–ä¸‰ä¸ªæ³¨è§£ï¼ŒåŠŸèƒ½ä¸€æ ·ï¼Œç›®å‰ä½¿ç”¨å“ªä¸€ä¸ªåŠŸèƒ½éƒ½ä¸€æ ·ã€‚</p>
<ul>
<li>@Controllerï¼šWebå±‚</li>
<li>@Serviceï¼šserviceå±‚</li>
<li>@Repositoryï¼šdaoå±‚</li>
</ul>
<p>å†™ä¸Šè¿™äº›æ³¨è§£ï¼Œå°±ç›¸å½“äºå°†è¿™ä¸ªç±»äº¤ç»™Springç®¡ç†è£…é…äº†ï¼</p>
<h3 id="8-4-è‡ªåŠ¨è£…é…"><a href="#8-4-è‡ªåŠ¨è£…é…" class="headerlink" title="8.4 è‡ªåŠ¨è£…é…"></a>8.4 è‡ªåŠ¨è£…é…</h3><p>åœ¨Beançš„è‡ªåŠ¨è£…é…ä¸­è®²è§£è¿‡ï¼Œå°±ä¸å†™äº†ï¼</p>
<h3 id="8-5-ä½œç”¨åŸŸ"><a href="#8-5-ä½œç”¨åŸŸ" class="headerlink" title="8.5 ä½œç”¨åŸŸ"></a>8.5 ä½œç”¨åŸŸ</h3><p><strong>@Scope</strong></p>
<ul>
<li><strong>singleton</strong>ï¼šé»˜è®¤çš„ï¼ŒSpringä¼šé‡‡ç”¨å•ä¾‹æ¨¡å¼åˆ›å»ºè¿™ä¸ªå¯¹è±¡ã€‚å…³é—­å·¥å‚ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šé”€æ¯ã€‚</li>
<li><strong>prototype</strong>ï¼šå¤šä¾‹æ¨¡å¼ã€‚å…³é—­å·¥å‚ï¼Œæ‰€æœ‰çš„å¯¹è±¡ä¸ä¼šé”€æ¯ã€‚å†…éƒ¨çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¼šå›æ”¶ã€‚</li>
</ul>
<pre><code class="hljs java"><span class="hljs-meta">@Component(&quot;user&quot;)</span>
<span class="hljs-meta">@Scope(&quot;prototype&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
  <span class="hljs-keyword">private</span> String name;

  <span class="hljs-meta">@Value(&quot;444&quot;)</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
    <span class="hljs-keyword">this</span>.name = name;
  &#125;
&#125;</code></pre>

<h3 id="8-6-å°ç»“"><a href="#8-6-å°ç»“" class="headerlink" title="8.6 å°ç»“"></a>8.6 å°ç»“</h3><p><strong>XMLä¸æ³¨è§£æ¯”è¾ƒ</strong></p>
<ul>
<li>XMLå¯ä»¥é€‚ç”¨ä»»ä½•åœºæ™¯ï¼Œç»“æ„æ¸…æ™°ï¼Œç»´æŠ¤æ–¹ä¾¿ã€‚</li>
<li>æ³¨è§£ä¸æ˜¯è‡ªå·±æä¾›çš„ç±»ä½¿ç”¨ä¸äº†ï¼Œå¼€å‘ç®€å•ã€‚</li>
</ul>
<p><strong>XMLä¸æ³¨è§£æ•´åˆå¼€å‘ï¼šæ¨èæœ€ä½³å®è·µ</strong></p>
<ul>
<li>XMLç®¡ç†Bean</li>
<li>æ³¨è§£å®Œæˆå±æ€§æ³¨å…¥</li>
<li>==<strong>ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä¸ç”¨æ‰«æï¼Œæ‰«ææ˜¯ä¸ºäº†ç±»ä¸Šçš„æ³¨è§£ã€‚</strong>==</li>
</ul>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">context:annotation-config</span>/&gt;</span></code></pre>

<p><strong>ä½œç”¨ï¼š</strong>(ä¸Šé¢è¿™å¥<a href="context:annotation-config/">context:annotation-config/</a>çš„ä½œç”¨)</p>
<ul>
<li>è¿›è¡Œæ³¨è§£é©±åŠ¨æ³¨å†Œï¼Œä»è€Œä½¿æ³¨è§£ç”Ÿæ•ˆã€‚</li>
<li>ç”¨äºæ¿€æ´»é‚£äº›å·²ç»åœ¨Springå®¹å™¨é‡Œæ³¨å†Œè¿‡çš„beanä¸Šé¢çš„æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯æ˜¾å¼çš„å‘Springæ³¨å†Œã€‚</li>
<li>å¦‚æœä¸æ‰«æåŒ…ï¼Œå°±éœ€è¦æ‰‹åŠ¨é…ç½®bean</li>
<li>å¦‚æœä¸åŠ æ³¨è§£é©±åŠ¨ï¼Œåˆ™æ³¨å…¥çš„å€¼ä¸ºNullï¼</li>
</ul>
<h3 id="8-7-åŸºäºJavaç±»è¿›è¡Œé…ç½®"><a href="#8-7-åŸºäºJavaç±»è¿›è¡Œé…ç½®" class="headerlink" title="8.7 åŸºäºJavaç±»è¿›è¡Œé…ç½®"></a>8.7 åŸºäºJavaç±»è¿›è¡Œé…ç½®</h3><p>JavaConfigåŸæ¥æ˜¯ä¸€ä¸ªSpringçš„ä¸€ä¸ªå­é¡¹ç›®ï¼Œå®ƒé€šè¿‡Javaç±»çš„æ–¹å¼æä¾›Beançš„å®šä¹‰ä¿¡æ¯ï¼Œåœ¨Spring4çš„ç‰ˆæœ¬ï¼ŒJavaConfigå·²ç»æ­£å¼æˆä¸ºSpring4çš„æ ¸å¿ƒåŠŸèƒ½ã€‚</p>
<p><strong>æµ‹è¯•ï¼š</strong></p>
<ol>
<li>ç¼–å†™ä¸€ä¸ªå®ä½“ç±» User</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Component</span> 
<span class="hljs-comment">//å°†è¿™ä¸ªç±»æ ‡æ³¨ä¸ºSpringçš„ä¸€ä¸ªç»„ä»¶ï¼Œæ”¾åˆ°å®¹å™¨ä¸­ï¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;

  <span class="hljs-meta">@Value(&quot;999&quot;)</span>
  <span class="hljs-keyword">private</span> String name;

  <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
    <span class="hljs-keyword">return</span> name;
  &#125;
&#125;</code></pre>

<ol start="2">
<li>æ–°å»ºä¸€ä¸ªconfigé…ç½®åŒ…ï¼Œç¼–å†™ä¸€ä¸ªMyConfigé…ç½®ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Configuration</span> <span class="hljs-comment">// ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig</span> </span>&#123;
  
    <span class="hljs-meta">@Bean</span> 
 <span class="hljs-comment">//té€šè¿‡æ–¹æ³•æ³¨å†Œä¸€ä¸ªbean</span>
  <span class="hljs-comment">//è¿™é‡Œçš„è¿”å›å€¼å°±æ˜¯Beançš„ç±»å‹ï¼Œæ–¹æ³•åå°±æ˜¯Beançš„id</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">user</span><span class="hljs-params">()</span></span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> User();
    &#125;
&#125;</code></pre>

<ol start="3">
<li>ç¼–å†™æµ‹è¯•ç±»ï¼Œæ³¨æ„è¿™é‡Œæµ‹è¯•ç±»å˜åŒ–äº†ï¼Œä¸å†æ˜¯ä»é…ç½®æ–‡ä»¶ä¸­è·å–å®¹å™¨çš„ä¸Šä¸‹æ–‡äº†ï¼ï¼</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
    <span class="hljs-comment">//ä¸å†æ˜¯ä»é…ç½®æ–‡ä»¶ä¸­è·å–ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯ä»é…ç½®ç±»ä¸­è·å–ä¸Šä¸‹æ–‡ï¼ï¼</span>
    ApplicationContext applicationContext = <span class="hljs-keyword">new</span> AnnotationConfigApplicationContext(MyConfig.class);
    User user = applicationContext.getBean(<span class="hljs-string">&quot;user&quot;</span>, User.class);
    System.out.println(user.getName());
  &#125;
&#125;</code></pre>

<p>æµ‹è¯•æˆåŠŸï¼</p>
<img src="/images/Spring5/image-20201120151212913.png" srcset="/img/loading.gif" alt="image-20201120151212913" style="zoom:50%;" />

<p><strong>åŒæ—¶é…ç½®ç±»ä¹Ÿå¯ä»¥åƒä¹‹å‰é…ç½®æ–‡ä»¶é‚£æ ·ï¼Œå¯¼å…¥å…¶ä»–çš„é…ç½®ç±»ï¼</strong></p>
<ol>
<li>æˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ªæµ‹è¯•ç±»ï¼</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@COnfiguration</span> <span class="hljs-comment">//ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig2</span></span>&#123;
  
&#125;</code></pre>

<ol start="2">
<li>åœ¨ä¹‹å‰çš„é…ç½®ç±»ä¸­æˆ‘ä»¬æ¥é€‰æ‹©å¯¼å…¥è¿™ä¸ªé…ç½®ç±»ã€‚</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@Import(MyConfig2.class)</span>
<span class="hljs-comment">//å¯¼å…¥å…¶ä»–é…ç½®ç±»ï¼Œç±»ä¼¼äºé…ç½®æ–‡ä»¶ä¸­çš„includeæ ‡ç­¾ã€‚</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyConfig</span></span>&#123;
  <span class="hljs-meta">@Bean</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">user</span><span class="hljs-params">()</span></span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> User();
  &#125;
&#125;</code></pre>

<p>å…³äºè¿™ç§Javaç±»çš„é…ç½®æ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ä¹‹åçš„SpringBootå’ŒSpringCloudä¸­è¿˜ä¼šå¤§é‡çœ‹åˆ°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¿™äº›æ³¨è§£çš„ä½œç”¨å³å¯ï¼ï¼</p>
<h2 id="9-é™æ€-åŠ¨æ€ä»£ç†æ¨¡å¼"><a href="#9-é™æ€-åŠ¨æ€ä»£ç†æ¨¡å¼" class="headerlink" title="9. é™æ€/åŠ¨æ€ä»£ç†æ¨¡å¼"></a>9. é™æ€/åŠ¨æ€ä»£ç†æ¨¡å¼</h2><p>ä¸ºä»€ä¹ˆè¦å­¦ä¹ ä»£ç†æ¨¡å¼ï¼Œå› ä¸ºAOP*ï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„åº•å±‚æœºåˆ¶å°±æ˜¯åŠ¨æ€ä»£ç†ï¼</p>
<p>ä»£ç†æ¨¡å¼ï¼š</p>
<ul>
<li>é™æ€ä»£ç†</li>
<li>åŠ¨æ€ä»£ç†</li>
</ul>
<p><strong>å­¦ä¹ AOPä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£ä¸€ä¸‹ä»£ç†æ¨¡å¼ï¼</strong></p>
<p>ä»£ç†æ¨¡å¼ä½œä¸º23ç§ç»å…¸è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå…¶æ¯”è¾ƒå®˜æ–¹çš„å®šä¹‰ä¸ºâ€œä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®â€ï¼Œç®€å•ç‚¹è¯´å°±æ˜¯ï¼Œä¹‹å‰Aç±»è‡ªå·±åšä¸€ä»¶äº‹ï¼Œåœ¨ä½¿ç”¨ä»£ç†ä¹‹åï¼ŒAç±»ä¸ç›´æ¥å»åšï¼Œè€Œæ˜¯ç”±Aç±»çš„ä»£ç†ç±»Bæ¥å»åšã€‚ä»£ç†ç±»å…¶å®æ˜¯åœ¨ä¹‹å‰ç±»çš„åŸºç¡€ä¸Šåšäº†ä¸€å±‚å°è£…ã€‚javaä¸­æœ‰é™æ€ä»£ç†ã€JDKåŠ¨æ€ä»£ç†ã€CGLibåŠ¨æ€ä»£ç†çš„æ–¹å¼ã€‚é™æ€ä»£ç†æŒ‡çš„æ˜¯ä»£ç†ç±»æ˜¯åœ¨ç¼–è¯‘æœŸå°±å­˜åœ¨çš„ï¼Œç›¸ååŠ¨æ€ä»£ç†åˆ™æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸåŠ¨æ€ç”Ÿæˆçš„ï¼Œ</p>
<p>ä»£ç†æ¨¡å¼çš„åŠŸèƒ½ä¸»è¦æ˜¯èµ·åˆ°å¢å¼ºæ–¹æ³•å’Œæƒé™æ‹¦æˆªçš„ä½œç”¨ã€‚</p>
<img src="/images/Spring5/image-20201120153501285.png" srcset="/img/loading.gif" alt="image-20201120153501285" style="zoom:50%;" />

<h3 id="9-1-é™æ€ä»£ç†"><a href="#9-1-é™æ€ä»£ç†" class="headerlink" title="9.1 é™æ€ä»£ç†"></a>9.1 é™æ€ä»£ç†</h3><p>é™æ€ä»£ç†è§’è‰²åˆ†æ</p>
<ul>
<li>æŠ½è±¡è§’è‰²ï¼šä¸€èˆ¬ä½¿ç”¨æ¥å£æˆ–è€…æŠ½è±¡ç±»æ¥å®ç°ã€‚</li>
<li>çœŸå®è§’è‰²ï¼šè¢«ä»£ç†çš„è§’è‰²ã€‚</li>
<li>ä»£ç†è§’è‰²ï¼šä»£ç†çœŸå®è§’è‰²ï¼›  <ul>
<li>ä»£ç†çœŸå®è§’è‰²åï¼Œä¸€èˆ¬ä¼šåšä¸€äº›é™„å±çš„æ“ä½œ</li>
</ul>
</li>
<li>å®¢æˆ·ï¼šä½¿ç”¨ä»£ç†è§’è‰²æ¥è¿›è¡Œä¸€äº›æ“ä½œ</li>
</ul>
<p><strong>ä»£ç å®ç°ä¸åˆ†æ</strong></p>
<p>Rent.java  å³æŠ½è±¡è§’è‰²</p>
<pre><code class="hljs java"><span class="hljs-comment">//æŠ½è±¡è§’è‰²ï¼šç§Ÿæˆ¿</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Rent</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span><span class="hljs-params">()</span></span>;
&#125;</code></pre>

<p>Host.java å³çœŸå®è§’è‰²</p>
<pre><code class="hljs java"><span class="hljs-comment">//çœŸå®è§’è‰²ï¼šæˆ¿ä¸œ æˆ¿ä¸œè¦å‡ºç§Ÿæˆ¿å­</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Host</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Rent</span></span>&#123;
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span><span class="hljs-params">()</span></span>&#123;
    System.out.println(<span class="hljs-string">&quot;æˆ¿å±‹å‡ºç§Ÿï¼&quot;</span>);
  &#125;
&#125;</code></pre>

<p>Proxy.java å³ä»£ç†è§’è‰²</p>
<pre><code class="hljs java"><span class="hljs-comment">//ä»£ç†è§’è‰²ï¼šä¸­ä»‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Proxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Rent</span> </span>&#123;

   <span class="hljs-keyword">private</span> Host host;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Proxy</span><span class="hljs-params">()</span> </span>&#123; &#125;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Proxy</span><span class="hljs-params">(Host host)</span> </span>&#123;
       <span class="hljs-keyword">this</span>.host = host;
  &#125;

   <span class="hljs-comment">//ç§Ÿæˆ¿</span>
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">rent</span><span class="hljs-params">()</span></span>&#123;
       seeHouse();
       host.rent();
       fare();
  &#125;
   <span class="hljs-comment">//çœ‹æˆ¿</span>
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">seeHouse</span><span class="hljs-params">()</span></span>&#123;
       System.out.println(<span class="hljs-string">&quot;å¸¦æˆ¿å®¢çœ‹æˆ¿&quot;</span>);
  &#125;
   <span class="hljs-comment">//æ”¶ä¸­ä»‹è´¹</span>
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">fare</span><span class="hljs-params">()</span></span>&#123;
       System.out.println(<span class="hljs-string">&quot;æ”¶ä¸­ä»‹è´¹&quot;</span>);
  &#125;
&#125;
Client . java å³å®¢æˆ·

<span class="hljs-comment">//å®¢æˆ·ç±»ï¼Œä¸€èˆ¬å®¢æˆ·éƒ½ä¼šå»æ‰¾ä»£ç†ï¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
       <span class="hljs-comment">//æˆ¿ä¸œè¦ç§Ÿæˆ¿</span>
       Host host = <span class="hljs-keyword">new</span> Host();
       <span class="hljs-comment">//ä¸­ä»‹å¸®åŠ©æˆ¿ä¸œ</span>
       Proxy proxy = <span class="hljs-keyword">new</span> Proxy(host);

       <span class="hljs-comment">//ä½ å»æ‰¾ä¸­ä»‹ï¼</span>
       proxy.rent();
  &#125;
&#125;</code></pre>

<p>Client . java å³å®¢æˆ·</p>
<pre><code class="hljs java"><span class="hljs-comment">//å®¢æˆ·ç±»ï¼Œä¸€èˆ¬å®¢æˆ·éƒ½ä¼šå»æ‰¾ä»£ç†ï¼</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
       <span class="hljs-comment">//æˆ¿ä¸œè¦ç§Ÿæˆ¿</span>
       Host host = <span class="hljs-keyword">new</span> Host();
       <span class="hljs-comment">//ä¸­ä»‹å¸®åŠ©æˆ¿ä¸œ</span>
       Proxy proxy = <span class="hljs-keyword">new</span> Proxy(host);

       <span class="hljs-comment">//ä½ å»æ‰¾ä¸­ä»‹ï¼</span>
       proxy.rent();
  &#125;
&#125;</code></pre>

<p>åˆ†æï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ ç›´æ¥æ¥è§¦çš„å°±æ˜¯ä¸­ä»‹ï¼Œå°±å¦‚åŒç°å®ç”Ÿæ´»ä¸­çš„æ ·å­ï¼Œä½ çœ‹ä¸åˆ°æˆ¿ä¸œï¼Œä½†æ˜¯ä½ ä¾æ—§é€šè¿‡ä¸­ä»‹ï¼Œç§Ÿåˆ°äº†æˆ¿ä¸œçš„æˆ¿å­ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„ä»£ç†æ¨¡å¼ï¼Œç¨‹åºæºäºç”Ÿæ´»ï¼Œæ‰€ä»¥å­¦ç¼–ç¨‹çš„äººï¼Œä¸€èˆ¬èƒ½å¤Ÿæ›´åŠ æŠ½è±¡çš„çœ‹å¾…ç”Ÿæ´»ä¸­å‘ç”Ÿçš„äº‹æƒ…ã€‚</p>
<p><strong>é™æ€ä»£ç†çš„å¥½å¤„ï¼š</strong></p>
<ul>
<li>å¯ä»¥ä½¿å¾—æˆ‘ä»¬çš„çœŸå®è§’è‰²æ›´åŠ çº¯ç²¹ï¼Œä¸å†å»å…³æ³¨ä¸€äº›å…¬å…±çš„äº‹æƒ…ã€‚</li>
<li>å…¬å…±çš„ä¸šåŠ¡ç”±ä»£ç†æ¥å®Œæˆï¼Œæ˜¯è¥¿å®‰äº†ä¸šåŠ¡åˆ†å·¥ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<ul>
<li>ç±»å¤šäº†ï¼Œå¤šäº†ä»£ç†ç±»ï¼Œå·¥ä½œé‡å˜å¤§äº†ï¼Œå¼€å‘æ•ˆç‡é™ä½ã€‚</li>
</ul>
<p><strong>å†ä¸¾ä¸ªä¾‹å­ï¼š</strong></p>
<p>1ã€åˆ›å»ºä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œæ¯”å¦‚å’‹ä»¬å¹³æ—¶åšçš„ç”¨æˆ·ä¸šåŠ¡ï¼ŒæŠ½è±¡èµ·æ¥å°±æ˜¯å¢åˆ æ”¹æŸ¥ï¼</p>
<pre><code class="hljs java"><span class="hljs-comment">//æŠ½è±¡è§’è‰²ï¼šå¢åˆ æ”¹æŸ¥ä¸šåŠ¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span></span>;
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>;
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>;
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">query</span><span class="hljs-params">()</span></span>;
&#125;</code></pre>

<p>2ã€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªçœŸå®å¯¹è±¡æ¥å®Œæˆè¿™äº›å¢åˆ æ”¹æŸ¥æ“ä½œ</p>
<pre><code class="hljs java"><span class="hljs-comment">//çœŸå®å¯¹è±¡ï¼Œå®Œæˆå¢åˆ æ”¹æŸ¥æ“ä½œçš„äºº</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-title">implementsUserService</span> </span>&#123;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span> </span>&#123;
       System.out.println(<span class="hljs-string">&quot;å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;
       System.out.println(<span class="hljs-string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;
       System.out.println(<span class="hljs-string">&quot;æ›´æ–°äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query</span><span class="hljs-params">()</span> </span>&#123;
       System.out.println(<span class="hljs-string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
  &#125;
&#125;</code></pre>

<p>3ã€éœ€æ±‚æ¥äº†ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªæ—¥å¿—åŠŸèƒ½ï¼Œæ€ä¹ˆå®ç°ï¼</p>
<ul>
<li>æ€è·¯1 ï¼šåœ¨å®ç°ç±»ä¸Šå¢åŠ ä»£ç  ã€éº»çƒ¦ï¼ã€‘</li>
<li>æ€è·¯2ï¼šä½¿ç”¨ä»£ç†æ¥åšï¼Œèƒ½å¤Ÿä¸æ”¹å˜åŸæ¥çš„ä¸šåŠ¡æƒ…å†µä¸‹ï¼Œå®ç°æ­¤åŠŸèƒ½å°±æ˜¯æœ€å¥½çš„äº†ï¼</li>
</ul>
<p>4ã€è®¾ç½®ä¸€ä¸ªä»£ç†ç±»æ¥å¤„ç†æ—¥å¿—ï¼ä»£ç†è§’è‰²</p>
<pre><code class="hljs java"><span class="hljs-comment">//ä»£ç†è§’è‰²ï¼Œåœ¨è¿™é‡Œé¢å¢åŠ æ—¥å¿—çš„å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceProxy</span> <span class="hljs-title">implementsUserService</span> </span>&#123;
   <span class="hljs-keyword">private</span> UserServiceImpl userService;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setUserService</span><span class="hljs-params">(UserServiceImpluserService)</span> </span>&#123;
       <span class="hljs-keyword">this</span>.userService = userService;
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span> </span>&#123;
       log(<span class="hljs-string">&quot;add&quot;</span>);
       userService.add();
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;
       log(<span class="hljs-string">&quot;delete&quot;</span>);
       userService.delete();
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;
       log(<span class="hljs-string">&quot;update&quot;</span>);
       userService.update();
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">query</span><span class="hljs-params">()</span> </span>&#123;
       log(<span class="hljs-string">&quot;query&quot;</span>);
       userService.query();
  &#125;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String msg)</span></span>&#123;
       System.out.println(<span class="hljs-string">&quot;æ‰§è¡Œäº†&quot;</span>+msg+<span class="hljs-string">&quot;æ–¹æ³•&quot;</span>);
  &#125;

&#125;</code></pre>

<p>5ã€æµ‹è¯•è®¿é—®ç±»ï¼š</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;
   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
       <span class="hljs-comment">//çœŸå®ä¸šåŠ¡</span>
       UserServiceImpl userService = newUserServiceImpl();
       <span class="hljs-comment">//ä»£ç†ç±»</span>
       UserServiceProxy proxy = newUserServiceProxy();
       <span class="hljs-comment">//ä½¿ç”¨ä»£ç†ç±»å®ç°æ—¥å¿—åŠŸèƒ½ï¼</span>
       proxy.setUserService(userService);

       proxy.add();
  &#125;
&#125;</code></pre>

<p><strong>å…¶ä¸­çš„æ€æƒ³å°±æ˜¯ï¼š==æˆ‘ä»¬åœ¨ä¸æ”¹å˜åŸæ¥çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†å¯¹åŸæœ‰åŠŸèƒ½çš„å¢å¼ºï¼Œè¿™æ˜¯AOPä¸­æœ€æ ¸å¿ƒçš„æ€æƒ³ã€‚==</strong></p>
<p>AOPï¼šçºµå‘å¼€å‘ï¼Œæ¨ªå‘å¼€å‘</p>
<img src="/images/Spring5/image-20201121120114168.png" srcset="/img/loading.gif" alt="image-20201121120114168" style="zoom:50%;" />

<p>æˆ‘ä»¬æƒ³è¦é™æ€ä»£ç†çš„å¥½å¤„ï¼Œåˆä¸æƒ³è¦é™æ€ä»£ç†çš„ç¼ºç‚¹ï¼ˆå·¥ä½œé‡å˜å¤§ï¼Œå¼€å‘æ•ˆç‡ä½ï¼‰ï¼Œæ‰€ä»¥å°±æœ‰äº†åŠ¨æ€ä»£ç†ï¼</p>
<h3 id="9-2-åŠ¨æ€ä»£ç†"><a href="#9-2-åŠ¨æ€ä»£ç†" class="headerlink" title="9.2 åŠ¨æ€ä»£ç†"></a>9.2 åŠ¨æ€ä»£ç†</h3><p>åŠ¨æ€ä»£ç†çš„åº•å±‚å°±æ˜¯åå°„ï¼</p>
<ul>
<li><p>åŠ¨æ€ä»£ç†çš„è§’è‰²å’Œé™æ€ä»£ç†æ˜¯ä¸€æ ·çš„ã€‚</p>
</li>
<li><p>åŠ¨æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯åŠ¨æ€ç”Ÿæˆçš„ã€‚é™æ€ä»£ç†çš„ä»£ç†ç±»æ˜¯æˆ‘ä»¬æå‰å†™å¥½çš„ã€‚</p>
</li>
<li><p>åŠ¨æ€ä»£ç†åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯åŸºäºåŠ¨æ€æ¥å£ä»£ç†ã€ä¸€ç±»æ˜¯åŸºäºç±»çš„åŠ¨æ€ä»£ç†ã€‚</p>
<ul>
<li>åŸºäºæ¥å£çš„åŠ¨æ€ä»£ç†â€”â€”JDKåŠ¨æ€ä»£ç†</li>
<li>åŸºäºç±»çš„åŠ¨æ€ä»£ç†â€”â€”cglib</li>
<li>Javaå­—èŠ‚ç ï¼šç°åœ¨ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯javasistæ¥ç”ŸæˆåŠ¨æ€ä»£ç†</li>
</ul>
</li>
</ul>
<p>æˆ‘ä»¬è¿™é‡Œä½¿ç”¨JDKçš„åŸç”Ÿä»£ç æ¥å®ç°ï¼Œå…¶ä½™çš„é“ç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p><strong>JDKçš„åŠ¨æ€ä»£ç†éœ€è¦äº†è§£ä¸¤ä¸ªç±»ï¼š</strong></p>
<p>æ ¸å¿ƒï¼šInvocationHandlerï¼ˆè°ƒç”¨å¤„ç†ç¨‹åºï¼‰å’ŒProxyï¼ˆä»£ç†ï¼‰</p>
<pre><code class="hljs java"><span class="hljs-function">Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, æ–¹æ³• method, Object[]args)</span></span>;</code></pre>

<p>å‚æ•°è¯´æ˜ï¼š</p>
<ul>
<li>proxyï¼šè°ƒç”¨è¯¥æ–¹æ³•çš„ä»£ç†å®ä¾‹</li>
<li>methodï¼šæ‰€è¿°æ–¹æ³•å¯¹åº”äºè°ƒç”¨ä»£ç†å®ä¾‹ä¸Šçš„æ¥å£æ–¹æ³•çš„å®ä¾‹ã€‚æ–¹æ³•å¯¹è±¡çš„å£°æ˜ç±»å°†æ˜¯è¯¥æ–¹æ³•å£°æ˜çš„æ¥å£ï¼Œå®ƒå¯ä»¥æ˜¯ä»£ç†ç±»ç»§æ‰¿è¯¥æ–¹æ³•çš„ä»£ç†æ¥å£çš„è¶…çº§æ¥å£ã€‚</li>
<li>args ï¼šåŒ…å«çš„æ–¹æ³•è°ƒç”¨ä¼ é€’ä»£ç†å®ä¾‹çš„å‚æ•°å€¼çš„å¯¹è±¡çš„é˜µåˆ—ï¼Œæˆ–nullå¦‚æœæ¥å£æ–¹æ³•æ²¡æœ‰å‚æ•°ã€‚åŸå§‹ç±»å‹çš„å‚æ•°åŒ…å«åœ¨é€‚å½“çš„åŸå§‹åŒ…è£…å™¨ç±»çš„å®ä¾‹ä¸­ï¼Œä¾‹å¦‚java.lang.Integeræˆ–java.lang.Boolean ã€‚</li>
</ul>
<p><strong>ä»£ç å®ç°ï¼š</strong></p>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.pojo;

<span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;
<span class="hljs-keyword">import</span> java.lang.reflect.Method;
<span class="hljs-keyword">import</span> java.lang.reflect.Proxy;

<span class="hljs-comment">//åŠ¨æ€ç”Ÿæˆä»£ç†ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ProxyInvocationHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">InvocationHandler</span> </span>&#123;
    <span class="hljs-comment">//è¢«ä»£ç†çš„æ¥å£</span>
    <span class="hljs-keyword">private</span> Object target;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setTarget</span><span class="hljs-params">(Object target)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.target = target;
    &#125;

    <span class="hljs-comment">//ç”Ÿæˆå¾—åˆ°ä»£ç†ç±»</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">getProxy</span><span class="hljs-params">()</span></span>&#123;
        <span class="hljs-keyword">return</span> Proxy.newProxyInstance(<span class="hljs-keyword">this</span>.getClass().getClassLoader(), target.getClass().getInterfaces(),<span class="hljs-keyword">this</span>);
    &#125;

    <span class="hljs-comment">//å¤„ç†ä»£ç†å®ä¾‹ï¼Œå¹¶è¿”å›ç»“æœ</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Object <span class="hljs-title">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;
        log(method.getName());<span class="hljs-comment">//å¯ä»¥é€šè¿‡methodåšå¾ˆå¤šäº‹æƒ…ï¼</span>
        <span class="hljs-comment">//åŠ¨æ€ä»£ç†çš„æœ¬è´¨ï¼Œå°±æ˜¯ä½¿ç”¨åå°„æœºåˆ¶å®ç°</span>
        Object result = method.invoke(target, args);
        <span class="hljs-keyword">return</span> result;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">log</span><span class="hljs-params">(String msg)</span></span>&#123;
        System.out.println(msg);
    &#125;
&#125;
</code></pre>

<p>å®¢æˆ·ç«¯ï¼š</p>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.pojo;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Client</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        <span class="hljs-comment">//çœŸå®è§’è‰²</span>
        Host host = <span class="hljs-keyword">new</span> Host();
        <span class="hljs-comment">//ä»£ç†è§’è‰²  ç°åœ¨æ²¡æœ‰ åªæœ‰ä¸€ä¸ªå¤„ç†ç¨‹åº</span>
        ProxyInvocationHandler pih = <span class="hljs-keyword">new</span> ProxyInvocationHandler();
        <span class="hljs-comment">//é€šè¿‡è°ƒç”¨ç¨‹åºå¤„ç†è§’è‰² æ¥å¤„ç†æˆ‘ä»¬è¦è°ƒç”¨çš„æ¥å£å¯¹è±¡</span>
        pih.setTarget(host);
        <span class="hljs-comment">//ç”Ÿæˆä»£ç†è§’è‰²</span>
        Rent proxy = (Rent)pih.getProxy();
        proxy.rent();
    &#125;
&#125;
</code></pre>

<p>éšç€ä¸šåŠ¡çš„åºå¤§ï¼Œä½¿ç”¨é™æ€ä»£ç†çš„è¯ï¼Œä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„ä»£ç†ç±»ï¼Œå› æ­¤æˆ‘ä»¬é€‰æ‹©äº†åŠ¨æ€ä»£ç†ç±»ã€‚åŠ¨æ€ä»£ç†ç±»ï¼Œä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ã€‚ï¼ˆ<strong>é€šè¿‡ä¼ å…¥çš„çœŸå®ç±» ä¼šæ‰¾åˆ°æœ€ä¸Šå±‚çš„æ¥å£ï¼Œè¿™æ˜¯æˆ‘çŒœæƒ³çš„ï¼Œåº”è¯¥æ˜¯åå°„æœºåˆ¶çš„åŸå› ï¼Œä¹‹åå­¦äº†åå°„ä¹‹åï¼Œå†æ¥è¿›è¡Œè¡¥å……ï¼ï¼</strong>ï¼‰</p>
<p><strong>åŠ¨æ€ä»£ç†çš„å¥½å¤„ï¼š</strong></p>
<ul>
<li>Proxyç±»çš„ä»£ç é‡è¢«å›ºå®šä¸‹æ¥ï¼Œä¸ä¼šå› ä¸ºä¸šåŠ¡çš„é€æ¸åºå¤§è€Œåºå¤§ï¼›</li>
<li>å¯ä»¥å®ç°AOPç¼–ç¨‹ï¼Œå®é™…ä¸Šé™æ€ä»£ç†ä¹Ÿå¯ä»¥å®ç°ï¼Œæ€»çš„æ¥è¯´ï¼ŒAOPå¯ä»¥ç®—ä½œæ˜¯ä»£ç†æ¨¡å¼çš„ä¸€ä¸ªå…¸å‹åº”ç”¨ï¼›</li>
<li>è§£è€¦ï¼Œé€šè¿‡å‚æ•°å°±å¯ä»¥åˆ¤æ–­çœŸå®ç±»ï¼Œä¸éœ€è¦äº‹å…ˆå®ä¾‹åŒ–ï¼Œæ›´åŠ çµæ´»å¤šå˜ã€‚</li>
<li>ä¸€ä¸ªåŠ¨æ€ä»£ç†å¯ä»¥ä»£ç†å¤šä¸ªç±»ï¼Œä»£ç†çš„æ˜¯æ¥å£ï¼</li>
</ul>
<h2 id="10-AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹"><a href="#10-AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹" class="headerlink" title="10. AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹"></a>10. AOP-é¢å‘åˆ‡é¢ç¼–ç¨‹</h2><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¬äº†è§£äº†ä»£ç†æ¨¡å¼ï¼Œè¿™æ˜¯AOPçš„åŸºç¡€ï¼ŒAOPæ˜¯ä»£ç†æ¨¡å¼çš„ä¸€ä¸ªåº”ç”¨ï¼</p>
<h3 id="10-1-ä»€ä¹ˆæ˜¯AOP"><a href="#10-1-ä»€ä¹ˆæ˜¯AOP" class="headerlink" title="10.1 ä»€ä¹ˆæ˜¯AOP"></a>10.1 ä»€ä¹ˆæ˜¯AOP</h3><p>AOPï¼ˆAspect Oriented Programmingï¼‰æ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡<strong>é¢„ç¼–è¯‘æ–¹å¼</strong>å’Œ<strong>è¿è¡ŒæœŸåŠ¨æ€ä»£ç†</strong>å®ç°<strong>ç¨‹åºåŠŸèƒ½çš„ç»Ÿä¸€ç»´æŠ¤</strong>çš„ä¸€ç§æŠ€æœ¯ã€‚</p>
<p>AOPæ˜¯OOPçš„å»¶ç»­ï¼Œæ˜¯è½¯ä»¶å¼€å‘ä¸­çš„ä¸€ä¸ªçƒ­ç‚¹ï¼Œä¹Ÿæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªé‡è¦å†…å®¹ï¼Œæ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªè¡ç”Ÿæ³›å‹ã€‚åˆ©ç”¨AOPå¯ä»¥å¯¹ä¸šåŠ¡é€»è¾‘çš„å„ä¸ªéƒ¨åˆ†è¿›è¡Œéš”ç¦»ï¼Œä»è€Œä½¿ä¸šåŠ¡é€»è¾‘å„éƒ¨åˆ†ä¹‹é—´çš„è€¦åˆåº¦é™ä½ï¼Œæé«˜ç¨‹åºçš„å¯é‡ç”¨æ€§ï¼ŒåŒæ—¶æé«˜äº†å¼€å‘çš„æ•ˆç‡ã€‚</p>
<img src="/images/Spring5/640" srcset="/img/loading.gif" alt="img" style="zoom:50%;" />

<p>å…¬å¸è¦æ±‚ä¸æ”¹å˜åŸæœ‰çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¢åŠ æ—¥å¿—çš„åŠŸèƒ½ã€‚å…¶å®å†™ä¸ªä»£ç†ç±»å°±å¯ä»¥äº†ï¼Œå¢åŠ éªŒè¯å‚æ•°ã€å‰ç½®æ—¥å¿—ã€åç½®æ—¥å¿—ã€‚</p>
<p>ä½†æ˜¯åœ¨Springä¸­å¯èƒ½æ¯”è¾ƒéº»çƒ¦ã€‚</p>
<h3 id="10-2-AOPåœ¨Springä¸­çš„ä½œç”¨"><a href="#10-2-AOPåœ¨Springä¸­çš„ä½œç”¨" class="headerlink" title="10.2 AOPåœ¨Springä¸­çš„ä½œç”¨"></a>10.2 AOPåœ¨Springä¸­çš„ä½œç”¨</h3><p>==æä¾›å£°æ˜å¼äº‹åŠ¡ï¼šå…è®¸ç”¨æˆ·è‡ªå®šä¹‰åˆ‡é¢==</p>
<p>ä»¥ä¸‹åè¯éœ€è¦äº†è§£ï¼š</p>
<ul>
<li>æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼šè·¨è¶Šåº”ç”¨ç¨‹åºå¤šä¸ªæ¨¡å—çš„æ–¹æ³•æˆ–åŠŸèƒ½ã€‚å°±æ˜¯ï¼Œä¸æˆ‘ä»¬ä¸šåŠ¡åˆ‡é¢é€»è¾‘æ— å…³çš„ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚å¦‚ï¼šæ—¥å¿—ï¼Œå®‰å…¨ï¼Œç¼“å­˜ï¼Œäº‹åŠ¡ã€‚ã€‚ã€‚</li>
<li>åˆ‡é¢ï¼ˆAspectï¼‰ï¼šæ¨ªåˆ‡å…³æ³¨ç‚¹è¢«æ¨¡å—åŒ–çš„ç‰¹æ®Šå¯¹è±¡ã€‚å³ï¼Œ<strong>ä»–æ˜¯ä¸€ä¸ªç±»</strong>ã€‚</li>
<li>é€šçŸ¥ï¼ˆAdviceï¼‰ï¼šåˆ‡é¢å¿…é¡»è¦å®Œæˆçš„å·¥ä½œã€‚å³ï¼Œ<strong>ä»–æ˜¯ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•</strong>ã€‚</li>
<li>ç›®æ ‡ï¼ˆTargetï¼‰ï¼šè¢«é€šçŸ¥å¯¹è±¡ã€‚</li>
<li>ä»£ç†ï¼ˆProxyï¼‰ï¼šå‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„å¯¹è±¡ã€‚</li>
<li>åˆ‡å…¥ç‚¹ï¼ˆPointCutï¼‰ï¼šåˆ‡é¢é€šçŸ¥ æ‰§è¡Œçš„ â€œåœ°ç‚¹â€çš„å®šä¹‰</li>
<li>è¿æ¥ç‚¹ï¼ˆJointPointï¼‰ï¼šä¸åˆ‡å…¥ç‚¹åŒ¹é…çš„æ‰§è¡Œç‚¹ã€‚</li>
</ul>
<img src="/images/Spring5/640" srcset="/img/loading.gif" alt="img" style="zoom:50%;" />



<p>SpringAOPä¸­ï¼Œé€šè¿‡Adiviceå®šä¹‰æ¨ªåˆ‡é€»è¾‘ï¼ŒSpringä¸­æ”¯æŒ5ç§ç±»å‹çš„Adviceã€‚</p>
<img src="/images/Spring5/640" srcset="/img/loading.gif" alt="img" style="zoom:50%;" />

<p>å³ï¼ŒAOPåœ¨ä¸æ”¹å˜åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œå»å¢åŠ æ–°çš„åŠŸèƒ½ã€‚</p>
<h3 id="10-3-ä½¿ç”¨Springå®ç°AOP"><a href="#10-3-ä½¿ç”¨Springå®ç°AOP" class="headerlink" title="10.3 ä½¿ç”¨Springå®ç°AOP"></a>10.3 ä½¿ç”¨Springå®ç°AOP</h3><h4 id="AOPå®ç°â€”â€”é€šè¿‡Spring-APIå®ç°"><a href="#AOPå®ç°â€”â€”é€šè¿‡Spring-APIå®ç°" class="headerlink" title="AOPå®ç°â€”â€”é€šè¿‡Spring APIå®ç°"></a>AOPå®ç°â€”â€”é€šè¿‡Spring APIå®ç°</h4><ol>
<li>ç¼–å†™ä¸šåŠ¡æ¥å£å’Œå®ç°ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserService</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">select</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span></span>;
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserService</span></span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">add</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">delete</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;åˆ é™¤äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">select</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;æŸ¥è¯¢äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">update</span><span class="hljs-params">()</span> </span>&#123;
        System.out.println(<span class="hljs-string">&quot;ä¿®æ”¹äº†ä¸€ä¸ªç”¨æˆ·&quot;</span>);
    &#125;
&#125;
</code></pre>

<ol start="2">
<li>ç¼–å†™å¢å¼ºç±»ï¼Œæˆ‘ä»¬ç¼–å†™ä¸¤ä¸ªï¼Œä¸€ä¸ªå‰ç½®å¢å¼ºã€ä¸€ä¸ªåç½®å¢å¼º</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogBefore</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">MethodBeforeAdvice</span> </span>&#123;
    <span class="hljs-comment">/*</span>
<span class="hljs-comment">    * method  è¦æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span>
<span class="hljs-comment">    * objects è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°</span>
<span class="hljs-comment">    * o ç›®æ ‡å¯¹è±¡</span>
<span class="hljs-comment">    * */</span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">(Method method, Object[] objects, Object o)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;
        System.out.println(o.getClass().getName() + <span class="hljs-string">&quot;çš„&quot;</span> + method.getName() + <span class="hljs-string">&quot;æ–¹æ³•æ‰§è¡Œäº†&quot;</span>);
    &#125;
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Method;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LogAfter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AfterReturningAdvice</span> </span>&#123;
    <span class="hljs-comment">/*</span>
<span class="hljs-comment">    * o è¿”å›å€¼</span>
<span class="hljs-comment">    * method è¢«è°ƒç”¨çš„æ–¹æ³•</span>
<span class="hljs-comment">    * objects  è¢«è°ƒç”¨æ–¹æ³•çš„å‚æ•°</span>
<span class="hljs-comment">    * o1 è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡</span>
<span class="hljs-comment">    * */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">afterReturning</span><span class="hljs-params">(Object o, Method method, Object[] objects, Object o1)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;
        System.out.println(o1.getClass().getName() + <span class="hljs-string">&quot;çš„&quot;</span> + method.getName() + <span class="hljs-string">&quot;æ–¹æ³•ï¼Œè¿”å›å€¼ï¼š&quot;</span> + o);
    &#125;
&#125;</code></pre>

<ol start="3">
<li>æœ€åå»Springçš„æ–‡ä»¶ä¸­è¿›è¡Œæ³¨å†Œï¼Œå¹¶å®ç°AOPåˆ‡å…¥å®ç°ï¼Œæ³¨æ„éœ€è¦å¯¼å…¥çº¦æŸï¼</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/aop</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!--æ³¨å†Œbean--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.UserServiceImpl&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;logBefore&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.LogBefore&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;logAfter&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.LogAfter&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!--aopçš„é…ç½®--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span>
        <span class="hljs-comment">&lt;!--åˆ‡å…¥ç‚¹ï¼Œ expression:è¡¨è¾¾å¼åŒ¹é…è¦æ‰§è¡Œçš„æ–¹æ³•--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pointcut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.wen.demo1.UserServiceImpl.*(..))&quot;</span>/&gt;</span>
        <span class="hljs-comment">&lt;!--æ‰§è¡Œç¯ç»•ï¼Œadvice-ref æ‰§è¡Œæ–¹æ³• pointcut-ref åˆ‡å…¥ç‚¹--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;logAfter&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pointcut&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;logBefore&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;pointcut&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="4">
<li>æµ‹è¯•ã€‚</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
        UserService userService = applicationContext.getBean(<span class="hljs-string">&quot;userService&quot;</span>, UserService.class);
        userService.add();
    &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201122211541022.png" srcset="/img/loading.gif" alt="image-20201122211541022" style="zoom:50%;" />

<p>AOPçš„é‡è¦æ€§ï¼šå¾ˆé‡è¦ï¼ä¸€å®šè¦ç†è§£å…¶ä¸­çš„æ€è·¯ï¼Œä¸»è¦æ˜¯æ€æƒ³çš„ç†è§£ï¼</p>
<p>Springçš„AOPå°±æ˜¯å°†å…¬å…±ä¸šåŠ¡ï¼ˆæ—¥å¿—ã€å®‰å…¨ç­‰ï¼‰å’Œé¢†åŸŸä¸šåŠ¡ç»“åˆèµ·æ¥ï¼Œå½“æ‰§è¡Œé¢†åŸŸä¸šåŠ¡æ—¶ï¼Œå°†ä¼šæŠŠå…¬å…±ä¸šåŠ¡åŠ è¿›æ¥ï¼Œå®ç°å…¬å…±ä¸šåŠ¡çš„é‡å¤åˆ©ç”¨ã€‚é¢†åŸŸä¸šåŠ¡æ›´çº¯ç²¹ï¼Œç¨‹åºå‘˜ä¸“æ³¨é¢†åŸŸä¸šåŠ¡ï¼Œå…¶æœ¬è´¨è¿˜æ˜¯åŠ¨æ€ä»£ç†ï¼</p>
<h4 id="AOPå®ç°â€”â€”è‡ªå®šä¹‰ç±»æ¥å®ç°AOP"><a href="#AOPå®ç°â€”â€”è‡ªå®šä¹‰ç±»æ¥å®ç°AOP" class="headerlink" title="AOPå®ç°â€”â€”è‡ªå®šä¹‰ç±»æ¥å®ç°AOP"></a>AOPå®ç°â€”â€”è‡ªå®šä¹‰ç±»æ¥å®ç°AOP</h4><p>ç›®æ ‡ä¸šåŠ¡ç±»ä¸å˜ï¼ä¾æ—§æ˜¯UserServiceImplï¼</p>
<ol>
<li>é¦–å…ˆç¼–å†™ä¸€ä¸ªåˆ‡å…¥ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DiyPointcut</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;--------æ–¹æ³•æ‰§è¡Œå‰----------&quot;</span>);
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;--------æ–¹æ³•æ‰§è¡Œå----------&quot;</span>);
    &#125;
&#125;</code></pre>

<ol start="2">
<li>åœ¨Springä¸­è¿›è¡Œé…ç½®</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/aop</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!--æ³¨å†Œbean--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.UserServiceImpl&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;logBefore&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.LogBefore&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;logAfter&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.LogAfter&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;diy&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo2.DiyPointcut&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!--aopçš„é…ç½®--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspect</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;diy&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;diyPointCut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.wen.demo1.UserServiceImpl.*(..))&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">aop:before</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;before&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;diyPointCut&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">aop:after</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;after&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;diyPointCut&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">aop:aspect</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
        UserService userService = applicationContext.getBean(<span class="hljs-string">&quot;userService&quot;</span>, UserService.class);
        userService.add();
    &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201122212833713.png" srcset="/img/loading.gif" alt="image-20201122212833713" style="zoom:50%;" />

<h4 id="AOPå®ç°â€”â€”ä½¿ç”¨æ³¨è§£å®ç°"><a href="#AOPå®ç°â€”â€”ä½¿ç”¨æ³¨è§£å®ç°" class="headerlink" title="AOPå®ç°â€”â€”ä½¿ç”¨æ³¨è§£å®ç°"></a>AOPå®ç°â€”â€”ä½¿ç”¨æ³¨è§£å®ç°</h4><ol>
<li>ç¼–å†™ä¸€ä¸ªæ³¨è§£å®ç°çš„å¢å¼ºç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.demo3;

<span class="hljs-keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;
<span class="hljs-keyword">import</span> org.aspectj.lang.annotation.After;
<span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Around;
<span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Aspect;
<span class="hljs-keyword">import</span> org.aspectj.lang.annotation.Before;

<span class="hljs-meta">@Aspect</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AnnotationPointCut</span> </span>&#123;

    <span class="hljs-meta">@Before(&quot;execution(* com.wen.demo1.UserServiceImpl.*(..))&quot;)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">before</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;--------æ–¹æ³•æ‰§è¡Œå‰----------&quot;</span>);
    &#125;
    <span class="hljs-meta">@After(&quot;execution(* com.wen.demo1.UserServiceImpl.*(..))&quot;)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">after</span><span class="hljs-params">()</span></span>&#123;
        System.out.println(<span class="hljs-string">&quot;--------æ–¹æ³•æ‰§è¡Œå----------&quot;</span>);
    &#125;
    <span class="hljs-meta">@Around(&quot;execution(* com.wen.demo1.UserServiceImpl.*(..))&quot;)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">around</span><span class="hljs-params">(ProceedingJoinPoint jp)</span> <span class="hljs-keyword">throws</span> Throwable </span>&#123;
        System.out.println(<span class="hljs-string">&quot;ç¯ç»•å‰&quot;</span>);
        System.out.println(<span class="hljs-string">&quot;ç­¾å:&quot;</span>+jp.getSignature());
        <span class="hljs-comment">//æ‰§è¡Œç›®æ ‡æ–¹æ³•proceed</span>
        Object proceed = jp.proceed();
        System.out.println(<span class="hljs-string">&quot;ç¯ç»•å&quot;</span>);
        System.out.println(proceed);
    &#125;
&#125;
</code></pre>

<ol start="2">
<li>åœ¨Springé…ç½®æ–‡ä»¶ä¸­ï¼Œæ³¨å†Œbeanï¼Œå¹¶å¢å¼ºæ”¯æŒæ³¨è§£çš„é…ç½®ã€‚</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/aop</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!--æ³¨å†Œbean--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo1.UserServiceImpl&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;annotationPointCut&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.demo3.AnnotationPointCut&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:aspectj-autoproxy</span>/&gt;</span>
    <span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">        é€šè¿‡aopå‘½åç©ºé—´çš„&lt;aop:aspectj-autoproxy /&gt;</span>
<span class="hljs-comment">        å£°æ˜è‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ã€‚</span>
<span class="hljs-comment">        å½“ç„¶ï¼Œspring åœ¨å†…éƒ¨ä¾æ—§é‡‡ç”¨AnnotationAwareAspectJAutoProxyCreator</span>
<span class="hljs-comment">				è¿›è¡Œè‡ªåŠ¨ä»£ç†çš„åˆ›å»ºå·¥ä½œï¼Œ</span>
<span class="hljs-comment">        ä½†å…·ä½“å®ç°çš„ç»†èŠ‚å·²ç»è¢«&lt;aop:aspectj-autoproxy /&gt;éšè—èµ·æ¥äº†</span>
<span class="hljs-comment">    --&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<img src="/images/Spring5/image-20201122214033151.png" srcset="/img/loading.gif" alt="image-20201122214033151" style="zoom:50%;" />

<p><strong>aop:aspectj-autoproxyï¼šè¯´æ˜</strong></p>
<p>é€šè¿‡aopå‘½åç©ºé—´çš„**&lt;aop:aspectj-autoproxy /&gt;**å£°æ˜è‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ã€‚å½“ç„¶ï¼Œspring åœ¨å†…éƒ¨ä¾æ—§é‡‡ç”¨AnnotationAwareAspectJAutoProxyCreatorè¿›è¡Œè‡ªåŠ¨ä»£ç†çš„åˆ›å»ºå·¥ä½œï¼Œä½†å…·ä½“å®ç°çš„ç»†èŠ‚å·²ç»è¢«&lt;aop:aspectj-autoproxy /&gt;éšè—èµ·æ¥äº†</p>
<p>&lt;aop:aspectj-autoproxy /&gt;æœ‰ä¸€ä¸ªproxy-target-classå±æ€§ï¼Œé»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºä½¿ç”¨jdkåŠ¨æ€ä»£ç†ç»‡å…¥å¢å¼ºï¼Œå½“é…ä¸º&lt;aop:aspectj-autoproxy  poxy-target-class=â€trueâ€/&gt;æ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨CGLibåŠ¨æ€ä»£ç†æŠ€æœ¯ç»‡å…¥å¢å¼ºã€‚ä¸è¿‡å³ä½¿proxy-target-classè®¾ç½®ä¸ºfalseï¼Œå¦‚æœç›®æ ‡ç±»æ²¡æœ‰å£°æ˜æ¥å£ï¼Œåˆ™springå°†è‡ªåŠ¨ä½¿ç”¨CGLibåŠ¨æ€ä»£ç†ã€‚</p>
<h2 id="11-æ•´åˆMyBatis"><a href="#11-æ•´åˆMyBatis" class="headerlink" title="11. æ•´åˆMyBatis"></a>11. æ•´åˆMyBatis</h2><p>æ­¥éª¤ï¼š</p>
<ol>
<li>å¯¼å…¥ç›¸å…³çš„jaråŒ…</li>
</ol>
<ul>
<li>junit</li>
<li>mybatis</li>
<li>mysqlæ•°æ®åº“</li>
<li>springç›¸å…³çš„</li>
<li>aopç»‡å…¥</li>
<li>mybatis-spring</li>
</ul>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/junit/junit --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.15<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!--springç›¸å…³--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-webmvc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-jdbc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.0.7.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-comment">&lt;!--mybatis-springæ•´åˆåŒ… ã€é‡ç‚¹ã€‘--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.3.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!--aspectJ AOP ç»‡å…¥å™¨--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.aspectj<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>aspectjweaver<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.9.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></code></pre>

<p><strong>é…ç½®Mavené™æ€èµ„æºè¿‡æ»¤é—®é¢˜ï¼</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
       <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
           <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
           <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span>
               <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
               <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
           <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span>
           <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span>
       <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span></code></pre>

<ol start="2">
<li><p>ç¼–å†™é…ç½®æ–‡ä»¶</p>
</li>
<li><p>ä»£ç å®ç°</p>
</li>
</ol>
<h3 id="11-1-å›é¡¾mybatis"><a href="#11-1-å›é¡¾mybatis" class="headerlink" title="11.1 å›é¡¾mybatis"></a>11.1 å›é¡¾mybatis</h3><ol>
<li>ç¼–å†™pojoå®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.pojo;

<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String pwd;
&#125;</code></pre>

<ol start="2">
<li>å®ç°mybatisçš„é…ç½®æ–‡ä»¶</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--mybatis-config.xml--&gt;</span>

<span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--æ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><span class="hljs-comment">&lt;!--äº‹åŠ¡ç®¡ç†--&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--æ•°æ®åº“ç›¸å…³--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span>
    <span class="hljs-comment">&lt;!--æ¯ä¸€ä¸ªMapper.xmléƒ½éœ€è¦åœ¨mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ--&gt;</span>
    <span class="hljs-comment">&lt;!--    Type interface com.wen.mapper.UserMapper id not known to the MapperRegistry.--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/wen/mapper/UserMapper.xml&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre>

<pre><code class="hljs properties"><span class="hljs-comment">#db.properties</span>
<span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
<span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;rewriteBatchedStatements=true</span>
<span class="hljs-attr">username</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">password</span>=<span class="hljs-string">645645aa</span></code></pre>

<ol start="3">
<li>ç¼–å†™MyBatisUtilså·¥å…·ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.utils;

<span class="hljs-keyword">import</span> org.apache.ibatis.io.Resources;
<span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;
<span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;
<span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;

<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStream;

<span class="hljs-comment">//SqlSessionFactory  SqlSession</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyBatisUtils</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSessionFactory sqlSessionFactory;
    <span class="hljs-keyword">static</span> &#123;
        <span class="hljs-keyword">try</span> &#123;
            <span class="hljs-comment">//ä½¿ç”¨mybatisç¬¬ä¸€æ­¥:è·å–SqlSessionFactoryå¯¹è±¡</span>
            String resource = <span class="hljs-string">&quot;mybatis-config.xml&quot;</span>;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            sqlSessionFactory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);
        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;
            e.printStackTrace();
        &#125;

    &#125;
    <span class="hljs-comment">//æ—¢ç„¶æœ‰äº† SqlSessionFactoryï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å¾— SqlSession çš„å®ä¾‹ã€‚</span>
    <span class="hljs-comment">// SqlSession æä¾›äº†åœ¨æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSqlSession</span><span class="hljs-params">()</span></span>&#123;
        SqlSession sqlSession = sqlSessionFactory.openSession();
        <span class="hljs-keyword">return</span> sqlSession;
    &#125;
&#125;</code></pre>

<ol start="4">
<li>è¿æ¥æ•°æ®åº“ï¼ˆIDEAï¼‰</li>
</ol>
<img src="/images/Spring5/image-20201123091508200.png" srcset="/img/loading.gif" alt="image-20201123091508200" style="zoom:50%;" />

<ol start="5">
<li>UserMapperæ¥å£ç¼–å†™</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.mapper;

<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(Map&lt;String,Object&gt; map)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;userId&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectAllUsers</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;userId&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;

&#125;</code></pre>



<ol start="6">
<li>æ¥å£å¯¹åº”çš„Mapperæ˜ å°„æ–‡ä»¶</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--çœå»äº†ä»¥å¾€çš„UserDaoImpl çœå»äº†è¿æ¥æ•°æ®åº“çš„ä¸€äº›è¯­å¥--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.wen.mapper.UserMapper&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--å‘½åç©ºé—´ ç»‘å®šä¸€ä¸ªæŒ‡å®šçš„Mapperæ¥å£--&gt;</span>


    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span>
        insert into mybatis.user(id, name, pwd) values (#&#123;userId&#125;, #&#123;userName&#125;, #&#123;userPwd&#125;)
    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteUser&quot;</span>&gt;</span>
        delete from mybatis.user where id=#&#123;userId&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectAllUsers&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
        select * from mybatis.user
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
        select * from mybatis.user where id=$&#123;userId&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span></code></pre>



<ol start="7">
<li>æµ‹è¯•ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">import</span> com.wen.mapper.UserMapper;
<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> com.wen.utils.MyBatisUtils;
<span class="hljs-keyword">import</span> org.apache.ibatis.session.SqlSession;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MapperTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        SqlSession sqlSession = MyBatisUtils.getSqlSession();
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        List&lt;User&gt; userList = mapper.selectAllUsers();
        <span class="hljs-keyword">for</span> (User user : userList) &#123;
            System.out.println(user.getName());
        &#125;
    &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201123091739554.png" srcset="/img/loading.gif" alt="image-20201123091739554" style="zoom:50%;" />

<p>æµ‹è¯•ï¼šæµ‹è¯•æˆåŠŸ</p>
<img src="/images/Spring5/image-20201123091755933.png" srcset="/img/loading.gif" alt="image-20201123091755933" style="zoom:50%;" />

<h3 id="11-2-æ•´åˆMyBatisæ–¹å¼ä¸€"><a href="#11-2-æ•´åˆMyBatisæ–¹å¼ä¸€" class="headerlink" title="11.2 æ•´åˆMyBatisæ–¹å¼ä¸€"></a>11.2 æ•´åˆMyBatisæ–¹å¼ä¸€</h3><p>æ•´ä¸ªé¡¹ç›®çš„ç»“æ„ï¼š</p>
<img src="/images/Spring5/image-20201123105615677.png" srcset="/img/loading.gif" alt="image-20201123105615677" style="zoom:50%;" />

<ol>
<li>ç¼–å†™applicationContext.xml</li>
</ol>
<p>è¦å’ŒSpringä¸€èµ·ä½¿ç”¨MyBatisï¼Œéœ€è¦åœ¨Springåº”ç”¨ä¸Šä¸‹æ–‡ä¸­å®šä¹‰è‡³å°‘ä¸¤æ ·ä¸œè¥¿ï¼šä¸€ä¸ªSqlSessionFactoryå’Œè‡³å°‘ä¸€ä¸ªæ•°æ®æ˜ å°„ç±»ã€‚</p>
<p>åœ¨ MyBatis-Spring ä¸­ï¼Œå¯ä½¿ç”¨SqlSessionFactoryBeanæ¥åˆ›å»º SqlSessionFactoryã€‚</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- æŒ‡å®šspringè¯»å–db.propertiesé…ç½® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!--DataSourceåŸæ¥ä½¿ç”¨çš„æ˜¯mybatisçš„ï¼Œç°åœ¨ä½¿ç”¨Springçš„æ•°æ®æº--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;name&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-comment">&lt;!--SqlSessionFactoryBean æ¥åˆ›å»º sqlSessionFactory--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span>
        <span class="hljs-comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶ è¿™æ ·å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å†™mybatis-config.xmlçš„ç›¸å…³é…ç½® å¦‚ä¸‹é¢åŒ…çš„æ‰«æ--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapperLocations&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:com/wen/mapper/*.xml&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-comment">&lt;!--SqlSessionTemplate æ˜¯ MyBatis-Spring çš„æ ¸å¿ƒã€‚</span>
<span class="hljs-comment">    ä½œä¸º SqlSession çš„ä¸€ä¸ªå®ç°ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å®ƒæ— ç¼ä»£æ›¿ä½ ä»£ç ä¸­å·²ç»åœ¨ä½¿ç”¨çš„ SqlSessionã€‚--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--å› ä¸ºSqlSessionTemplateæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨æ„é€ å™¨è¿›è¡Œæ³¨å…¥--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<p>å…¶ä¸­db.propertieså¦‚ä¸‹ï¼š</p>
<pre><code class="hljs properties"><span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
<span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span>
<span class="hljs-attr">name</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">password</span>=<span class="hljs-string">645645aa</span></code></pre>

<p>æ³¨æ„ï¼šname å¦‚æœæ”¹æˆusername userNameéƒ½ä¼šæŠ¥é”™ï¼Œå¾ˆå¥‡æ€ªï¼ï¼</p>
<ol start="2">
<li>ç¼–å†™pojoç±»ã€Mapperæ¥å£ã€Mapper.xml</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.pojo;

<span class="hljs-keyword">import</span> lombok.Data;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String pwd;
&#125;
</code></pre>

<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.mapper;

<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Param;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserMapper</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(Map&lt;String,Object&gt; map)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;userId&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectAllUsers</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;userId&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;

&#125;</code></pre>

<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--çœå»äº†ä»¥å¾€çš„UserDaoImpl çœå»äº†è¿æ¥æ•°æ®åº“çš„ä¸€äº›è¯­å¥--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.wen.mapper.UserMapper&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--å‘½åç©ºé—´ ç»‘å®šä¸€ä¸ªæŒ‡å®šçš„Mapperæ¥å£--&gt;</span>


    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span>
        insert into mybatis.user(id, name, pwd) values (#&#123;userId&#125;, #&#123;userName&#125;, #&#123;userPwd&#125;)
    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteUser&quot;</span>&gt;</span>
        delete from mybatis.user where id=#&#123;userId&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectAllUsers&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
        select * from mybatis.user
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserById&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
        select * from mybatis.user where id=$&#123;userId&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span></code></pre>

<ol start="3">
<li>å°†sqlSession beanæ³¨å…¥åˆ°Mapper beanä¸­</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.mapper;

<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> org.mybatis.spring.SqlSessionTemplate;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMapperImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserMapper</span></span>&#123;

    <span class="hljs-comment">//æˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œéƒ½ä½¿ç”¨sqlSessionæ¥æ‰§è¡Œï¼Œç°åœ¨éƒ½ä½¿ç”¨sqlSessionTemplate</span>
    <span class="hljs-keyword">private</span> SqlSessionTemplate sqlSession;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(Map&lt;String, Object&gt; map)</span> </span>&#123;
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        <span class="hljs-keyword">return</span> mapper.addUser(map);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        <span class="hljs-keyword">return</span> mapper.deleteUser(id);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectAllUsers</span><span class="hljs-params">()</span> </span>&#123;
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        <span class="hljs-keyword">return</span> mapper.selectAllUsers();
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;
        UserMapper mapper = sqlSession.getMapper(UserMapper.class);
        <span class="hljs-keyword">return</span> mapper.getUserById(id);
    &#125;
&#125;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.mapper.UserMapperImpl&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSession&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<p>å®Œæ•´çš„é…ç½®æ–‡ä»¶ï¼š</p>
<p><strong>db.properties</strong></p>
<pre><code class="hljs properties"><span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
<span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;rewriteBatchedStatements=true&amp;allowPublicKeyRetrieval=true</span>
<span class="hljs-attr">name</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">password</span>=<span class="hljs-string">645645aa</span></code></pre>

<p><strong>spring-mapper.xml</strong></p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- æŒ‡å®šspringè¯»å–db.propertiesé…ç½® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!--DataSourceåŸæ¥ä½¿ç”¨çš„æ˜¯mybatisçš„ï¼Œç°åœ¨ä½¿ç”¨Springçš„æ•°æ®æº--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;name&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-comment">&lt;!--SqlSessionFactoryBean æ¥åˆ›å»º sqlSessionFactory--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span>
        <span class="hljs-comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶ è¿™æ ·å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å†™mybatis-config.xmlçš„ç›¸å…³é…ç½® å¦‚ä¸‹é¢åŒ…çš„æ‰«æ--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapperLocations&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:com/wen/mapper/*.xml&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-comment">&lt;!--SqlSessionTemplate æ˜¯ MyBatis-Spring çš„æ ¸å¿ƒã€‚</span>
<span class="hljs-comment">    ä½œä¸º SqlSession çš„ä¸€ä¸ªå®ç°ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å®ƒæ— ç¼ä»£æ›¿ä½ ä»£ç ä¸­å·²ç»åœ¨ä½¿ç”¨çš„ SqlSessionã€‚--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--å› ä¸ºSqlSessionTemplateæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨æ„é€ å™¨è¿›è¡Œæ³¨å…¥--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<p><strong>mybatis-config.xml</strong></p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--æ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
<span class="hljs-comment">&lt;!--ä¸€èˆ¬ åˆ«å è®¾ç½® åœ¨è¿™ä¸ªæ–‡ä»¶è¿›è¡Œé…ç½®--&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre>

<p><strong>applicationContext.xml</strong></p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-mapper.xml&quot;</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.mapper.UserMapperImpl&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSession&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="5">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">import</span> com.wen.mapper.UserMapper;
<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> org.springframework.context.ApplicationContext;
<span class="hljs-keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MapperTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
        UserMapper userMapper = applicationContext.getBean(<span class="hljs-string">&quot;userMapper&quot;</span>, UserMapper.class);
        List&lt;User&gt; userList = userMapper.selectAllUsers();
        <span class="hljs-keyword">for</span> (User user : userList) &#123;
            System.out.println(user.getName());
        &#125;

    &#125;
&#125;</code></pre>

<p>æµ‹è¯•æˆåŠŸï¼</p>
<img src="/images/Spring5/image-20201123110502571.png" srcset="/img/loading.gif" alt="image-20201123110502571" style="zoom:50%;" />

<h3 id="11-3-æ•´åˆMyBatisæ–¹å¼äºŒ"><a href="#11-3-æ•´åˆMyBatisæ–¹å¼äºŒ" class="headerlink" title="11.3 æ•´åˆMyBatisæ–¹å¼äºŒ"></a>11.3 æ•´åˆMyBatisæ–¹å¼äºŒ</h3><p>é€šè¿‡SqlSessionDaoSupportå¯ä»¥çœç•¥sqlSessionåœ¨é…ç½®æ–‡ä»¶ä¸­çš„æ³¨å…¥ã€‚</p>
<p>SqlSessionDaoSupportæ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ”¯æŒç±»ï¼Œç”¨æ¥ä¸ºä½ æä¾›SqlSessionï¼Œè°ƒç”¨getSqlSession()æ–¹æ³•ä½ ä¼šå¾—åˆ°ä¸€ä¸ªSqlSessionTemplateã€‚</p>
<ol>
<li>ä¿®æ”¹UserMapperImplç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">package</span> com.wen.mapper;

<span class="hljs-keyword">import</span> com.wen.pojo.User;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> org.mybatis.spring.SqlSessionTemplate;
<span class="hljs-keyword">import</span> org.mybatis.spring.support.SqlSessionDaoSupport;

<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserMapperImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">SqlSessionDaoSupport</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">UserMapper</span></span>&#123;

    <span class="hljs-comment">//æˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œéƒ½ä½¿ç”¨sqlSessionæ¥æ‰§è¡Œï¼Œç°åœ¨éƒ½ä½¿ç”¨sqlSessionTemplate</span>
<span class="hljs-comment">//    private SqlSessionTemplate sqlSession; //è¿™ä¸ªä¸€å®šè¦æ³¨é‡Šæ‰</span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(Map&lt;String, Object&gt; map)</span> </span>&#123;
        <span class="hljs-keyword">return</span> getSqlSession().getMapper(UserMapper.class).addUser(map);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;
        <span class="hljs-keyword">return</span> getSqlSession().getMapper(UserMapper.class).deleteUser(id);
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectAllUsers</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> getSqlSession().getMapper(UserMapper.class).selectAllUsers();
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;
        <span class="hljs-keyword">return</span> getSqlSession().getMapper(UserMapper.class).getUserById(id);
    &#125;
&#125;
</code></pre>

<ol start="2">
<li>ä¿®æ”¹é…ç½®æ–‡ä»¶</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--applicationContext.xml--&gt;</span>
<span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">import</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;spring-mapper.xml&quot;</span>/&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userMapper&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.mapper.UserMapperImpl&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<img src="/images/Spring5/image-20201123125502135.png" srcset="/img/loading.gif" alt="image-20201123125502135" style="zoom:50%;" />

<p><strong>è¿™ä¸€éƒ¨åˆ†ä¸éœ€è¦äº†ï¼ï¼</strong></p>
<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MapperTest</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        ApplicationContext applicationContext = <span class="hljs-keyword">new</span> ClassPathXmlApplicationContext(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);
        UserMapper userMapper = applicationContext.getBean(<span class="hljs-string">&quot;userMapper&quot;</span>, UserMapper.class);
        List&lt;User&gt; userList = userMapper.selectAllUsers();
        <span class="hljs-keyword">for</span> (User user : userList) &#123;
            System.out.println(user.getName());
        &#125;

    &#125;
&#125;</code></pre>

<img src="/images/Spring5/image-20201123125626302.png" srcset="/img/loading.gif" alt="image-20201123125626302" style="zoom:50%;" />

<p>æµ‹è¯•æˆåŠŸï¼ï¼</p>
<h2 id="12-å£°æ˜å¼äº‹åŠ¡"><a href="#12-å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="12.å£°æ˜å¼äº‹åŠ¡"></a>12.å£°æ˜å¼äº‹åŠ¡</h2><h3 id="12-1-å›é¡¾äº‹åŠ¡"><a href="#12-1-å›é¡¾äº‹åŠ¡" class="headerlink" title="12.1 å›é¡¾äº‹åŠ¡"></a>12.1 å›é¡¾äº‹åŠ¡</h3><ul>
<li><strong>æŠŠä¸€ç»„ä¸šåŠ¡å½“ä½œä¸€ä¸ªä¸šåŠ¡æ¥åš</strong>ï¼è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚</li>
<li>äº‹åŠ¡åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œååˆ†çš„é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œä¸èƒ½é©¬è™ï¼</li>
<li>ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚</li>
</ul>
<p>äº‹åŠ¡ACIDåŸåˆ™ï¼š</p>
<ul>
<li><p>åŸå­æ€§</p>
<p>äº‹åŠ¡æ˜¯åŸå­æ€§æ“ä½œï¼Œç”±ä¸€ç³»åˆ—åŠ¨ä½œç»„æˆï¼Œäº‹åŠ¡çš„åŸå­æ€§ç¡®ä¿åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå®Œå…¨ä¸èµ·ä½œç”¨ã€‚</p>
</li>
<li><p>ä¸€è‡´æ€§</p>
<p>ä¸€æ—¦æ‰€æœ‰äº‹åŠ¡åŠ¨ä½œå®Œæˆï¼Œäº‹åŠ¡å°±è¦è¢«æäº¤ã€‚æ•°æ®å’Œèµ„æºå¤„äºä¸€ç§æ»¡è¶³ä¸šåŠ¡è§„åˆ™çš„ä¸€è‡´æ€§çŠ¶æ€ä¸­ã€‚</p>
</li>
<li><p>éš”ç¦»æ€§</p>
<p>å¯èƒ½å¤šä¸ªäº‹åŠ¡ä¼šåŒæ—¶å¤„ç†ç›¸åŒçš„æ•°æ®ï¼Œå› æ­¤æ¯ä¸ªäº‹åŠ¡éƒ½åº”è¯¥ä¸å…¶ä»–é£Ÿç‰©éš”ç¦»å¼€æ¥ï¼Œé˜²æ­¢æ•°æ®æŸåã€‚</p>
</li>
<li><p>æŒä¹…æ€§ï¼š</p>
<p>äº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œæ— è®ºç³»ç»Ÿå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Œç»“æœéƒ½ä¸ä¼šå½±å“ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œäº‹åŠ¡çš„ç»“æœè¢«å†™åˆ°å­˜å‚¨å™¨ä¸­ã€‚</p>
</li>
</ul>
<p>æˆ‘ä»¬å…ˆåšä¸€ä¸ªå®éªŒï¼š</p>
<ol>
<li>é¦–å…ˆä¿®æ”¹UserMapperImplä¸­çš„selectUsersæ–¹æ³•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title">selectAllUsers</span><span class="hljs-params">()</span> </span>&#123;
  UserMapper mapper = getSqlSession().getMapper(UserMapper.class);
  <span class="hljs-comment">//å…ˆè¿›è¡Œæ·»åŠ æ“ä½œ</span>
  mapper.addUser(<span class="hljs-keyword">new</span> User(<span class="hljs-number">6</span>, <span class="hljs-string">&quot;renwen&quot;</span>, <span class="hljs-string">&quot;645645&quot;</span>));
  <span class="hljs-comment">//åˆ é™¤æ“ä½œ</span>
  mapper.deleteUser(<span class="hljs-number">6</span>);
  <span class="hljs-comment">//æœ€åè¿›è¡Œselect</span>
  <span class="hljs-keyword">return</span> mapper.selectAllUsers();
&#125;</code></pre>

<ol start="2">
<li>å…¶ä¸­deleteæ“ä½œ sqlè¯­å¥å…¶å®æ˜¯é”™çš„ï¼</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteUser&quot;</span>&gt;</span>
  deletes from mybatis.user where id=#&#123;userId&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<p>ç»“æœï¼šaddæˆåŠŸæ‰§è¡Œï¼Œdeleteå‡ºé”™ï¼</p>
<p>æ²¡æœ‰è¿›è¡Œäº‹åŠ¡çš„ç®¡ç†ï¼›</p>
<p>æˆ‘ä»¬æƒ³è®©ä»–ä»¬éƒ½æˆåŠŸæ‰æˆåŠŸï¼Œæœ‰ä¸€ä¸ªå¤±è´¥å°±éƒ½å¤±è´¥ï¼Œæˆ‘ä»¬å°±åº”è¯¥éœ€è¦äº‹åŠ¡ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬éƒ½éœ€è¦è‡ªå·±æ‰‹åŠ¨ç®¡ç†äº‹åŠ¡ï¼Œååˆ†éº»çƒ¦ï¼ä½†æ˜¯Springç»™æˆ‘ä»¬æä¾›äº†äº‹åŠ¡ç®¡ç†ï¼Œæˆ‘ä»¬åªéœ€è¦é…ç½®å³å¯ï¼</p>
<h3 id="12-2-Springä¸­çš„äº‹åŠ¡ç®¡ç†"><a href="#12-2-Springä¸­çš„äº‹åŠ¡ç®¡ç†" class="headerlink" title="12.2 Springä¸­çš„äº‹åŠ¡ç®¡ç†"></a>12.2 Springä¸­çš„äº‹åŠ¡ç®¡ç†</h3><ul>
<li>å£°æ˜å¼äº‹åŠ¡ï¼šAOP</li>
<li>ç¼–ç¨‹å¼äº‹åŠ¡ï¼šéœ€è¦ä»£ç ç¼–å†™ï¼ˆä¸å¤ªå®ç”¨~ï¼‰</li>
</ul>
<ol>
<li>é…ç½®å£°æ˜å¼äº‹åŠ¡</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®å£°æ˜å¼äº‹åŠ¡--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></code></pre>

<ol start="2">
<li>é…ç½®å¥½äº‹åŠ¡ç®¡ç†å™¨åï¼Œæˆ‘ä»¬éœ€è¦å»é…ç½®äº‹åŠ¡çš„é€šçŸ¥</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ç»“åˆAOPå®ç°äº‹åŠ¡çš„ç»‡å…¥--&gt;</span>
<span class="hljs-comment">&lt;!--é…ç½®äº‹åŠ¡çš„ç±» é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;transactionManager&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--ç»™å“ªäº›æ–¹æ³•é…ç½®äº‹åŠ¡--&gt;</span>
  <span class="hljs-comment">&lt;!--é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;deleteUser&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;selectAllUsers&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;getUserById&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span></code></pre>

<ol start="3">
<li>é…ç½®AOPç»‡å…¥äº‹åŠ¡</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--é…ç½®AOPç»‡å…¥äº‹åŠ¡--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txPointCut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.wen.mapper.*.*(..))&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;txPointCut&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span></code></pre>

<p>å®Œæ•´çš„xmlï¼š</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:context</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/context&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:tx</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/tx&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xmlns:aop</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/aop&quot;</span></span>
<span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/context</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/context/spring-context.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/tx</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/tx/spring-tx.xsd</span></span>
<span class="hljs-tag"><span class="hljs-string">        http://www.springframework.org/schema/aop</span></span>
<span class="hljs-tag"><span class="hljs-string">        https://www.springframework.org/schema/aop/spring-aop.xsd&quot;</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- æŒ‡å®šspringè¯»å–db.propertiesé…ç½® --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">context:property-placeholder</span> <span class="hljs-attr">location</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span>

    <span class="hljs-comment">&lt;!--DataSourceåŸæ¥ä½¿ç”¨çš„æ˜¯mybatisçš„ï¼Œç°åœ¨ä½¿ç”¨Springçš„æ•°æ®æºjdbc--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driverClassName&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;name&#125;&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>


    <span class="hljs-comment">&lt;!--SqlSessionFactoryBean æ¥åˆ›å»º sqlSessionFactory--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--æ³¨å…¥æ•°æ®æºä½ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span>
        <span class="hljs-comment">&lt;!--ç»‘å®šmybatisé…ç½®æ–‡ä»¶ è¿™æ ·å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å†™mybatis-config.xmlçš„ç›¸å…³é…ç½® å¦‚ä¸‹é¢åŒ…çš„æ‰«æ--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;configLocation&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:mybatis-config.xml&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;mapperLocations&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;classpath:com/wen/mapper/*.xml&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>
    <span class="hljs-comment">&lt;!--SqlSessionTemplate æ˜¯ MyBatis-Spring çš„æ ¸å¿ƒã€‚</span>
<span class="hljs-comment">    ä½œä¸º SqlSession çš„ä¸€ä¸ªå®ç°ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨å®ƒæ— ç¼ä»£æ›¿ä½ ä»£ç ä¸­å·²ç»åœ¨ä½¿ç”¨çš„ SqlSessionã€‚--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;sqlSession&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.mybatis.spring.SqlSessionTemplate&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--å› ä¸ºSqlSessionTemplateæ²¡æœ‰setæ–¹æ³•ï¼Œåªèƒ½ä½¿ç”¨æ„é€ å™¨è¿›è¡Œæ³¨å…¥--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;sqlSessionFactory&quot;</span> <span class="hljs-attr">index</span>=<span class="hljs-string">&quot;0&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!--é…ç½®å£°æ˜å¼äº‹åŠ¡--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;transactionManager&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dataSource&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;dataSource&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span>

    <span class="hljs-comment">&lt;!--ç»“åˆAOPå®ç°äº‹åŠ¡çš„ç»‡å…¥--&gt;</span>
    <span class="hljs-comment">&lt;!--é…ç½®äº‹åŠ¡çš„ç±» é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">tx:advice</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">transaction-manager</span>=<span class="hljs-string">&quot;transactionManager&quot;</span>&gt;</span>
        <span class="hljs-comment">&lt;!--ç»™å“ªäº›æ–¹æ³•é…ç½®äº‹åŠ¡--&gt;</span>
        <span class="hljs-comment">&lt;!--é…ç½®äº‹åŠ¡çš„ä¼ æ’­ç‰¹æ€§--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tx:attributes</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;addUser&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;deleteUser&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;selectAllUsers&quot;</span> <span class="hljs-attr">read-only</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tx:method</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;getUserById&quot;</span> <span class="hljs-attr">propagation</span>=<span class="hljs-string">&quot;REQUIRED&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">tx:attributes</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tx:advice</span>&gt;</span>
    <span class="hljs-comment">&lt;!--é…ç½®AOPç»‡å…¥äº‹åŠ¡--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">aop:config</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:pointcut</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;txPointCut&quot;</span> <span class="hljs-attr">expression</span>=<span class="hljs-string">&quot;execution(* com.wen.mapper.*.*(..))&quot;</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aop:advisor</span> <span class="hljs-attr">advice-ref</span>=<span class="hljs-string">&quot;txAdvice&quot;</span> <span class="hljs-attr">pointcut-ref</span>=<span class="hljs-string">&quot;txPointCut&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aop:config</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></code></pre>

<ol start="5">
<li>ä»ç„¶deleteè¯­å¥å†™é”™ï¼Œè¿›è¡Œæµ‹è¯•ï¼</li>
</ol>
<p>ç»“æœï¼šç›´æ¥æŠ¥é”™ï¼Œæ·»åŠ æ“ä½œä¹Ÿæ²¡æœ‰æˆåŠŸï¼</p>
<p><strong>æ€è€ƒï¼š</strong></p>
<p>ä¸ºä»€ä¹ˆéœ€è¦äº‹åŠ¡ï¼Ÿ</p>
<ol>
<li>å¦‚æœä¸é…ç½®äº‹åŠ¡ï¼Œå¯èƒ½å­˜åœ¨æ•°æ®æäº¤ä¸ä¸€è‡´çš„æƒ…å†µï¼›</li>
<li>å¦‚æœæˆ‘ä»¬ä¸åœ¨Springä¸­å»é…ç½®å£°æ˜å¼äº‹åŠ¡ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨ä»£ç ä¸­æ‰‹åŠ¨é…ç½®äº‹åŠ¡ï¼</li>
<li>äº‹åŠ¡åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­éå¸¸é‡è¦ï¼Œæ¶‰åŠåˆ°æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œä¸å®¹é©¬è™ï¼</li>
</ol>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/11/28/%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">æ­å»ºHexoåšå®¢</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/11/27/MyBatis/">
                        <span class="hidden-mobile">MyBatis</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>


  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?7d2fd3d56f2287a0bda354d214258de6";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
