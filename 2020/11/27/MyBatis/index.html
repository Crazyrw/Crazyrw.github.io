

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="æ¢¦æƒ³å¾ˆçè´µï¼ŒåŠªåŠ›ç‰¹åˆ«é…·ã€‚-xback">
  <meta name="author" content="Crazyrw">
  <meta name="keywords" content="">
  <title>MyBatis - Crazyrw&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.1.2/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"copy_btn":true,"image_zoom":{"enable":true},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":true,"baidu":"7d2fd3d56f2287a0bda354d214258de6","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Crazyrw's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/images/bg/post.webp') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="MyBatis">
              
            </span>

            <p class="h2"><a id="rainbow" href=''>ğŸŒˆ è·å–ä¸­...</a></p>
            <script>
              fetch('https://api.eatrice.top')
                .then(response => response.json())
                .then(data => {
                  var rainbow = document.getElementById('rainbow');
                  rainbow.innerHTML = data.Content;
                  rainbow.href = "https://rainbow.eatrice.top/?ID=" + data.ID;
                })
                .catch(console.error)
              </script>


            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-11-27 19:25" pubdate>
        November 27, 2020 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      12.5k å­—
    </span>
  

  

  
  
    
      <!-- ä¸è’œå­ç»Ÿè®¡æ–‡ç« PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> æ¬¡
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">MyBatis</h1>
            
              <p class="note note-info">
                
                  æœ¬æ–‡æœ€åæ›´æ–°äºï¼š17 hours ago
                
              </p>
            
            <div class="markdown-body">
              <p>ç¯å¢ƒï¼š</p>
<ul>
<li>JDK 1.8</li>
<li>MySQL 8.0</li>
<li>maven  3.6.1</li>
<li>IDEA</li>
</ul>
<p>å›é¡¾ï¼š</p>
<ul>
<li>JDBC</li>
<li>MySQL</li>
<li>Java åŸºç¡€</li>
<li>Maven</li>
<li>Junit  å•å…ƒæµ‹è¯•</li>
</ul>
<p>æ¡†æ¶ï¼šé…ç½®æ–‡ä»¶çš„ï¼Œæœ€å¥½çš„æ–¹å¼ï¼šçœ‹å®˜ç½‘æ–‡æ¡£</p>
<ul>
<li>SSM  Mybatis: <a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a></li>
</ul>
<p>è¡¥å……ä»¥ä¸‹ï¼šIDEAå¿«æ·é”®è¡¥å……è¿”å›å€¼å’Œè¿”å›ç±»å‹ï¼šctrl+alt+v</p>
<h2 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a><strong>1. ç®€ä»‹</strong></h2><h3 id="1-1-ä»€ä¹ˆæ˜¯Mybatis"><a href="#1-1-ä»€ä¹ˆæ˜¯Mybatis" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯Mybatis"></a><strong>1.1 ä»€ä¹ˆæ˜¯Mybatis</strong></h3><p><img src="/images/MyBatis/clipboard.png" srcset="/img/loading.gif" alt="clipboard"></p>
<p>MyBatis æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„<strong>æŒä¹…å±‚æ¡†æ¶</strong>ï¼Œå®ƒæ”¯æŒè‡ªå®šä¹‰ SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„ã€‚MyBatis å…é™¤äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç ä»¥åŠè®¾ç½®å‚æ•°å’Œè·å–ç»“æœé›†çš„å·¥ä½œã€‚MyBatis å¯ä»¥é€šè¿‡ç®€å•çš„ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸå§‹ç±»å‹ã€æ¥å£å’Œ Java POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šè€å¼ Java å¯¹è±¡ï¼‰ä¸ºæ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p>
<p>MyBatis æœ¬æ˜¯apacheçš„ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/3406069">å¼€æºé¡¹ç›®</a>iBatis, 2010å¹´è¿™ä¸ª<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%A1%B9%E7%9B%AE/477803">é¡¹ç›®</a>ç”±apache software foundation è¿ç§»åˆ°äº†[google code](<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/google">https://baike.baidu.com/item/google</a> code/2346604)ï¼Œå¹¶ä¸”æ”¹åä¸ºMyBatis ã€‚2013å¹´11æœˆè¿ç§»åˆ°<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Github/10145341">Github</a>ã€‚</p>
<p>iBATISä¸€è¯æ¥æºäºâ€œinternetâ€å’Œâ€œabatisâ€çš„ç»„åˆï¼Œæ˜¯ä¸€ä¸ªåŸºäºJavaçš„<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8C%81%E4%B9%85%E5%B1%82/3584971">æŒä¹…å±‚</a>æ¡†æ¶ã€‚iBATISæä¾›çš„æŒä¹…å±‚æ¡†æ¶åŒ…æ‹¬SQL Mapså’ŒData Access Objectsï¼ˆDAOsï¼‰</p>
<p>å½“å‰ï¼Œæœ€æ–°ç‰ˆæœ¬æ˜¯MyBatis 3.5.6ã€‚</p>
<p><strong>å¦‚ä½•è·å¾—Mybatis?</strong></p>
<ul>
<li>Github ï¼šä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/mybatis/mybatis-3/releases/tag/mybatis-3.5.6">https://github.com/mybatis/mybatis-3/releases/tag/mybatis-3.5.6</a></li>
<li>ä¸­æ–‡æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/index.html">https://mybatis.org/mybatis-3/zh/index.html</a></li>
<li>Mavenä»“åº“</li>
</ul>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/org.mybatis/mybatis --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>

<h3 id="1-2-æŒä¹…åŒ–"><a href="#1-2-æŒä¹…åŒ–" class="headerlink" title="1.2 æŒä¹…åŒ–"></a><strong>1.2 æŒä¹…åŒ–</strong></h3><p>æ•°æ®æŒä¹…åŒ–</p>
<ul>
<li>æŒä¹…åŒ–å°±æ˜¯å°†ç¨‹åºçš„æ•°æ®åœ¨æŒä¹…çŠ¶æ€å’Œç¬æ—¶çŠ¶æ€è½¬åŒ–çš„è¿‡ç¨‹.</li>
<li>å†…å­˜:<strong>æ–­ç”µå³å¤±</strong></li>
<li>æ•°æ®åº“(jdbc),  ioæ–‡ä»¶æŒä¹…åŒ–</li>
<li>ç”Ÿæ´»:å†·è—, ç½å¤´</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦æŒä¹…åŒ–?</strong></p>
<ul>
<li>æœ‰ä¸€äº›å¯¹è±¡ä¸èƒ½ä¸¢å¤±</li>
<li>å†…å­˜ä»·æ ¼é«˜</li>
</ul>
<h3 id="1-3-æŒä¹…å±‚"><a href="#1-3-æŒä¹…å±‚" class="headerlink" title="1.3 æŒä¹…å±‚"></a><strong>1.3 æŒä¹…å±‚</strong></h3><p>Daoå±‚  Serviceå±‚ Controllerå±‚</p>
<ul>
<li>å®ŒæˆæŒä¹…åŒ–å·¥ä½œçš„ä»£ç å—</li>
<li>å±‚ç•Œé™ååˆ†æ˜æ˜¾</li>
</ul>
<h3 id="1-4-ä¸ºä»€ä¹ˆéœ€è¦Mybatis"><a href="#1-4-ä¸ºä»€ä¹ˆéœ€è¦Mybatis" class="headerlink" title="1.4 ä¸ºä»€ä¹ˆéœ€è¦Mybatis?"></a><strong>1.4 ä¸ºä»€ä¹ˆéœ€è¦Mybatis?</strong></h3><ul>
<li>å¸®åŠ©ç¨‹åºå‘˜å°†æ•°æ®å­˜å…¥åˆ°æ•°æ®åº“ä¸­ã€‚</li>
<li>æ–¹ä¾¿</li>
<li>ä¼ ç»Ÿçš„JDBCè¿‡äºå¤æ‚ã€‚ç®€åŒ–ã€‚æ¡†æ¶ã€‚è‡ªåŠ¨åŒ–ã€‚</li>
<li>ä¸ç”¨MyBatisä¹Ÿå¯ä»¥ã€‚æ›´å®¹æ˜“ä¸Šæ‰‹ã€‚<strong>æŠ€æœ¯æ²¡æœ‰é«˜ä½ä¹‹åˆ†ï¼Œåªæœ‰ä½¿ç”¨çš„äºº</strong></li>
<li>æœ¬èº«å°å·§ï¼Œæ²¡æœ‰ç¬¬ä¸‰æ–¹ä¾èµ–ã€‚</li>
<li>çµæ´»ï¼šsqlå†™åœ¨xmlä¸­</li>
<li>æ¥è§¦sqlä¸ç¨‹åºä»£ç çš„è€¦åˆï¼šé€šè¿‡æä¾›DAOå±‚ï¼Œå°†ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®è®¿é—®é€»è¾‘åˆ†ç¦»ï¼Œä½¿ç³»ç»Ÿçš„è®¾è®¡æ›´åŠ æ¸…æ™°ï¼Œæ›´æ˜“ç»´æŠ¤ï¼Œæ›´æ˜“å•å…ƒæµ‹è¯•ã€‚<strong>sqlå’Œä»£ç çš„åˆ†ç¦»ï¼Œæé«˜äº†å¯ç»´æŠ¤æ€§ã€‚</strong></li>
<li>æä¾›æ˜ å°„æ ‡ç­¾ï¼Œæ”¯æŒå¯¹è±¡ä¸æ•°æ®åº“çš„ormå­—æ®µå…³ç³»æ˜ å°„</li>
<li>æä¾›å¯¹è±¡å…³ç³»æ˜ å°„æ ‡ç­¾ï¼Œæ”¯æŒå¯¹è±¡å…³ç³»ç»„å»ºç»´æŠ¤</li>
<li>æä¾›xmlæ ‡ç­¾ï¼Œæ”¯æŒç¼–å†™åŠ¨æ€sqlã€‚</li>
</ul>
<p><strong>æœ€é‡è¦çš„ä¸€ç‚¹ï¼šä½¿ç”¨çš„äººå¾ˆå¤šï¼</strong></p>
<h2 id="2-ç¬¬ä¸€ä¸ªMyBatisç¨‹åº"><a href="#2-ç¬¬ä¸€ä¸ªMyBatisç¨‹åº" class="headerlink" title="2. ç¬¬ä¸€ä¸ªMyBatisç¨‹åº"></a>2. ç¬¬ä¸€ä¸ªMyBatisç¨‹åº</h2><p>æ€è·¯ï¼šæ­å»ºç¯å¢ƒ-&gt;å¯¼å…¥Mybatis-&gt;ç¼–å†™ä»£ç -&gt;æµ‹è¯•ï¼</p>
<p>MyBatisUtilså®ä½“ç±»-&gt;mybatis-config.xml-&gt;Userå®ä½“ç±»-&gt;UserMapperæ¥å£-&gt;UserMapper.xml-&gt;UserMapperTestæµ‹è¯•ç±»</p>
<p><strong>å‰ä¸¤ä¸ªæ–‡ä»¶ä¸€èˆ¬ä¸éœ€è¦ä¿®æ”¹ï¼Œç›´æ¥ä½¿ç”¨ï¼</strong></p>
<h3 id="2-1-æ­å»ºç¯å¢ƒ"><a href="#2-1-æ­å»ºç¯å¢ƒ" class="headerlink" title="2.1 æ­å»ºç¯å¢ƒ"></a>2.1 æ­å»ºç¯å¢ƒ</h3><img src="/images/MyBatis/image-20201112093037981.png" srcset="/img/loading.gif" alt="image-20201112093037981" style="zoom:50%;" />

<p>æ–°å»ºé¡¹ç›®</p>
<ol>
<li>æ–°å»ºä¸€ä¸ªæ™®é€šçš„mavené¡¹ç›®</li>
<li>åˆ é™¤srcç›®å½•ï¼Œå˜æˆçˆ¶å·¥ç¨‹</li>
<li>å¯¼å…¥ä¾èµ–  è‡³å°‘ä¸¤ä¸ªï¼šmybatis  mysqlé©±åŠ¨ junit</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
<span class="hljs-comment">&lt;!--mybatis--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!--mysqlé©±åŠ¨--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.15<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!--junit--&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span></code></pre>

<h3 id="2-2-åˆ›å»ºä¸€ä¸ªæ¨¡å—"><a href="#2-2-åˆ›å»ºä¸€ä¸ªæ¨¡å—" class="headerlink" title="2.2 åˆ›å»ºä¸€ä¸ªæ¨¡å—"></a>2.2 åˆ›å»ºä¸€ä¸ªæ¨¡å—</h3><img src="/images/MyBatis/image-20201112094756244.png" srcset="/img/loading.gif" alt="image-20201112094756244" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112094817132.png" srcset="/img/loading.gif" alt="image-20201112094817132" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112095020393.png" srcset="/img/loading.gif" alt="image-20201112095020393" style="zoom:50%;" />

<p>è¿™æ ·å°±åŸºäºmybatisåˆ›å»ºäº†ä¸€ä¸ªå­é¡¹ç›®</p>
<img src="/images/MyBatis/image-20201112095058221.png" srcset="/img/loading.gif" alt="image-20201112095058221" style="zoom:50%;" />

<p>å¥½å¤„æ˜¯ï¼šä¸ç”¨å†é‡æ–°å¯¼å…¥ä¾èµ–åŒ…äº†</p>
<img src="/images/MyBatis/image-20201112095130914.png" srcset="/img/loading.gif" alt="image-20201112095130914" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112095146896.png" srcset="/img/loading.gif" alt="image-20201112095146896" style="zoom:50%;" />



<ul>
<li>ç¼–å†™mybatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼ˆå®˜ç½‘ä¸Šæœ‰ï¼‰</li>
</ul>
<img src="/images/MyBatis/image-20201112100703771.png" srcset="/img/loading.gif" alt="image-20201112100703771" style="zoom:50%;" />

<p>ç¼–å†™mybatis-config.xml</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">configuration</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--æ ¸å¿ƒé…ç½®æ–‡ä»¶--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>/&gt;</span><span class="hljs-comment">&lt;!--äº‹åŠ¡ç®¡ç†--&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--æ•°æ®åº“ç›¸å…³--&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf8<span class="hljs-symbol">&amp;amp;</span>useSSL=false<span class="hljs-symbol">&amp;amp;</span>serverTimezone=UTC<span class="hljs-symbol">&amp;amp;</span>rewriteBatchedStatements=true&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;root&quot;</span>/&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;645645aa&quot;</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span>
    <span class="hljs-comment">&lt;!--æ¯ä¸€ä¸ªMapper.xmléƒ½éœ€è¦åœ¨mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ--&gt;</span>
<span class="hljs-comment">&lt;!--    Type interface com.wen.dao.UserMapper id not known to the MapperRegistry.--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/wen/dao/UserMapper.xml&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span></code></pre>

<p>æ¯ä¸ªåŸºäº <strong>MyBatis</strong> çš„åº”ç”¨éƒ½æ˜¯ä»¥ä¸€ä¸ª <strong>SqlSessionFactory</strong> çš„å®ä¾‹ä¸ºæ ¸å¿ƒçš„ã€‚<strong>SqlSessionFactory</strong> çš„å®ä¾‹å¯ä»¥é€šè¿‡ <strong>SqlSessionFactoryBuilder</strong> è·å¾—ã€‚è€Œ SqlSessionFactoryBuilder åˆ™å¯ä»¥ä» XML é…ç½®æ–‡ä»¶æˆ–ä¸€ä¸ªé¢„å…ˆé…ç½®çš„ Configuration å®ä¾‹æ¥æ„å»ºå‡º SqlSessionFactory å®ä¾‹ã€‚</p>
<p>(å…¶å®å°±æ˜¯ä¸Šé¢çš„ç¼–å†™mybatis-config.xmlæ–‡ä»¶)</p>
<p>ä» XML æ–‡ä»¶ä¸­æ„å»º SqlSessionFactory çš„å®ä¾‹éå¸¸ç®€å•ï¼Œå»ºè®®ä½¿ç”¨ç±»è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚ ä½†ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»æ„çš„è¾“å…¥æµï¼ˆInputStreamï¼‰å®ä¾‹ï¼Œæ¯”å¦‚ç”¨æ–‡ä»¶è·¯å¾„å­—ç¬¦ä¸²æˆ– file:// URL æ„é€ çš„è¾“å…¥æµã€‚MyBatis åŒ…å«ä¸€ä¸ªåå« Resources çš„å·¥å…·ç±»ï¼Œå®ƒåŒ…å«ä¸€äº›å®ç”¨æ–¹æ³•ï¼Œä½¿å¾—ä»ç±»è·¯å¾„æˆ–å…¶å®ƒä½ç½®åŠ è½½èµ„æºæ–‡ä»¶æ›´åŠ å®¹æ˜“ã€‚</p>
<p><strong>å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>
<pre><code class="hljs java">String resource = <span class="hljs-string">&quot;org/mybatis/example/mybatis-config.xml&quot;</span>;
InputStream inputStream = Resources.getResourceAsStream(resource);
SqlSessionFactory sqlSessionFactory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</code></pre>

<ul>
<li>ç¼–å†™mybatiså·¥å…·ç±»</li>
</ul>
<img src="/images/MyBatis/image-20201112103239319.png" srcset="/img/loading.gif" alt="image-20201112103239319" style="zoom:50%;" />

<pre><code class="hljs java"><span class="hljs-comment">//SqlSessionFactory  SqlSession</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisUtils</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> SqlSessionFactory sqlSessionFactory;
    <span class="hljs-keyword">static</span> &#123;
        <span class="hljs-keyword">try</span> &#123;
            <span class="hljs-comment">//ä½¿ç”¨mybatisç¬¬ä¸€æ­¥:è·å–SqlSessionFactoryå¯¹è±¡</span>
            String resource = <span class="hljs-string">&quot;mybatis-config.xml&quot;</span>;
            InputStream inputStream = Resources.getResourceAsStream(resource);
            sqlSessionFactory = <span class="hljs-keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);
        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;
            e.printStackTrace();
        &#125;

    &#125;
    <span class="hljs-comment">//æ—¢ç„¶æœ‰äº† SqlSessionFactoryï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å¾— SqlSession çš„å®ä¾‹ã€‚</span>
    <span class="hljs-comment">// SqlSession æä¾›äº†åœ¨æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSqlSession</span><span class="hljs-params">()</span></span>&#123;
        SqlSession sqlSession = sqlSessionFactory.openSession();
        <span class="hljs-keyword">return</span> sqlSession;
    &#125;
&#125;</code></pre>

<h3 id="2-3-ç¼–å†™ä»£ç "><a href="#2-3-ç¼–å†™ä»£ç " class="headerlink" title="2.3 ç¼–å†™ä»£ç "></a>2.3 ç¼–å†™ä»£ç </h3><ul>
<li>å®ä½“ç±»</li>
</ul>
<img src="/images/MyBatis/image-20201112103707857.png" srcset="/img/loading.gif" alt="image-20201112103707857" style="zoom:50%;" />

<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String pwd;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">()</span> </span>&#123;
    &#125;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">User</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id, String name, String pwd)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.id = id;
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.pwd = pwd;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> id;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(<span class="hljs-keyword">int</span> id)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.id = id;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.name = name;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getPwd</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> pwd;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPwd</span><span class="hljs-params">(String pwd)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.pwd = pwd;
    &#125;
&#125;</code></pre>

<ul>
<li>Daoæ¥å£(åæœŸæ”¹æˆMapper)</li>
</ul>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserDao</span></span>&#123;
    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserList</span><span class="hljs-params">()</span></span>;
&#125;</code></pre>

<ul>
<li>æ¥å£å®ç°ç±» UserMapper.xml</li>
</ul>
<p>ç”±åŸæ¥çš„UserDapImplè½¬å˜æˆä¸€ä¸ªMapperé…ç½®æ–‡ä»¶</p>
<pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">mapper</span></span>
<span class="hljs-meta">        <span class="hljs-meta-keyword">PUBLIC</span> <span class="hljs-meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span>
<span class="hljs-meta">        <span class="hljs-meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span>
<span class="hljs-comment">&lt;!--çœå»äº†ä»¥å¾€çš„UserDaoImpl çœå»äº†è¿æ¥æ•°æ®åº“çš„ä¸€äº›è¯­å¥--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.wen.dao.UserDao&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--å‘½åç©ºé—´ ç»‘å®šä¸€ä¸ªæŒ‡å®šçš„Mapperæ¥å£--&gt;</span>
<span class="hljs-comment">&lt;!--    æŸ¥è¯¢è¯­å¥ id å¯¹åº”æ–¹æ³•åå­—--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserList&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
        select * from mybatis.user
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span></code></pre>

<p>è¯­å¥ä¸­çš„è¿”å›ç±»å‹ä¸€èˆ¬æœ‰ä¸¤ç§resultTypeå’ŒresultMapï¼Œæœ€å¸¸ç”¨çš„æ˜¯resultType</p>
<h3 id="2-4-æµ‹è¯•ï¼ˆå¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ï¼‰"><a href="#2-4-æµ‹è¯•ï¼ˆå¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ï¼‰" class="headerlink" title="2.4 æµ‹è¯•ï¼ˆå¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ï¼‰"></a>2.4 æµ‹è¯•ï¼ˆå¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ï¼‰</h3><p>æ³¨æ„ç‚¹ï¼š</p>
<p>==Type interface com.wen.dao.UserMapper id not known to the <strong>MapperRegistry</strong>.==</p>
<p><strong>MapperRegistryï¼š</strong>æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œmappers</p>
<img src="/images/MyBatis/image-20201112110245072.png" srcset="/img/loading.gif" alt="image-20201112110245072" style="zoom:50%;" />

<p>==java.io.IOException: Could not find resource org/mybatis/example/mybatis-config.xml==</p>
<img src="/images/MyBatis/image-20201112110638999.png" srcset="/img/loading.gif" alt="image-20201112110638999" style="zoom:50%;" />

<p>javaä¸‹çš„UserMapper.xmlæ²¡æœ‰ç”Ÿæ•ˆã€‚mavené»˜è®¤ä¼šå¯åŠ¨resourcesä¸‹çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œjavaä¸‹çš„xmlæ–‡ä»¶ä¸ä¼šå¯åŠ¨ç”Ÿæ•ˆã€‚</p>
<p><strong>åŸå› ï¼š</strong>ç”±äºmavençº¦å®šå¤§äºé…ç½®ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°æˆ‘ä»¬å†™çš„é…ç½®æ–‡ä»¶ï¼Œæ— æ³•è¢«å¯¼å‡ºæˆ–è€…ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆï¼š==ï¼ˆå»ºè®®åªè¦åˆ›å»ºMavené¡¹ç›®å°±å†™å…¥ï¼‰==</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--åœ¨buildä¸­é…ç½®resources, æ¥é˜²æ­¢æˆ‘ä»¬èµ„æºå¯¼å‡ºå¤±è´¥çš„é—®é¢˜--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">resources</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/java<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.yml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">resource</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">directory</span>&gt;</span>src/main/resources<span class="hljs-tag">&lt;/<span class="hljs-name">directory</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">includes</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.yml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.properties<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">include</span>&gt;</span>**/*.xml<span class="hljs-tag">&lt;/<span class="hljs-name">include</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">includes</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">filtering</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">filtering</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">resource</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">resources</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span></code></pre>

<p>æ”¾åœ¨çˆ¶å·¥ç¨‹ä¸­æœ‰å¯èƒ½ä¸ç”Ÿæ•ˆï¼Œæœ€å¥½å­å·¥ç¨‹ä¸­ä¹Ÿæ”¾ä¸€ä»½ã€‚</p>
<ul>
<li>junit</li>
</ul>
<img src="/images/MyBatis/image-20201112122154868.png" srcset="/img/loading.gif" alt="image-20201112122154868" style="zoom:50%;" />

<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDaoTest</span> </span>&#123;
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
        <span class="hljs-comment">//1. è·å–SqlSessionå¯¹è±¡</span>
        SqlSession sqlSession = MybatisUtils.getSqlSession();
        <span class="hljs-comment">//2. æ‰§è¡Œ</span>
        <span class="hljs-comment">//æ–¹å¼ä¸€ï¼šgetMapper</span>
        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
        List&lt;User&gt; userList = userMapper.getUserList();
        <span class="hljs-keyword">for</span> (User user : userList) &#123;
            System.out.println(user.getName());
        &#125;

        <span class="hljs-comment">//å…³é—­sqlSession</span>
        sqlSession.close();
    &#125;
&#125;</code></pre>



<p>å¯èƒ½ä¼šæŠ¥å¦‚ä¸‹çš„é”™è¯¯ï¼š</p>
<p>==Cause: com.sun.org.apache.xerces.internal.impl.io.MalformedByteSeque==</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span></code></pre>

<img src="/images/MyBatis/image-20201112122437880.png" srcset="/img/loading.gif" alt="image-20201112122437880" style="zoom:50%;" />

<p>æµ‹è¯•æˆåŠŸï¼š</p>
<img src="/images/MyBatis/image-20201112122642943.png" srcset="/img/loading.gif" alt="image-20201112122642943" style="zoom:50%;" />

<p><strong>å¯èƒ½é‡è§çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li>é…ç½®æ–‡ä»¶æ²¡æœ‰æ³¨å†Œ</li>
<li>ç»‘å®šæ¥å£ä¸å¯¹ï¼šå…¨é™å®šå</li>
<li>æ–¹æ³•åä¸å¯¹</li>
<li>è¿”å›ç±»å‹ä¸å¯¹</li>
<li>Mavenå¯¼å‡ºèµ„æºé—®é¢˜</li>
</ul>
<h3 id="2-5-å¯¹å‘½åç©ºé—´çš„ä¸€ç‚¹è¡¥å……"><a href="#2-5-å¯¹å‘½åç©ºé—´çš„ä¸€ç‚¹è¡¥å……" class="headerlink" title="2.5  å¯¹å‘½åç©ºé—´çš„ä¸€ç‚¹è¡¥å……"></a>2.5  <strong>å¯¹å‘½åç©ºé—´çš„ä¸€ç‚¹è¡¥å……</strong></h3><p>åœ¨ä¹‹å‰ç‰ˆæœ¬çš„ MyBatis ä¸­ï¼Œ<strong>å‘½åç©ºé—´ï¼ˆNamespacesï¼‰</strong>çš„ä½œç”¨å¹¶ä¸å¤§ï¼Œæ˜¯å¯é€‰çš„ã€‚ ä½†ç°åœ¨ï¼Œéšç€å‘½åç©ºé—´è¶Šå‘é‡è¦ï¼Œä½ å¿…é¡»æŒ‡å®šå‘½åç©ºé—´ã€‚</p>
<p>å‘½åç©ºé—´çš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯åˆ©ç”¨æ›´é•¿çš„å…¨é™å®šåæ¥å°†ä¸åŒçš„è¯­å¥éš”ç¦»å¼€æ¥ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†ä½ ä¸Šé¢è§åˆ°çš„æ¥å£ç»‘å®šã€‚å°±ç®—ä½ è§‰å¾—æš‚æ—¶ç”¨ä¸åˆ°æ¥å£ç»‘å®šï¼Œä½ ä¹Ÿåº”è¯¥éµå¾ªè¿™é‡Œçš„è§„å®šï¼Œä»¥é˜²å“ªå¤©ä½ æ”¹å˜äº†ä¸»æ„ã€‚ é•¿è¿œæ¥çœ‹ï¼Œåªè¦å°†å‘½åç©ºé—´ç½®äºåˆé€‚çš„ Java åŒ…å‘½åç©ºé—´ä¹‹ä¸­ï¼Œä½ çš„ä»£ç ä¼šå˜å¾—æ›´åŠ æ•´æ´ï¼Œä¹Ÿæœ‰åˆ©äºä½ æ›´æ–¹ä¾¿åœ°ä½¿ç”¨ MyBatisã€‚</p>
<p><strong>å‘½åè§£æï¼š</strong>ä¸ºäº†å‡å°‘è¾“å…¥é‡ï¼ŒMyBatis å¯¹æ‰€æœ‰å…·æœ‰åç§°çš„é…ç½®å…ƒç´ ï¼ˆåŒ…æ‹¬è¯­å¥ï¼Œç»“æœæ˜ å°„ï¼Œç¼“å­˜ç­‰ï¼‰ä½¿ç”¨äº†å¦‚ä¸‹çš„å‘½åè§£æè§„åˆ™ã€‚</p>
<ul>
<li>å…¨é™å®šåï¼ˆæ¯”å¦‚ â€œcom.mypackage.MyMapper.selectAllThingsï¼‰å°†è¢«ç›´æ¥ç”¨äºæŸ¥æ‰¾åŠä½¿ç”¨ã€‚</li>
<li>çŸ­åç§°ï¼ˆæ¯”å¦‚ â€œselectAllThingsâ€ï¼‰å¦‚æœå…¨å±€å”¯ä¸€ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¼•ç”¨ã€‚ å¦‚æœä¸å”¯ä¸€ï¼Œæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„ç›¸åŒåç§°ï¼ˆæ¯”å¦‚ â€œcom.foo.selectAllThingsâ€ å’Œ â€œcom.bar.selectAllThingsâ€ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨æ—¶å°±ä¼šäº§ç”Ÿâ€œçŸ­åç§°ä¸å”¯ä¸€â€çš„é”™è¯¯ï¼Œè¿™ç§æƒ…å†µä¸‹å°±å¿…é¡»ä½¿ç”¨å…¨é™å®šåã€‚</li>
</ul>
<h3 id="2-6-ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ"><a href="#2-6-ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2.6 ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ"></a>2.6 ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸ</h3><h4 id="1-SqlSessionFactoryBuilder"><a href="#1-SqlSessionFactoryBuilder" class="headerlink" title="(1) SqlSessionFactoryBuilder"></a>(1) SqlSessionFactoryBuilder</h4><p>è¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œ<u><strong>ä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†</u>ã€‚</strong> å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æœ€å¥½è¿˜æ˜¯ä¸è¦ä¸€ç›´ä¿ç•™ç€å®ƒï¼Œä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¯ä»¥è¢«é‡Šæ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚</p>
<h4 id="2-SqlSessionFactory"><a href="#2-SqlSessionFactory" class="headerlink" title="(2) SqlSessionFactory"></a>(2) SqlSessionFactory</h4><p><u><strong>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚</strong></u> ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç â€œåä¹ æƒ¯â€ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚ æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œ<u><strong>æœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</strong></u></p>
<h4 id="3-SqlSession"><a href="#3-SqlSession" class="headerlink" title="(3) SqlSession"></a>(3) SqlSession</h4><p><u>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹</u>ã€‚<u>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„</u>ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„æ‰˜ç®¡ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¡†æ¶ä¸­çš„ HttpSessionã€‚ å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œè€ƒè™‘å°† SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚ <u>æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ° HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”åï¼Œå°±å…³é—­å®ƒã€‚</u> <u>è¿™ä¸ªå…³é—­æ“ä½œå¾ˆé‡è¦ï¼Œä¸ºäº†ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­æ“ä½œï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ã€‚</u> </p>
<h2 id="3-å¢åˆ æŸ¥æ”¹çš„å®ç°ï¼ˆCRUDï¼‰"><a href="#3-å¢åˆ æŸ¥æ”¹çš„å®ç°ï¼ˆCRUDï¼‰" class="headerlink" title="3. å¢åˆ æŸ¥æ”¹çš„å®ç°ï¼ˆCRUDï¼‰"></a>3. å¢åˆ æŸ¥æ”¹çš„å®ç°ï¼ˆCRUDï¼‰</h2><p>Cï¼šCreateï¼ˆå¢åŠ ï¼‰ã€Rï¼šRetrieveï¼ˆæ£€ç´¢ï¼‰ã€Uï¼šUpdateï¼ˆæ›´æ–°ï¼‰</p>
<p>Dï¼šDeleteï¼ˆåˆ é™¤ï¼‰</p>
<p><strong>ç¼–å†™æ¥å£æ–¹æ³•-&gt;ç¼–å†™Mapperä¸­å¯¹åº”çš„sqlè¯­å¥-&gt;æµ‹è¯•</strong></p>
<h3 id="3-1-select"><a href="#3-1-select" class="headerlink" title="3.1 select"></a>3.1 select</h3><p>é€‰æ‹©ã€æŸ¥è¯¢è¯­å¥</p>
<ul>
<li>idï¼šå¯¹åº”namespaceä¸­çš„æ–¹æ³•å</li>
<li>resultTypeï¼šSqlè¯­å¥æ‰§è¡Œçš„è¿”å›å€¼</li>
<li>parameterTypeï¼šå‚æ•°ç±»å‹</li>
</ul>
<img src="/images/MyBatis/image-20201112184955494.png" srcset="/img/loading.gif" alt="image-20201112184955494" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112185023566.png" srcset="/img/loading.gif" alt="image-20201112185023566" style="zoom:50%;" />

<p><strong>ä¸‹å›¾ä¸­çš„#{id}ä¸­çš„idå¯¹åº”UserMapperä¸­getUserByIdçš„å‚æ•°id.</strong></p>
<img src="/images/MyBatis/image-20201112185250610.png" srcset="/img/loading.gif" alt="image-20201112185250610" style="zoom:50%;" />

<p><strong>ç«çº¢è‰²éƒ¨åˆ†ä¸ºå›ºå®šéƒ¨åˆ†ã€‚</strong></p>
<h3 id="3-2-insert"><a href="#3-2-insert" class="headerlink" title="3.2 insert"></a>3.2 insert</h3><p>å¢åŠ æ¥å£æ–¹æ³•ã€‚</p>
<img src="/images/MyBatis/image-20201112185642049.png" srcset="/img/loading.gif" alt="image-20201112185642049" style="zoom:50%;" />

<p>å¢åŠ xmlé…ç½®</p>
<img src="/images/MyBatis/image-20201112185702706.png" srcset="/img/loading.gif" alt="image-20201112185702706" style="zoom:50%;" />

<p>å†™æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•ï¼š</p>
<img src="/images/MyBatis/image-20201112185955187.png" srcset="/img/loading.gif" alt="image-20201112185955187" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112190006284.png" srcset="/img/loading.gif" alt="image-20201112190006284" style="zoom:50%;" />

<p>è¿è¡ŒæˆåŠŸï¼Œä½†æ•°æ®åº“ä¸­æ²¡æœ‰æˆåŠŸæ·»åŠ ï¼Ÿï¼ï¼</p>
<img src="/images/MyBatis/image-20201112190036337.png" srcset="/img/loading.gif" alt="image-20201112190036337" style="zoom:50%;" />

<p>åŸå› ï¼šå¢åˆ æ”¹æ“ä½œéœ€è¦æäº¤äº‹åŠ¡</p>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addUser</span><span class="hljs-params">()</span></span>&#123;
    SqlSession sqlSession = MybatisUtils.getSqlSession();
    UserMapper userMapper = sqlSession.getMapper(UserMapper.class);

    userMapper.addUser(<span class="hljs-keyword">new</span> User(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;zhanger&quot;</span>, <span class="hljs-string">&quot;12345&quot;</span>));
    <span class="hljs-comment">//æäº¤äº‹åŠ¡</span>
    sqlSession.commit();
  <span class="hljs-comment">//å…³é—­</span>
    sqlSession.close();

&#125;</code></pre>

<img src="/images/MyBatis/image-20201112190337525.png" srcset="/img/loading.gif" alt="image-20201112190337525" style="zoom:50%;" />

<h3 id="3-3-update"><a href="#3-3-update" class="headerlink" title="3.3 update"></a>3.3 update</h3><img src="/images/MyBatis/image-20201112190834500.png" srcset="/img/loading.gif" alt="image-20201112190834500" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112190848069.png" srcset="/img/loading.gif" alt="image-20201112190848069" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112190820745.png" srcset="/img/loading.gif" alt="image-20201112190820745" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112190912708.png" srcset="/img/loading.gif" alt="image-20201112190912708" style="zoom:50%;" />

<h3 id="3-4-delete"><a href="#3-4-delete" class="headerlink" title="3.4 delete"></a>3.4 delete</h3><img src="/images/MyBatis/image-20201112191114785.png" srcset="/img/loading.gif" alt="image-20201112191114785" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112191125191.png" srcset="/img/loading.gif" alt="image-20201112191125191" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112191136269.png" srcset="/img/loading.gif" alt="image-20201112191136269" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112191136269-1606487584119.png" srcset="/img/loading.gif" alt="image-20201112191136269" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201112191147706.png" srcset="/img/loading.gif" alt="image-20201112191147706" style="zoom:50%;" />

<h3 id="3-5-é”™è¯¯åˆ†æ"><a href="#3-5-é”™è¯¯åˆ†æ" class="headerlink" title="3.5 é”™è¯¯åˆ†æ"></a>3.5 é”™è¯¯åˆ†æ</h3><ol>
<li>æ ‡ç­¾ä¸è¦åŒ¹é…é”™è¯¯</li>
<li><img src="/images/MyBatis/image-20201112191730460.png" srcset="/img/loading.gif" alt="image-20201112191730460" style="zoom:50%;" />

</li>
</ol>
<p>å¿…é¡»ä½¿ç”¨è·¯å¾„ï¼Œè€Œnamespaceä¸­ä½¿ç”¨çš„æ˜¯åŒ…åã€‚</p>
<img src="/images/MyBatis/image-20201112191814114.png" srcset="/img/loading.gif" alt="image-20201112191814114" style="zoom:50%;" />

<ol start="3">
<li>è¯»é”™ï¼Œä»åå¾€å‰è¯»ã€‚</li>
<li>NullPointExceptionï¼Œç©ºæŒ‡é’ˆä¸€åœºï¼Œå¯èƒ½æ˜¯æ²¡æœ‰æ³¨å†Œèµ„æºã€‚</li>
<li>è¾“å‡ºçš„xmlæ–‡ä»¶ä¸­å­˜åœ¨ä¸­æ–‡ä¹±ç é—®é¢˜ï¼Œåˆ æ‰é‡è¯•å³å¯ã€‚</li>
<li>Mavenèµ„æºæ²¡æœ‰å¯¼å‡ºé—®é¢˜ï¼ˆè§2.4å¸¸è§é—®é¢˜è§£å†³æ–¹æ³•ï¼‰</li>
</ol>
<h3 id="3-6-ä¸‡èƒ½Mapï¼ˆå·¥ä½œå®è·µå‡ºçš„ï¼‰"><a href="#3-6-ä¸‡èƒ½Mapï¼ˆå·¥ä½œå®è·µå‡ºçš„ï¼‰" class="headerlink" title="3.6 ä¸‡èƒ½Mapï¼ˆå·¥ä½œå®è·µå‡ºçš„ï¼‰"></a>3.6 ä¸‡èƒ½Mapï¼ˆå·¥ä½œå®è·µå‡ºçš„ï¼‰</h3><img src="/images/MyBatis/image-20201112192754535.png" srcset="/img/loading.gif" alt="image-20201112192754535" style="zoom:50%;" />

<p>å¦‚æœæœ‰100å¤šä¸ªå­—æ®µéƒ½ä¿®æ”¹ï¼Œä¸€ä¸ªä¸€ä¸ªçš„å†™å¤ªéš¾äº†ï¼æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p><strong>æˆ‘ä»¬ä½¿ç”¨Mapä¼ é€’å‚æ•°ï¼</strong></p>
<p>å‡è®¾ï¼Œæˆ‘ä»¬çš„å®ä½“ç±»ï¼Œæˆ–è€…æ•°æ®åº“ä¸­çš„è¡¨ï¼Œå­—æ®µæˆ–è€…å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬åº”å½“è€ƒè™‘mapï¼Œmapå¯ä»¥æŸäº›å­—æ®µä¸ºç©ºï¼Œæ¯”è¾ƒçµæ´»ã€‚</p>
<pre><code class="hljs java">UserMapper:
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addUser2</span><span class="hljs-params">(Map&lt;String, Object&gt; map)</span></span>;</code></pre>

<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ä½¿ç”¨ä¸‡èƒ½çš„map--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;addUser2&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span>
  insert into user (id, name, pwd) values (#&#123;userId&#125;, #&#123;userName&#125;, #&#123;userPwd&#125;)
<span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addUse2r</span><span class="hljs-params">()</span></span>&#123;
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);

  Map&lt;String, Object&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, Object&gt;();
  map.put(<span class="hljs-string">&quot;userId&quot;</span>, <span class="hljs-number">3</span>);
  <span class="hljs-comment">//map.put(&quot;userName&quot;, &quot;likui&quot;);</span>
  map.put(<span class="hljs-string">&quot;userPwd&quot;</span>, <span class="hljs-string">&quot;2222&quot;</span>);
  userMapper.addUser2(map);
  <span class="hljs-comment">//æäº¤äº‹åŠ¡</span>
  sqlSession.commit();
  sqlSession.close();
&#125;</code></pre>

<p>æµ‹è¯•æˆåŠŸï¼</p>
<img src="/images/MyBatis/image-20201112194355751.png" srcset="/img/loading.gif" alt="image-20201112194355751" style="zoom:50%;" />

<p>mapä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å‡ºKeyå³å¯ï¼›ã€parameterType=â€mapâ€ã€‘</p>
<p>å¯¹è±¡ä¼ é€’å‚æ•°ï¼Œç›´æ¥åœ¨sqlä¸­å–å‡ºå¯¹è±¡çš„å±æ€§å³å¯ã€parameterType=â€Objectâ€ã€‘</p>
<p>åªæœ‰ä¸€ä¸ªåŸºæœ¬ç±»å‹å‚æ•°æ—¶ï¼Œå¯ä»¥ç›´æ¥åœ¨sqlä¸­å–å‡ºã€‚ã€parameterType=â€intâ€ã€‘                        ä¹Ÿå¯ä»¥ä¸å†™ã€‚</p>
<p><strong>å¤šä¸ªå‚æ•°ç”¨Map,æˆ–è€…æ³¨è§£ï¼</strong></p>
<h4 id="æ¨¡ç³ŠæŸ¥è¯¢"><a href="#æ¨¡ç³ŠæŸ¥è¯¢" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢"></a>æ¨¡ç³ŠæŸ¥è¯¢</h4><pre><code class="hljs java">UserMapper:
<span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserLike</span><span class="hljs-params">(String value)</span></span>;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserLike&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
  select * from user where name like #&#123;value&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">getUserLike</span><span class="hljs-params">()</span></span>&#123;
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);

  List&lt;User&gt; userList = userMapper.getUserLike(<span class="hljs-string">&quot;%zhang%&quot;</span>);
  <span class="hljs-keyword">for</span> (User user : userList) &#123;
    System.out.println(user.getName());
  &#125;
  sqlSession.close();

&#125;</code></pre>

<img src="/images/MyBatis/image-20201112200158647.png" srcset="/img/loading.gif" alt="image-20201112200158647" style="zoom:50%;" />

<p><strong>ç¬¬äºŒç§ç›¸æ¯”è¾ƒäºç¬¬ä¸€ç§ä¼šå­˜åœ¨SQLæ³¨å…¥çš„å±é™©ï¼</strong></p>
<p>æ¨¡ç³ŠæŸ¥è¯¢çš„ä¸¤ç§æ–¹æ³•ï¼š</p>
<ol>
<li>javaä»£ç æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼ é€’é€šé…ç¬¦% %</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserLike&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
  select * from user where name like #&#123;value&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<ol start="2">
<li>åœ¨sqlæ‹¼æ¥ä¸­ä½¿ç”¨é€šé…ç¬¦</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserLike&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span>&gt;</span>
  select * from user where name like &quot;%&quot;#&#123;value&#125;&quot;%&quot;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<h2 id="4-é…ç½®è§£æï¼ˆåœ¨è¿™ä¹‹åæ‰æ˜¯çœŸæ­£è¦æŒæ¡çš„ï¼‰"><a href="#4-é…ç½®è§£æï¼ˆåœ¨è¿™ä¹‹åæ‰æ˜¯çœŸæ­£è¦æŒæ¡çš„ï¼‰" class="headerlink" title="4. é…ç½®è§£æï¼ˆåœ¨è¿™ä¹‹åæ‰æ˜¯çœŸæ­£è¦æŒæ¡çš„ï¼‰"></a>4. é…ç½®è§£æï¼ˆåœ¨è¿™ä¹‹åæ‰æ˜¯çœŸæ­£è¦æŒæ¡çš„ï¼‰</h2><p>MyBatis çš„é…ç½®æ–‡ä»¶åŒ…å«äº†ä¼šæ·±æ·±å½±å“ MyBatis è¡Œä¸ºçš„è®¾ç½®å’Œå±æ€§ä¿¡æ¯ã€‚</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/configuration.html#mappers">https://mybatis.org/mybatis-3/zh/configuration.html#mappers</a>)</li>
</ul>
<h3 id="4-1-æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#4-1-æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="4.1 æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>4.1 æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><ul>
<li>mybatis-config.xml</li>
</ul>
<p>configurationï¼ˆé…ç½®ï¼‰</p>
<ul>
<li>propertiesï¼ˆå±æ€§ï¼‰</li>
<li>settingsï¼ˆè®¾ç½®ï¼‰</li>
<li>typeAliasesï¼ˆç±»å‹åˆ«åï¼‰</li>
<li>typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</li>
<li>objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</li>
<li>pluginsï¼ˆæ’ä»¶ï¼‰</li>
<li>environmentsï¼ˆç¯å¢ƒé…ç½®ï¼‰<ul>
<li>environmentï¼ˆç¯å¢ƒå˜é‡ï¼‰</li>
<li>transactionManagerï¼ˆäº‹åŠ¡ç®¡ç†å™¨ï¼‰</li>
<li>dataSourceï¼ˆæ•°æ®æºï¼‰</li>
</ul>
</li>
<li>databaseIdProviderï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰</li>
<li>mappersï¼ˆæ˜ å°„å™¨ï¼‰</li>
</ul>
<h3 id="4-2-ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"><a href="#4-2-ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰" class="headerlink" title="4.2 ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰"></a>4.2 ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰</h3><p>MyBatis å¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒã€‚</p>
<p><strong>ä¸è¿‡è¦è®°ä½ï¼šå°½ç®¡å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">environments</span> <span class="hljs-attr">default</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development&quot;</span>&gt;</span><span class="hljs-comment">&lt;!--MyBatisçš„é»˜è®¤ç¯å¢ƒ--&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;...&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">environment</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;development2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;JDBC&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;...&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;...&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dataSource</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;POOLED&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;driver&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;driver&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;url&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;username&#125;&quot;</span>/&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;password&#125;&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dataSource</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">environment</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">environments</span>&gt;</span></code></pre>

<p><strong>æ³¨æ„ä¸€äº›å…³é”®ç‚¹:</strong></p>
<ul>
<li>é»˜è®¤ä½¿ç”¨çš„ç¯å¢ƒ IDï¼ˆæ¯”å¦‚ï¼šdefault=â€developmentâ€ï¼‰ã€‚</li>
<li>æ¯ä¸ª environment å…ƒç´ å®šä¹‰çš„ç¯å¢ƒ IDï¼ˆæ¯”å¦‚ï¼šid=â€developmentâ€ï¼‰ã€‚</li>
<li>äº‹åŠ¡ç®¡ç†å™¨çš„é…ç½®ï¼ˆæ¯”å¦‚ï¼štype=â€JDBCâ€ï¼‰ã€‚</li>
<li>æ•°æ®æºçš„é…ç½®ï¼ˆæ¯”å¦‚ï¼štype=â€POOLEDâ€ï¼‰ã€‚</li>
</ul>
<p>é»˜è®¤ç¯å¢ƒå’Œç¯å¢ƒ ID é¡¾åæ€ä¹‰ã€‚ ç¯å¢ƒå¯ä»¥éšæ„å‘½åï¼Œä½†åŠ¡å¿…ä¿è¯é»˜è®¤çš„ç¯å¢ƒ ID è¦åŒ¹é…å…¶ä¸­ä¸€ä¸ªç¯å¢ƒ IDã€‚</p>
<p>ä»¥ä¸‹äº†è§£å³å¯ï¼</p>
<ol>
<li><strong>äº‹åŠ¡ç®¡ç†å™¨ï¼ˆtransactionManagerï¼‰</strong></li>
</ol>
<p>åœ¨ MyBatis ä¸­æœ‰ä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆä¹Ÿå°±æ˜¯ type=â€[JDBC|MANAGED]â€ï¼‰</p>
<ul>
<li><p>JDBC â€“ è¿™ä¸ªé…ç½®ç›´æ¥ä½¿ç”¨äº† JDBC çš„æäº¤å’Œå›æ»šè®¾æ–½ï¼Œå®ƒä¾èµ–ä»æ•°æ®æºè·å¾—çš„è¿æ¥æ¥ç®¡ç†äº‹åŠ¡ä½œç”¨åŸŸã€‚</p>
</li>
<li><p>MANAGED â€“ è¿™ä¸ªé…ç½®å‡ ä¹æ²¡åšä»€ä¹ˆã€‚å®ƒä»ä¸æäº¤æˆ–å›æ»šä¸€ä¸ªè¿æ¥ï¼Œè€Œæ˜¯è®©å®¹å™¨æ¥ç®¡ç†äº‹åŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ˆæ¯”å¦‚ JEE åº”ç”¨æœåŠ¡å™¨çš„ä¸Šä¸‹æ–‡ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹å®ƒä¼šå…³é—­è¿æ¥ã€‚ç„¶è€Œä¸€äº›å®¹å™¨å¹¶ä¸å¸Œæœ›è¿æ¥è¢«å…³é—­ï¼Œå› æ­¤éœ€è¦å°† closeConnection å±æ€§è®¾ç½®ä¸º false æ¥é˜»æ­¢é»˜è®¤çš„å…³é—­è¡Œä¸ºã€‚ä¾‹å¦‚:</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">transactionManager</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;MANAGED&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;closeConnection&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;false&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">transactionManager</span>&gt;</span></code></pre>

</li>
</ul>
<p><strong>æ³¨æ„ï¼šå¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Spring + MyBatisï¼Œåˆ™æ²¡æœ‰å¿…è¦é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œå› ä¸º Spring æ¨¡å—ä¼šä½¿ç”¨è‡ªå¸¦çš„ç®¡ç†å™¨æ¥è¦†ç›–å‰é¢çš„é…ç½®ã€‚</strong></p>
<ol start="2">
<li><strong>æ•°æ®æºï¼ˆdataSourceï¼‰</strong></li>
</ol>
<p>è¿æ¥æ•°æ®åº“</p>
<p>dbcp c3p0 druidï¼ˆé˜¿é‡Œçš„ï¼‰</p>
<p>æœ‰ä¸‰ç§å†…å»ºçš„æ•°æ®æºç±»å‹ï¼ˆä¹Ÿå°±æ˜¯ type=â€[UNPOOLED|POOLED|JNDI]â€ï¼‰ï¼š</p>
<ul>
<li><strong>UNPOOLED</strong>â€“ è¿™ä¸ªæ•°æ®æºçš„å®ç°ä¼šæ¯æ¬¡è¯·æ±‚æ—¶æ‰“å¼€å’Œå…³é—­è¿æ¥ã€‚</li>
<li><strong>POOLED</strong>â€“ è¿™ç§æ•°æ®æºçš„å®ç°åˆ©ç”¨â€œæ± â€çš„æ¦‚å¿µå°† JDBC è¿æ¥å¯¹è±¡ç»„ç»‡èµ·æ¥ï¼Œé¿å…äº†åˆ›å»ºæ–°çš„è¿æ¥å®ä¾‹æ—¶æ‰€å¿…éœ€çš„åˆå§‹åŒ–å’Œè®¤è¯æ—¶é—´ã€‚ è¿™ç§å¤„ç†æ–¹å¼å¾ˆæµè¡Œï¼Œèƒ½ä½¿å¹¶å‘ Web åº”ç”¨å¿«é€Ÿå“åº”è¯·æ±‚ã€‚</li>
<li><strong>JNDI</strong> â€“ è¿™ä¸ªæ•°æ®æºå®ç°æ˜¯ä¸ºäº†èƒ½åœ¨å¦‚ EJB æˆ–åº”ç”¨æœåŠ¡å™¨è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨ï¼Œå®¹å™¨å¯ä»¥é›†ä¸­æˆ–åœ¨å¤–éƒ¨é…ç½®æ•°æ®æºï¼Œç„¶åæ”¾ç½®ä¸€ä¸ª JNDI ä¸Šä¸‹æ–‡çš„æ•°æ®æºå¼•ç”¨ã€‚</li>
</ul>
<p><strong>MyBatisé»˜è®¤çš„äº‹åŠ¡ç®¡ç†å™¨æ˜¯JDBCï¼Œæ•°æ®æºï¼šPOOLED</strong></p>
<h3 id="4-3-å±æ€§ï¼ˆpropertiesï¼‰"><a href="#4-3-å±æ€§ï¼ˆpropertiesï¼‰" class="headerlink" title="4.3 å±æ€§ï¼ˆpropertiesï¼‰"></a>4.3 å±æ€§ï¼ˆpropertiesï¼‰</h3><p>å¯ä»¥é€šè¿‡å±æ€§ï¼ˆpropertiesï¼‰æ¥å®ç°å¼•ç”¨é…ç½®æ–‡ä»¶ã€‚</p>
<p>è¿™äº›å±æ€§å¯ä»¥åœ¨å¤–éƒ¨è¿›è¡Œé…ç½®ï¼Œå¹¶å¯ä»¥è¿›è¡ŒåŠ¨æ€æ›¿æ¢ã€‚ä½ æ—¢å¯ä»¥åœ¨å…¸å‹çš„ Java å±æ€§æ–‡ä»¶ä¸­é…ç½®è¿™äº›å±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨ properties å…ƒç´ çš„å­å…ƒç´ ä¸­è®¾ç½®ã€‚ã€db.propertiesã€‘</p>
<ul>
<li>ç¼–å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼šdb.properties</li>
</ul>
<pre><code class="hljs properties"><span class="hljs-attr">driver</span>=<span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
<span class="hljs-attr">url</span>=<span class="hljs-string">jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;rewriteBatchedStatements=true</span>
<span class="hljs-attr">username</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">password</span>=<span class="hljs-string">645645aa</span></code></pre>

<p>éœ€è¦æ³¨æ„ä¸€ç‚¹ï¼Œåœ¨åŸæ¥çš„è¯­å¥ä¸­å¯èƒ½ä½¿ç”¨äº†&amp;çš„è½¬ä¹‰å†™æˆäº†&amp;amp,ä½†æ˜¯å•ç‹¬å®šä¹‰æ—¶ä¸éœ€è¦ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¿›è¡Œè½¬ä¹‰ã€‚</p>
<ul>
<li>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ç« å¼•å…¥</li>
</ul>
<p><strong>åœ¨xmlæ–‡ä»¶ä¸­éƒ½å¿…é¡»è¦æ±‚é¡ºåºï¼ï¼ï¼</strong></p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>/&gt;</span></code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;db.properties&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;123&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span></code></pre>

<ol>
<li>å¯ä»¥ç›´æ¥å¼•å…¥å¤–éƒ¨æ–‡ä»¶</li>
<li>å¯ä»¥åœ¨å…¶ä¸­å¢åŠ ä¸€äº›å±æ€§é…ç½®</li>
<li>è‹¥ä¸¤ä¸ªæ–‡ä»¶ä¸­æœ‰ç›¸åŒçš„å±æ€§å­—æ®µï¼Œä¼˜å…ˆä½¿ç”¨å¤–éƒ¨å±æ€§æ–‡ä»¶çš„ï¼ï¼</li>
</ol>
<h3 id="4-4-ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"><a href="#4-4-ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰" class="headerlink" title="4.4 ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰"></a>4.4 ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰</h3><p>ç±»å‹åˆ«åå¯ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªç¼©å†™åå­—ã€‚ å®ƒä»…ç”¨äº XML é…ç½®ï¼Œæ„åœ¨é™ä½å†—ä½™çš„å…¨é™å®šç±»åä¹¦å†™ã€‚</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span>
  <span class="hljs-comment">&lt;!--ç»™å®ä½“ç±»èµ·åˆ«å--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">typeAlias</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;com.wen.pojo.User&quot;</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">&quot;User&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span></code></pre>

<p>ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatis ä¼šåœ¨åŒ…åä¸‹é¢æœç´¢éœ€è¦çš„ Java Beanï¼Œåœ¨æ²¡æœ‰æ³¨è§£çš„æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨ Bean çš„é¦–å­—æ¯å°å†™çš„éé™å®šç±»åæ¥ä½œä¸ºå®ƒçš„åˆ«åã€‚</p>
<p>æ¯”å¦‚ <code>domain.blog.Author</code> çš„åˆ«åä¸º <code>author</code>ï¼›è‹¥æœ‰æ³¨è§£ï¼Œåˆ™åˆ«åä¸ºå…¶æ³¨è§£å€¼ã€‚</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">typeAliases</span>&gt;</span>
  <span class="hljs-comment">&lt;!--æŒ‡å®šåŒ…å--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">package</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.wen.pojo&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">typeAliases</span>&gt;</span></code></pre>

<p>åœ¨å®ä½“ç±»è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼›</p>
<p>å¦‚æœå®ä½“ç±»ååˆ†å¤šï¼Œå»ºè®®ä½¿ç”¨ç¬¬äºŒç§ã€‚ç¬¬äºŒç§ä¹Ÿå¯ä½¿ç”¨æ³¨è§£ã€‚</p>
<img src="/images/MyBatis/image-20201112210050180.png" srcset="/img/loading.gif" alt="image-20201112210050180" style="zoom:50%;" />

<p>ä¸‹é¢æ˜¯ä¸€äº›ä¸ºå¸¸è§çš„ Java ç±»å‹å†…å»ºçš„ç±»å‹åˆ«åã€‚å®ƒä»¬éƒ½æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæ³¨æ„ï¼Œä¸ºäº†åº”å¯¹åŸå§‹ç±»å‹çš„å‘½åé‡å¤ï¼Œé‡‡å–äº†ç‰¹æ®Šçš„å‘½åé£æ ¼ã€‚</p>
<table>
<thead>
<tr>
<th align="left">åˆ«å</th>
<th align="left">æ˜ å°„çš„ç±»å‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left">_byte</td>
<td align="left">byte</td>
</tr>
<tr>
<td align="left">_long</td>
<td align="left">long</td>
</tr>
<tr>
<td align="left">_short</td>
<td align="left">short</td>
</tr>
<tr>
<td align="left">_int</td>
<td align="left">int</td>
</tr>
<tr>
<td align="left">_integer</td>
<td align="left">int</td>
</tr>
<tr>
<td align="left">_double</td>
<td align="left">double</td>
</tr>
<tr>
<td align="left">_float</td>
<td align="left">float</td>
</tr>
<tr>
<td align="left">_boolean</td>
<td align="left">boolean</td>
</tr>
<tr>
<td align="left">string</td>
<td align="left">String</td>
</tr>
<tr>
<td align="left">byte</td>
<td align="left">Byte</td>
</tr>
<tr>
<td align="left">long</td>
<td align="left">Long</td>
</tr>
<tr>
<td align="left">short</td>
<td align="left">Short</td>
</tr>
<tr>
<td align="left">int</td>
<td align="left">Integer</td>
</tr>
<tr>
<td align="left">integer</td>
<td align="left">Integer</td>
</tr>
<tr>
<td align="left">double</td>
<td align="left">Double</td>
</tr>
<tr>
<td align="left">float</td>
<td align="left">Float</td>
</tr>
<tr>
<td align="left">boolean</td>
<td align="left">Boolean</td>
</tr>
<tr>
<td align="left">date</td>
<td align="left">Date</td>
</tr>
<tr>
<td align="left">decimal</td>
<td align="left">BigDecimal</td>
</tr>
<tr>
<td align="left">bigdecimal</td>
<td align="left">BigDecimal</td>
</tr>
<tr>
<td align="left">object</td>
<td align="left">Object</td>
</tr>
<tr>
<td align="left">map</td>
<td align="left">Map</td>
</tr>
<tr>
<td align="left">hashmap</td>
<td align="left">HashMap</td>
</tr>
<tr>
<td align="left">list</td>
<td align="left">List</td>
</tr>
<tr>
<td align="left">arraylist</td>
<td align="left">ArrayList</td>
</tr>
<tr>
<td align="left">collection</td>
<td align="left">Collection</td>
</tr>
<tr>
<td align="left">iterator</td>
<td align="left">Iterator</td>
</tr>
</tbody></table>
<h3 id="4-4-è®¾ç½®ï¼ˆsettingsï¼‰"><a href="#4-4-è®¾ç½®ï¼ˆsettingsï¼‰" class="headerlink" title="4.4 è®¾ç½®ï¼ˆsettingsï¼‰"></a>4.4 è®¾ç½®ï¼ˆsettingsï¼‰</h3><p>è¿™æ˜¯ MyBatis ä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œå®ƒä»¬ä¼šæ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸ºã€‚</p>
<ul>
<li>mapUnderscoreToCamelCase</li>
</ul>
<p>æ˜¯å¦å¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ï¼Œå³ä»ç»å…¸æ•°æ®åº“åˆ—å A_COLUMN æ˜ å°„åˆ°ç»å…¸ Java å±æ€§å aColumnã€‚ ä¾‹å¦‚ï¼šlast_name-&gt;lastName</p>
<ul>
<li>logImpl</li>
</ul>
<p>æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾ã€‚</p>
<p> SLF4J | LOG4J | LOG4J2 | JDK_LOGGING | COMMONS_LOGGING | STDOUT_LOGGING | NO_LOGGING  æ—¥å¿—å®ç°</p>
<ul>
<li>cacheEnabled  ç¼“å­˜</li>
</ul>
<p>å…¨å±€æ€§åœ°å¼€å¯æˆ–å…³é—­æ‰€æœ‰æ˜ å°„å™¨é…ç½®æ–‡ä»¶ä¸­å·²é…ç½®çš„ä»»ä½•ç¼“å­˜ã€‚</p>
<ul>
<li><p>lazyLoadingEnabled  æ‡’åŠ è½½</p>
<p>å»¶è¿ŸåŠ è½½çš„å…¨å±€å¼€å…³ã€‚å½“å¼€å¯æ—¶ï¼Œæ‰€æœ‰å…³è”å¯¹è±¡éƒ½ä¼šå»¶è¿ŸåŠ è½½ã€‚ ç‰¹å®šå…³è”å…³ç³»ä¸­å¯é€šè¿‡è®¾ç½® <code>fetchType</code> å±æ€§æ¥è¦†ç›–è¯¥é¡¹çš„å¼€å…³çŠ¶æ€ã€‚</p>
</li>
</ul>
<h3 id="4-5-å…¶ä»–é…ç½®"><a href="#4-5-å…¶ä»–é…ç½®" class="headerlink" title="4.5 å…¶ä»–é…ç½®"></a>4.5 å…¶ä»–é…ç½®</h3><ul>
<li><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/configuration.html#typeHandlers">typeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/configuration.html#objectFactory">objectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh/configuration.html#plugins">pluginsï¼ˆæ’ä»¶ï¼‰</a><ul>
<li>MyBatis-Plus</li>
<li>MyBatis-generator-core</li>
<li>é€šç”¨mapper</li>
</ul>
</li>
</ul>
<h3 id="4-6-æ˜ å°„å™¨ï¼ˆmappersï¼‰"><a href="#4-6-æ˜ å°„å™¨ï¼ˆmappersï¼‰" class="headerlink" title="4.6 æ˜ å°„å™¨ï¼ˆmappersï¼‰"></a>4.6 æ˜ å°„å™¨ï¼ˆmappersï¼‰</h3><p>MapperRegistryæ³¨å†Œç»‘å®šæ¥å£æ–‡ä»¶ã€‚</p>
<img src="/images/MyBatis/image-20201112211421136.png" srcset="/img/loading.gif" alt="image-20201112211421136" style="zoom:50%;" />

<p>æ–¹å¼ä¸€ï¼š</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ --&gt;</span>   
<span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;com/wen/dao/UserMapper.xml&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span></code></pre>

<p>æ–¹å¼äºŒï¼šä½¿ç”¨Classæ–‡ä»¶ç»‘å®šæ³¨å†Œ</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.wen.dao.UserMapper&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span></code></pre>

<p>æ³¨æ„ï¼š</p>
<ul>
<li>æ¥å£å’ŒMapperé…ç½®æ–‡ä»¶å¿…é¡»åŒå</li>
<li>æ¥å£å’ŒMapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨ä¸€ä¸ªåŒ…ä¸‹</li>
</ul>
<p>æ–¹å¼ä¸‰ï¼šä½¿ç”¨æ‰«æåŒ…è¿›è¡Œæ³¨å…¥ç»‘å®š</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨å†Œä¸ºæ˜ å°„å™¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">mappers</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">package</span>=<span class="hljs-string">&quot;com.wen.dao&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">mappers</span>&gt;</span></code></pre>

<p>æ³¨æ„ï¼š</p>
<ul>
<li>æ¥å£å’ŒMapperé…ç½®æ–‡ä»¶å¿…é¡»åŒå</li>
<li>æ¥å£å’ŒMapperé…ç½®æ–‡ä»¶å¿…é¡»åœ¨ä¸€ä¸ªåŒ…ä¸‹</li>
</ul>
<h3 id="4-7-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"><a href="#4-7-ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ" class="headerlink" title="4.7 ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ"></a>4.7 ç”Ÿå‘½å‘¨æœŸå’Œä½œç”¨åŸŸ</h3><p>ä¸åŒä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸç±»åˆ«æ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„<strong>å¹¶å‘é—®é¢˜</strong>ã€‚</p>
<p><img src="/images/MyBatis/image-20201112220538765.png" srcset="/img/loading.gif" alt="image-20201112220538765"></p>
<p>SqlSessionFactoryBuilderï¼š</p>
<ul>
<li>ä¸€æ—¦åˆ›å»ºäº†SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚</li>
<li>å±€éƒ¨å˜é‡</li>
</ul>
<p>SqlSessionFactoryï¼š</p>
<ul>
<li>å¯ä»¥æƒ³è±¡ä¸ºï¼šæ•°æ®åº“è¿æ¥æ± </li>
<li>SqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li>SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚</li>
<li>æœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚</li>
</ul>
<p>SqlSessionï¼š</p>
<ul>
<li>æ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚</li>
<li>è¿æ¥åˆ°è¿æ¥æ± çš„ä¸€ä¸ªè¯·æ±‚ï¼</li>
<li>SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ï¼ˆæ”¾åˆ°æ–¹æ³•ä¸­ï¼‰</li>
<li>ç”¨å®Œä¹‹åéœ€è¦èµ¶ç´§å…³é—­ï¼Œå¦åˆ™èµ„æºè¢«å ç”¨</li>
</ul>
<p><img src="/images/MyBatis/image-20201112232726419.png" srcset="/img/loading.gif" alt="image-20201112232726419"></p>
<p>è¿™é‡Œçš„æ¯ä¸€ä¸ªMapperï¼Œå°±ä»£è¡¨ä¸€ä¸ªä¸šåŠ¡ã€‚</p>
<h2 id="5-è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"><a href="#5-è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜" class="headerlink" title="5. è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜"></a>5. è§£å†³å±æ€§åå’Œå­—æ®µåä¸ä¸€è‡´çš„é—®é¢˜</h2><h3 id="5-1-é—®é¢˜"><a href="#5-1-é—®é¢˜" class="headerlink" title="5.1 é—®é¢˜"></a>5.1 é—®é¢˜</h3><p>æ•°æ®åº“ä¸­çš„å­—æ®µï¼š</p>
<img src="/images/MyBatis/image-20201112233017699.png" srcset="/img/loading.gif" alt="image-20201112233017699" style="zoom:50%;" />

<p>æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæ‹·è´ä¹‹å‰çš„ï¼Œæµ‹è¯•å®ä½“ç±»å­—æ®µä¸ä¸€è‡´çš„æƒ…å†µã€‚</p>
<p>ä¿®æ”¹å­—æ®µpwd-&gt;password</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>&#123;
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
  <span class="hljs-keyword">private</span> String name;
  <span class="hljs-keyword">private</span> String password;</code></pre>

<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-comment">//1. è·å–SqlSessionå¯¹è±¡</span>
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  <span class="hljs-comment">//2. æ‰§è¡Œ</span>
  <span class="hljs-comment">//æ–¹å¼ä¸€ï¼šgetMapper</span>
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
  User user = userMapper.getUserById(<span class="hljs-number">2</span>);
  System.out.println(user.getName()+<span class="hljs-string">&quot;: &quot;</span> + user.getId() + <span class="hljs-string">&quot;: &quot;</span> + user.getPassword());
  <span class="hljs-comment">//å…³é—­sqlSession</span>
  sqlSession.close();
&#125;</code></pre>

<p>å‘ç°passwordå­—æ®µä¸ºç©ºï¼šæµ‹è¯•å‡ºç°é—®é¢˜</p>
<img src="/images/MyBatis/image-20201113071345521.png" srcset="/img/loading.gif" alt="image-20201113071345521" style="zoom:50%;" />

<pre><code class="hljs java">select * from user where id = #&#123;id&#125;
<span class="hljs-comment">//ç±»å‹å¤„ç†å™¨</span>
select id,name,pwd from user where id = #&#123;id&#125;</code></pre>

<p>è§£å†³æ–¹æ³•ï¼šæ–¹æ³•ä¸€</p>
<pre><code class="hljs java">select id,name,password from user where id = #&#123;id&#125;
<span class="hljs-comment">//èµ·åˆ«åå°±å¯</span></code></pre>

<h3 id="5-2-resultMap"><a href="#5-2-resultMap" class="headerlink" title="5.2 resultMap"></a>5.2 resultMap</h3><p>resultMapï¼šç»“æœé›†æ˜ å°„</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--ç»“æœé›†æ˜ å°„--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;UserMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--column:æ•°æ®åº“ä¸­çš„å­—æ®µï¼Œpropertyï¼šå®ä½“ç±»çš„ä¸­çš„å±æ€§--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;pwd&quot;</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;password&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserById&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;int&quot;</span>&gt;</span>
  select * from user where id = #&#123;id&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<ul>
<li><code>resultMap</code> å…ƒç´ æ˜¯ MyBatis ä¸­æœ€é‡è¦æœ€å¼ºå¤§çš„å…ƒç´ ã€‚</li>
<li>ResultMap çš„è®¾è®¡æ€æƒ³æ˜¯ï¼Œå¯¹ç®€å•çš„è¯­å¥åšåˆ°é›¶é…ç½®ï¼Œå¯¹äºå¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼Œåªéœ€è¦æè¿°è¯­å¥ä¹‹é—´çš„å…³ç³»å°±è¡Œäº†ã€‚</li>
<li><code>ResultMap</code> çš„ä¼˜ç§€ä¹‹å¤„â€”â€”ä½ å®Œå…¨å¯ä»¥ä¸ç”¨æ˜¾å¼åœ°é…ç½®å®ƒä»¬ã€‚**(åªéœ€è¦é…ç½®ä¸åŒçš„å­—æ®µå³å¯)**</li>
</ul>
<p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userResultMap&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;User&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">id</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;user_id&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;user_name&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;hashed_password&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span></code></pre>

<p>ç„¶ååœ¨å¼•ç”¨å®ƒçš„è¯­å¥ä¸­è®¾ç½® <code>resultMap</code> å±æ€§å°±è¡Œäº†ï¼ˆæ³¨æ„æˆ‘ä»¬å»æ‰äº† <code>resultType</code> å±æ€§ï¼‰ã€‚æ¯”å¦‚:</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;selectUsers&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;userResultMap&quot;</span>&gt;</span>
  select user_id, user_name, hashed_password
  from some_table
  where id = #&#123;id&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<p>å¦‚æœä¸–ç•Œå°±è¿™ä¹ˆç®€å•å°±å¥½äº†ï¼ï¼<img src="/images/MyBatis/image-20201113073217197.png" srcset="/img/loading.gif" alt="image-20201113073217197"></p>
<h2 id="6-æ—¥å¿—"><a href="#6-æ—¥å¿—" class="headerlink" title="6. æ—¥å¿—"></a>6. æ—¥å¿—</h2><h3 id="6-1-æ—¥å¿—å·¥å‚"><a href="#6-1-æ—¥å¿—å·¥å‚" class="headerlink" title="6.1 æ—¥å¿—å·¥å‚"></a>6.1 æ—¥å¿—å·¥å‚</h3><p>å¦‚æœä¸€ä¸ªæ•°æ®åº“æ“ä½œå‡ºç°å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦æ’é”™ï¼Œæ—¥å¿—å°±æ˜¯æœ€å¥½çš„åŠ©æ‰‹ã€‚</p>
<p>æ›¾ç»ï¼šsout debug</p>
<p>ç°åœ¨ï¼šæ—¥å¿—å·¥å‚</p>
<p>logImpl</p>
<p>æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç°ï¼ŒæœªæŒ‡å®šæ—¶å°†è‡ªåŠ¨æŸ¥æ‰¾ã€‚</p>
<ul>
<li> SLF4J </li>
<li>LOG4J ã€æŒæ¡ã€‘</li>
<li>LOG4J2 </li>
<li>JDK_LOGGING </li>
<li>COMMONS_LOGGING </li>
<li>STDOUT_LOGGING ã€æŒæ¡ã€‘</li>
<li>NO_LOGGING </li>
</ul>
<p>åœ¨MyBatisä¸­å…·ä½“ä½¿ç”¨å“ªä¸€ä¸ªæ—¥å¿—å®ç°ï¼Œåœ¨è®¾ç½®ä¸­è®¾å®šã€‚</p>
<p><strong>STDOUT_LOGGINGï¼šæ ‡å‡†æ—¥å¿—è¾“å‡º</strong></p>
<p>åœ¨MyBatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®æˆ‘ä»¬çš„æ—¥å¿—ï¼</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span></code></pre>

<img src="/images/MyBatis/image-20201113075212076.png" srcset="/img/loading.gif" alt="image-20201113075212076" style="zoom:50%;" />

<h3 id="6-2-LOG4J"><a href="#6-2-LOG4J" class="headerlink" title="6.2 LOG4J"></a><strong>6.2 LOG4J</strong></h3><ul>
<li>Log4jæ˜¯<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Apache/8512995">Apache</a>çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œé€šè¿‡ä½¿ç”¨Log4jï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°æ˜¯<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%8E%A7%E5%88%B6%E5%8F%B0/2438626">æ§åˆ¶å°</a>ã€æ–‡ä»¶ã€<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/GUI">GUI</a>ç»„ä»¶ã€‚</li>
<li>æˆ‘ä»¬å¯ä»¥æ§åˆ¶æ¯ä¸€æ¡æ—¥å¿—çš„è¾“å‡ºæ ¼å¼</li>
<li>é€šè¿‡å®šä¹‰æ¯ä¸€æ¡æ—¥å¿—ä¿¡æ¯çš„çº§åˆ«ï¼Œæˆ‘ä»¬èƒ½å¤Ÿæ›´åŠ ç»†è‡´åœ°æ§åˆ¶æ—¥å¿—çš„ç”Ÿæˆè¿‡ç¨‹ã€‚</li>
<li>é€šè¿‡ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/286550">é…ç½®æ–‡ä»¶</a>æ¥çµæ´»åœ°è¿›è¡Œé…ç½®ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹åº”ç”¨çš„ä»£ç ã€‚</li>
</ul>
<ol>
<li>éœ€è¦å¯¼åŒ…</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- https://mvnrepository.com/artifact/log4j/log4j --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>

<ol start="2">
<li>log4j.properties</li>
</ol>
<pre><code class="hljs properties"><span class="hljs-comment">### é…ç½®æ ¹ ç›®çš„åœ°###</span>
<span class="hljs-meta">log4j.rootLogger</span> = <span class="hljs-string">debug,console,fileAppender</span>

<span class="hljs-comment">### æ—¥å¿—è¾“å‡ºçº§åˆ« ###</span>
<span class="hljs-meta">log4j.logger.org.mybatis</span>=<span class="hljs-string">debug</span>
<span class="hljs-meta">log4j.logger.java.sql</span>=<span class="hljs-string">debug</span>
<span class="hljs-meta">log4j.logger.java.sql.Statement</span>=<span class="hljs-string">debug</span>
<span class="hljs-meta">log4j.logger.java.sql.PreparedStatement</span>=<span class="hljs-string">debug</span>
<span class="hljs-meta">log4j.logger.java.sql.ResultSet</span>=<span class="hljs-string">debug</span>
<span class="hljs-comment">### é…ç½®è¾“å‡ºåˆ°æ§åˆ¶å° ###</span>
<span class="hljs-meta">log4j.appender.console</span> = <span class="hljs-string">org.apache.log4j.ConsoleAppender</span>
<span class="hljs-meta">log4j.appender.console.Target</span> = <span class="hljs-string">System.out</span>
<span class="hljs-meta">log4j.appender.console.Threshold</span> = <span class="hljs-string">debug</span>
<span class="hljs-meta">log4j.appender.console.layout</span> = <span class="hljs-string">org.apache.log4j.PatternLayout</span>
<span class="hljs-meta">log4j.appender.console.layout.ConversionPattern</span> =  <span class="hljs-string">%d&#123;ABSOLUTE&#125; %5p %c&#123;1&#125;:%L - %m%n</span>

<span class="hljs-comment">### é…ç½®è¾“å‡ºåˆ°æ–‡ä»¶ ###</span>
<span class="hljs-meta">log4j.appender.fileAppender</span> = <span class="hljs-string">org.apache.log4j.FileAppender</span>
<span class="hljs-meta">log4j.appender.fileAppender.File</span> = <span class="hljs-string">logs/log.log</span>
<span class="hljs-meta">log4j.appender.fileAppender.Append</span> = <span class="hljs-string">true</span>
<span class="hljs-meta">log4j.appender.fileAppender.Threshold</span> = <span class="hljs-string">DEBUG</span>
<span class="hljs-meta">log4j.appender.fileAppender.layout</span> = <span class="hljs-string">org.apache.log4j.PatternLayout</span>
<span class="hljs-meta">log4j.appender.fileAppender.layout.ConversionPattern</span> = <span class="hljs-string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;[%t:%r]-[%p]%m%n</span>

<span class="hljs-comment">### é…ç½®è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œå¹¶ä¸”æ¯å¤©éƒ½åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ ###</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile</span> = <span class="hljs-string">org.apache.log4j.DailyRollingFileAppender</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile.File</span> = <span class="hljs-string">logs/log.log</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile.Append</span> = <span class="hljs-string">true</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile.Threshold</span> = <span class="hljs-string">DEBUG</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile.layout</span> = <span class="hljs-string">org.apache.log4j.PatternLayout</span>
<span class="hljs-meta">log4j.appender.dailyRollingFile.layout.ConversionPattern</span> = <span class="hljs-string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125;  [ %t:%r ] - [ %p ]  %m%n### é…ç½®è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œä¸”å¤§å°åˆ°è¾¾æŒ‡å®šå°ºå¯¸çš„æ—¶å€™äº§ç”Ÿä¸€ä¸ªæ–°çš„æ–‡ä»¶ ###log4j.appender.ROLLING_FILE=org.apache.log4j.RollingFileAppender log4j.appender.ROLLING_FILE.Threshold=ERROR log4j.appender.ROLLING_FILE.File=rolling.log log4j.appender.ROLLING_FILE.Append=true log4j.appender.ROLLING_FILE.MaxFileSize=10KB log4j.appender.ROLLING_FILE.MaxBackupIndex=1 log4j.appender.ROLLING_FILE.layout=org.apache.log4j.PatternLayout log4j.appender.ROLLING_FILE.layout.ConversionPattern=[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n</span></code></pre>

<ol start="3">
<li>é…ç½®log4jä¸ºæ—¥å¿—å®ç°</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">settings</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logImpl&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;LOG4J&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">settings</span>&gt;</span></code></pre>

<ol start="4">
<li>log4jçš„ä½¿ç”¨ï¼ç›´æ¥æµ‹è¯•è¿è¡Œåˆšæ‰çš„æŸ¥è¯¢</li>
</ol>
<img src="/images/MyBatis/image-20201113081623597.png" srcset="/img/loading.gif" alt="image-20201113081623597" style="zoom:50%;" />

<p><strong>ç®€å•ä½¿ç”¨</strong></p>
<ol>
<li>åœ¨è¦ä½¿ç”¨log4jçš„ç±»ä¸­ï¼Œå¯¼å…¥åŒ…import org.apache.log4j.Logger;</li>
<li>æ—¥å¿—å¯¹è±¡ï¼Œå‚æ•°ä¸ºå½“å‰ç±»çš„class </li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">static</span> Logger logger = Logger.getLogger(UserMapperTest.class);</code></pre>

<ol start="3">
<li>æµ‹è¯•æ–¹æ³•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testLog4j</span><span class="hljs-params">()</span></span>&#123;
  logger.info(<span class="hljs-string">&quot;info:è¿›å…¥äº†testLog4j&quot;</span>);
  logger.debug(<span class="hljs-string">&quot;debug:è¿›å…¥äº†testLog4j&quot;</span>);
  logger.error(<span class="hljs-string">&quot;error:è¿›å…¥äº†testLog4j&quot;</span>);
&#125;</code></pre>

<p>ä¹‹åå¦‚æœæƒ³æ‰“å°ä¸€äº›ä¿¡æ¯ï¼Œä¹‹å‰ä¼šç»å¸¸ç”¨System.out.println()ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ç”¨logger.info()ã€logger.error()ã€logger.debug()æ¥è¿›è¡Œè¾“å‡ºã€‚</p>
<ol start="4">
<li>æ—¥å¿—çº§åˆ«</li>
</ol>
<pre><code class="hljs java">logger.info(<span class="hljs-string">&quot;info:è¿›å…¥äº†testLog4j&quot;</span>);
logger.debug(<span class="hljs-string">&quot;debug:è¿›å…¥äº†testLog4j&quot;</span>);
logger.error(<span class="hljs-string">&quot;error:è¿›å…¥äº†testLog4j&quot;</span>);</code></pre>



<p><strong>logæ—¥å¿—æ–‡ä»¶æ‰“ä¸å¼€ï¼Ÿï¼</strong></p>
<img src="/images/MyBatis/image-20201113082531661.png" srcset="/img/loading.gif" alt="image-20201113082531661" style="zoom:50%;" />

<p>è§£å†³æ–¹æ³•ï¼š</p>
<p><strong>æ–¹æ¡ˆä¸€ï¼š</strong></p>
<p>mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ä¸è¦ä½¿ç”¨æˆ–ä¸­ä½¿ç”¨packageæ¥æŒ‡å®šè¦æ‰«æçš„åŒ…ï¼ï¼</p>
<p>åŸå› ï¼šä½¿ç”¨packageæŒ‡å®šè¦æ‰«æçš„åŒ…ï¼Œä¼šäº§ç”Ÿä¹±ç ï¼Œç”Ÿæˆçš„logæ–‡ä»¶ï¼ŒIDEAæ‰“ä¸å¼€ã€‚</p>
<img src="/images/MyBatis/image-20201113082831359.png" srcset="/img/loading.gif" alt="image-20201113082831359" style="zoom:50%;" />

<p>åˆ é™¤æ‰«æåŒ…é…ç½®ä¹‹å</p>
<img src="/images/MyBatis/image-20201113082716048.png" srcset="/img/loading.gif" alt="image-20201113082716048" style="zoom:50%;" />

<p><strong>æ–¹æ¡ˆäºŒï¼š</strong></p>
<img src="/images/MyBatis/image-20201113083027304.png" srcset="/img/loading.gif" alt="image-20201113083027304" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201113083402249.png" srcset="/img/loading.gif" alt="image-20201113083402249" style="zoom:50%;" />

<p>è¿™æ—¶å¯ä»¥æŸ¥çœ‹æ–‡ä»¶äº†ï¼ï¼ˆè™½ç„¶å­˜åœ¨ä¹±ç ï¼Œä¾ç„¶å¯ä»¥æ‰“å¼€æŸ¥çœ‹ï¼‰</p>
<img src="/images/MyBatis/image-20201113083435007.png" srcset="/img/loading.gif" alt="image-20201113083435007" style="zoom:50%;" />

<h2 id="7-åˆ†é¡µ"><a href="#7-åˆ†é¡µ" class="headerlink" title="7. åˆ†é¡µ"></a>7. åˆ†é¡µ</h2><p><strong>ä¸ºä»€ä¹ˆéœ€è¦åˆ†é¡µï¼Ÿ</strong></p>
<img src="/images/MyBatis/image-20201113084732912.png" srcset="/img/loading.gif" alt="image-20201113084732912" style="zoom: 25%;" />

<ul>
<li>å‡å°‘æ•°æ®çš„å¤„ç†é‡</li>
</ul>
<h3 id="7-1-åˆ©ç”¨Limitåˆ†é¡µ"><a href="#7-1-åˆ©ç”¨Limitåˆ†é¡µ" class="headerlink" title="7.1 åˆ©ç”¨Limitåˆ†é¡µ"></a><strong>7.1 åˆ©ç”¨Limitåˆ†é¡µ</strong></h3><p>select * from user limit 0,2;  ä»0å¼€å§‹ï¼Œåˆ†ä¸¤ä¸ª</p>
<p>select * from user limit 2ï¼›ä»0å¼€å§‹ï¼Œé•¿åº¦ä¸º2</p>
<p>ä½¿ç”¨MyBatiså®ç°åˆ†é¡µï¼Œæ ¸å¿ƒæ˜¯SQL</p>
<ol>
<li>æ¥å£</li>
</ol>
<pre><code class="hljs java">UserMapper.java
  <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserByLimit</span><span class="hljs-params">(Map&lt;String,Integer&gt; map)</span></span>;</code></pre>

<ol start="2">
<li>Mapper</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--åˆ†é¡µ--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserByLimit&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span>
  select * from user limit #&#123;startIndex&#125;,#&#123;pageSize&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testLimit</span><span class="hljs-params">()</span></span>&#123;
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);

  Map&lt;String,Integer&gt; map = <span class="hljs-keyword">new</span> HashMap&lt;String, Integer&gt;();
  map.put(<span class="hljs-string">&quot;startIndex&quot;</span>,<span class="hljs-number">0</span>);
  map.put(<span class="hljs-string">&quot;pageSize&quot;</span>,<span class="hljs-number">2</span>);

  List&lt;User&gt; userByLimit = userMapper.getUserByLimit(map);
  <span class="hljs-keyword">for</span> (User user : userByLimit) &#123;
    System.out.println(user.getName()+<span class="hljs-string">&quot;: &quot;</span> + user.getPassword());
  &#125;
  sqlSession.close();
&#125;</code></pre>

<img src="/images/MyBatis/image-20201113092408125.png" srcset="/img/loading.gif" alt="image-20201113092408125" style="zoom:50%;" />

<h3 id="7-2-RowBoundsåˆ†é¡µ"><a href="#7-2-RowBoundsåˆ†é¡µ" class="headerlink" title="7.2 RowBoundsåˆ†é¡µ"></a>7.2 RowBoundsåˆ†é¡µ</h3><p>ä¸å»ºè®®å¼€å‘ä½¿ç”¨ï¼é‚£å°±ç®€å•å†™å†™ï¼Œç§‘æ™®ä¸€ä¸‹ï¼<img src="/images/MyBatis/image-20201113092625610.png" srcset="/img/loading.gif" alt="image-20201113092625610"></p>
<p>RowBoundsï¼šä¸ä½¿ç”¨SQLå®ç°ï¼Œåœ¨Javaå±‚é¢å®ç°ï¼</p>
<ol>
<li>æ¥å£</li>
</ol>
<pre><code class="hljs java"><span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUserByRowBounds</span><span class="hljs-params">()</span></span>;</code></pre>

<ol start="2">
<li>Mapper.xml</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--    RowBounds--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getUserByRowBounds&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;UserMap&quot;</span>&gt;</span>
  select * from user
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<ol start="3">
<li>æµ‹è¯•ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testRowBounds</span><span class="hljs-params">()</span></span>&#123;
  SqlSession sqlSession = MybatisUtils.getSqlSession();

  <span class="hljs-comment">//RowBoundså®ç°</span>
  RowBounds rowBounds = <span class="hljs-keyword">new</span> RowBounds(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>);

  <span class="hljs-comment">//é€šè¿‡javaä»£ç å±‚é¢å®ç°åˆ†é¡µ</span>
  List&lt;User&gt; userList = sqlSession.selectList(<span class="hljs-string">&quot;com.wen.dao.UserMapper.getUserByRowBounds&quot;</span>,<span class="hljs-keyword">null</span>,rowBounds);
  <span class="hljs-keyword">for</span> (User user : userList) &#123;
    System.out.println(user.getName() + <span class="hljs-string">&quot;: &quot;</span> + user.getPassword());
  &#125;
  sqlSession.close();
&#125;</code></pre>

<img src="/images/MyBatis/image-20201113093633848.png" srcset="/img/loading.gif" alt="image-20201113093633848" style="zoom:50%;" />

<h3 id="7-3-åˆ†é¡µæ’ä»¶"><a href="#7-3-åˆ†é¡µæ’ä»¶" class="headerlink" title="7.3 åˆ†é¡µæ’ä»¶"></a>7.3 åˆ†é¡µæ’ä»¶</h3><img src="/images/MyBatis/image-20201113093918975.png" srcset="/img/loading.gif" alt="image-20201113093918975" style="zoom:50%;" />

<p>äº†è§£å³å¯ï¼Œä¸‡ä¸€ä¹‹åç”¨åˆ°å¯ä»¥ä½¿ç”¨ï¼<img src="/images/MyBatis/image-20201113094152149.png" srcset="/img/loading.gif" alt="image-20201113094152149"></p>
<h2 id="8-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8. ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8. ä½¿ç”¨æ³¨è§£å¼€å‘</h2><p>é™¤äº†MyBatisä¸€èˆ¬éƒ½ä¼šä½¿ç”¨æ³¨è§£å¼€å‘ï¼<img src="/images/MyBatis/image-20201113094325233.png" srcset="/img/loading.gif" alt="image-20201113094325233"></p>
<h3 id="8-1-é¢å‘æ¥å£ç¼–ç¨‹"><a href="#8-1-é¢å‘æ¥å£ç¼–ç¨‹" class="headerlink" title="8.1 é¢å‘æ¥å£ç¼–ç¨‹"></a>8.1 é¢å‘æ¥å£ç¼–ç¨‹</h3><p>æˆ‘ä»¬éƒ½å­¦è¿‡é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œä¹Ÿå­¦ä¹ è¿‡æ¥å£ï¼Œä½†æ˜¯åœ¨çœŸæ­£çš„å¼€å‘ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šé€‰æ‹©é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚</p>
<p><strong>æ ¹æœ¬åŸå› ï¼š==è§£è€¦==ã€å¯æ‰©å±•ã€æé«˜å¤ç”¨ï¼Œåˆ†å±‚å¼€å‘ä¸­ï¼Œä¸Šå±‚ä¸ç”¨ç®¡å…·ä½“çš„å®ç°ï¼Œå¤§å®¶éƒ½éµå®ˆå…±åŒçš„æ ‡å‡†ï¼Œä½¿å¾—å¼€å‘å˜å¾—å®¹æ˜“ï¼Œè§„èŒƒæ€§æ›´å¥½ã€‚</strong></p>
<p>å…³äºæ¥å£çš„ç†è§£ï¼š</p>
<ul>
<li><p>æ¥å£ä»æ›´æ·±å±‚æ¬¡çš„ç†è§£ï¼Œåº”æ˜¯å®šä¹‰ï¼ˆè§„èŒƒã€çº¦æŸï¼‰ä¸å®ç°ï¼ˆåå®åˆ†ç¦»çš„åŸåˆ™ï¼‰çš„åˆ†ç¦»</p>
</li>
<li><p>æ¥å£çš„æœ¬èº«ååº”äº†ç³»ç»Ÿäººå‘˜å¯¹ç³»ç»Ÿçš„æŠ½è±¡ç†è§£ã€‚</p>
</li>
<li><p>æ¥å£æœ‰ä¸¤ç±»</p>
<p>-ç¬¬ä¸€ç±»ï¼šå¯¹ä¸€ä¸ªä¸ªä½“çš„æŠ½è±¡ï¼Œå®ƒå¯å¯¹åº”ä¸€ä¸ªæŠ½è±¡ä½“ï¼ˆabstract classï¼‰</p>
<p>-ç¬¬äºŒç±»ï¼šå¯¹ä¸€ä¸ªä¸ªä½“æŸæ–¹é¢çš„æŠ½è±¡ï¼Œå³å½¢æˆä¸€ä¸ªæŠ½è±¡é¢ï¼ˆinterfaceï¼‰</p>
</li>
<li><p>ä¸€ä¸ªä¸ªä½“å¯èƒ½æœ‰å¤šä¸ªæŠ½è±¡é¢ã€‚æŠ½è±¡ä½“å’ŒæŠ½è±¡é¢æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p>
</li>
</ul>
<p>ä¸‰ä¸ªé¢å‘çš„åŒºåˆ«ï¼š</p>
<ul>
<li>é¢å‘å¯¹è±¡ï¼šæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥å¯¹è±¡ä¸ºå•ä½ï¼Œè€ƒè™‘å®ƒçš„å±æ€§å’Œæ–¹æ³•ã€‚</li>
<li>é¢å‘è¿‡ç¨‹ï¼šæˆ‘ä»¬è€ƒè™‘é—®é¢˜æ—¶ï¼Œä»¥ä¸€ä¸ªå…·ä½“çš„æµç¨‹ï¼ˆäº‹åŠ¡è¿‡ç¨‹ï¼‰ä¸ºå•ä½ï¼Œè€ƒè™‘å®ƒçš„å®ç°ã€‚</li>
<li>æ¥å£è®¾è®¡ä¸éæ¥å£è®¾è®¡æ˜¯é’ˆå¯¹å¤ç”¨æŠ€æœ¯è€Œè¨€çš„ï¼Œä¸é¢å‘å¯¹è±¡ï¼ˆ/è¿‡ç¨‹ï¼‰ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ›´å¤šçš„ä½“ç°æ˜¯å¯¹ç³»ç»Ÿæ•´ä½“çš„æ¶æ„ã€‚</li>
</ul>
<h3 id="8-2-ä½¿ç”¨æ³¨è§£å¼€å‘"><a href="#8-2-ä½¿ç”¨æ³¨è§£å¼€å‘" class="headerlink" title="8.2 ä½¿ç”¨æ³¨è§£å¼€å‘"></a>8.2 ä½¿ç”¨æ³¨è§£å¼€å‘</h3><ol>
<li>åœ¨æ ¸å¿ƒé…ç½®æ–‡ä»¶ç»‘å®šæ¥å£</li>
</ol>
<pre><code class="hljs java">mybatis-config.xml
&lt;!--ç»‘å®šæ¥å£--&gt;
&lt;mappers&gt;
  &lt;mapper <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">&quot;com.wen.dao.UserMapper&quot;</span>/&gt;
&lt;/mappers&gt;</code></pre>

<ol start="2">
<li>æ³¨è§£åœ¨æ¥å£ä¸Šå®ç°</li>
</ol>
<pre><code class="hljs java">UserMapper.java
  <span class="hljs-meta">@Select(&quot;select id,name,pwd as password from user&quot;)</span>
    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUsers</span><span class="hljs-params">()</span></span>;</code></pre>

<p>ä¸€æ—¦å­—æ®µæ”¹å˜ï¼Œæ³¨è§£çš„æ–¹å¼å°±æ˜¾å¾—éå¸¸çš„éº»çƒ¦ã€‚å½“sqlè¯­å¥æ›´å¤æ‚çš„æ—¶å€™ï¼Œä¹Ÿä¸å¤ªå¥½ç”¨ã€‚</p>
<p>æœ¬è´¨ï¼šåå°„æœºåˆ¶å®ç°</p>
<p>åº•å±‚ï¼šåŠ¨æ€ä»£ç†</p>
<h4 id="MyBatisè¯¦ç»†æµç¨‹"><a href="#MyBatisè¯¦ç»†æµç¨‹" class="headerlink" title="MyBatisè¯¦ç»†æµç¨‹"></a><strong>MyBatisè¯¦ç»†æµç¨‹</strong></h4><img src="/images/MyBatis/image-20201113110717482.png" srcset="/img/loading.gif" alt="image-20201113110717482" style="zoom:50%;" />

<p>Bravoï¼ï¼<img src="/images/MyBatis/image-20201113110753787.png" srcset="/img/loading.gif" alt="image-20201113110753787"></p>
<h3 id="8-3-CRUD"><a href="#8-3-CRUD" class="headerlink" title="8.3 CRUD"></a>8.3 CRUD</h3><p><strong>è‡ªåŠ¨æäº¤äº‹åŠ¡</strong></p>
<pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSqlSession</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-keyword">return</span> sqlSessionFactory.openSession(<span class="hljs-keyword">true</span>);
&#125;</code></pre>

<p>å¤šä¸ªå‚æ•°å¯ä»¥ç”¨@Param(â€œâ€)æ³¨è§£ï¼Œä½†å¿…é¡»æ˜¯åŸºæœ¬ç±»å‹ã€‚</p>
<pre><code class="hljs java"><span class="hljs-comment">//æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°å‰é¢å¿…é¡»åŠ ä¸Š@Paramæ³¨è§£</span>
    <span class="hljs-meta">@Select(&quot;select * from where id = #&#123;id&#125; and name = #&#123;name&#125;&quot;)</span>
    <span class="hljs-function">User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id, <span class="hljs-meta">@Param(&quot;name&quot;)</span> String name)</span></span>;</code></pre>

<img src="/images/MyBatis/image-20201113121441254.png" srcset="/img/loading.gif" alt="image-20201113121441254" style="zoom:50%;" />

<p><strong>idæ˜¯ä»æ³¨è§£ä¸­çš„åç§°è·å–çš„ï¼ï¼</strong></p>
<p><strong>å¢åŠ ï¼š</strong></p>
<pre><code class="hljs java"><span class="hljs-meta">@Insert(&quot;insert into user(id, name, pwd) values(#&#123;id&#125;, #&#123;name&#125;, #&#123;pwd&#125;)&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(User user)</span></span>;</code></pre>

<pre><code class="hljs java">MyBatisUtils.java:
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SqlSession <span class="hljs-title">getSqlSession</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-keyword">return</span> sqlSessionFactory.openSession(<span class="hljs-keyword">true</span>);

&#125;
<span class="hljs-comment">//true:ä»£è¡¨è‡ªåŠ¨æäº¤äº‹åŠ¡</span></code></pre>

<p><strong>æŸ¥æ‰¾ï¼š</strong></p>
<pre><code class="hljs java">UserMapper.java:
<span class="hljs-comment">//æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°å‰é¢å¿…é¡»åŠ ä¸Š@Paramæ³¨è§£</span>
<span class="hljs-meta">@Select(&quot;select * from user where id = #&#123;id&#125; and name = #&#123;name&#125;&quot;)</span>
<span class="hljs-function">User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id2, <span class="hljs-meta">@Param(&quot;name&quot;)</span> String name)</span></span>;

Test:
<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-comment">//1. è·å–SqlSessionå¯¹è±¡</span>
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  <span class="hljs-comment">//2. æ‰§è¡Œ</span>
  <span class="hljs-comment">//æ–¹å¼ä¸€ï¼šgetMapper</span>
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
  User user = userMapper.getUserById(<span class="hljs-number">5</span>,<span class="hljs-string">&quot;5555&quot;</span>);
  System.out.println(user.getName());
  <span class="hljs-comment">//å…³é—­sqlSession</span>
  sqlSession.close();
&#125;
</code></pre>

<p><strong>ä¿®æ”¹ï¼š</strong></p>
<pre><code class="hljs java">UserMapper.java:
<span class="hljs-meta">@Update(&quot;update user set name=#&#123;name&#125;,pwd=#&#123;password&#125; where id=#&#123;id&#125;&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(User user)</span></span>;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-comment">//1. è·å–SqlSessionå¯¹è±¡</span>
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  <span class="hljs-comment">//2. æ‰§è¡Œ</span>
  <span class="hljs-comment">//æ–¹å¼ä¸€ï¼šgetMapper</span>
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
  userMapper.updateUser(<span class="hljs-keyword">new</span> User(<span class="hljs-number">5</span>, <span class="hljs-string">&quot;777&quot;</span>, <span class="hljs-string">&quot;777&quot;</span>));
  <span class="hljs-comment">//å…³é—­sqlSession</span>
  sqlSession.close();
&#125;</code></pre>

<p><strong>åˆ é™¤ï¼š</strong></p>
<pre><code class="hljs java">UserMapper.java:
<span class="hljs-meta">@Delete(&quot;delete from user where id=#&#123;id&#125;&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
  <span class="hljs-comment">//1. è·å–SqlSessionå¯¹è±¡</span>
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  <span class="hljs-comment">//2. æ‰§è¡Œ</span>
  <span class="hljs-comment">//æ–¹å¼ä¸€ï¼šgetMapper</span>
  UserMapper userMapper = sqlSession.getMapper(UserMapper.class);
  userMapper.deleteUser(<span class="hljs-number">2</span>);
  <span class="hljs-comment">//å…³é—­sqlSession</span>
  sqlSession.close();
&#125;</code></pre>

<pre><code class="hljs java"><span class="hljs-meta">@Select(&quot;select id,name,pwd as password from user&quot;)</span>
<span class="hljs-function">List&lt;User&gt; <span class="hljs-title">getUsers</span><span class="hljs-params">()</span></span>;
<span class="hljs-comment">//æ–¹æ³•å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ‰€æœ‰çš„å‚æ•°å‰é¢å¿…é¡»åŠ ä¸Š@Paramæ³¨è§£</span>
<span class="hljs-meta">@Select(&quot;select * from user where id = #&#123;id&#125; and name = #&#123;name&#125;&quot;)</span>
<span class="hljs-function">User <span class="hljs-title">getUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id2, <span class="hljs-meta">@Param(&quot;name&quot;)</span> String name)</span></span>;

<span class="hljs-meta">@Insert(&quot;insert into user(id, name, pwd) values(#&#123;id&#125;, #&#123;name&#125;, #&#123;password&#125;)&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">addUser</span><span class="hljs-params">(User user)</span></span>;

<span class="hljs-meta">@Update(&quot;update user set name=#&#123;name&#125;,pwd=#&#123;password&#125; where id=#&#123;id&#125;&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">updateUser</span><span class="hljs-params">(User user)</span></span>;

<span class="hljs-meta">@Delete(&quot;delete from user where id=#&#123;id&#125;&quot;)</span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">deleteUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;</code></pre>

<p><strong>å…³äº@Param()æ³¨è§£</strong></p>
<ul>
<li>åŸºæœ¬ç±»å‹çš„å‚æ•°æˆ–è€…Stringç±»å‹ï¼Œéœ€è¦åŠ ä¸Šã€‚</li>
<li>å¼•ç”¨ç±»å‹ä¸éœ€è¦åŠ ã€‚</li>
<li>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥å¿½ç•¥ï¼Œä½†æ˜¯å»ºè®®åŠ ä¸Šã€‚</li>
<li>æˆ‘ä»¬åœ¨SQLä¸­å¼•ç”¨çš„å°±æ˜¯æˆ‘ä»¬è¿™é‡Œçš„@Param()ä¸­è®¾å®šçš„å±æ€§åã€‚</li>
</ul>
<p><strong>å…³äº${}å’Œ#{}çš„åŒºåˆ«</strong></p>
<ul>
<li>#{}èƒ½å¤Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢sqlæ³¨å…¥ï¼Œè€Œ${}æ— æ³•é˜²æ­¢sqlæ³¨å…¥ã€‚</li>
<li>èƒ½ç”¨#{}å°½é‡ä½¿ç”¨#{}</li>
</ul>
<h2 id="9-Lombok"><a href="#9-Lombok" class="headerlink" title="9. Lombok"></a>9. Lombok</h2><p>ç¬¬ä¸‰æ–¹å·¥å…·</p>
<p>Project Lombok is a java library that automatically plugs into your editor and build tools, spicing up your java.</p>
<p>Never write another getter or equals method again, with one <strong>annotation</strong> your class has a fully featured builder, Automate your logging variables, and much more.</p>
<p>Lombok æ˜¯ä¸€ç§ Javaâ„¢ å®ç”¨å·¥å…·ï¼Œå¯ç”¨æ¥å¸®åŠ©å¼€å‘äººå‘˜æ¶ˆé™¤ Java çš„å†—é•¿ï¼Œå°¤å…¶æ˜¯å¯¹äºç®€å•çš„ Java å¯¹è±¡ï¼ˆPOJOï¼‰ã€‚å®ƒé€šè¿‡æ³¨è§£å®ç°è¿™ä¸€ç›®çš„ã€‚</p>
<ol>
<li><p>åœ¨IDEAä¸­å®‰è£…Lombokæ’ä»¶</p>
</li>
<li><p>å¼•å…¥Lombokä¾èµ–</p>
<hr>
<dependency>
    <groupId>org.projectlombok</groupId>
    <artifactId>lombok</artifactId>
    <version>1.18.12</version>
    <scope>provided</scope>
</dependency>

<hr>
</li>
</ol>
<ol start="3">
<li>åœ¨å®ä½“ç±»ä¸ŠåŠ æ³¨è§£å³å¯</li>
</ol>
<p><strong>å¸¸ç”¨çš„æ³¨è§£ï¼š</strong></p>
<ul>
<li>@Getter and @Getter</li>
<li>@ToString</li>
<li>@EqualsAndHashCode</li>
<li>@AllArgsConstructor</li>
<li>@NoArgsConstructor</li>
<li>@Data</li>
<li>@Accessors</li>
</ul>
<hr>
<p>@Dataç­‰ä»·äºä¸Šé¢çš„@Setterã€@Getterã€@RequiredArgsConstructorã€@ToStringã€@EqualsAndHashCode</p>
<hr>
<img src="/images/MyBatis/image-20201113193152340.png" srcset="/img/loading.gif" alt="image-20201113193152340" style="zoom:50%;" />

<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>æé«˜å¼€å‘æ•ˆç‡</li>
<li>ä»£ç ç®€æ´</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>ä¸æ”¯æŒå¤šç§å‚æ•°æ„é€ å™¨çš„é‡è½½ã€‚</li>
<li>è™½ç„¶çœå»äº†æ‰‹åŠ¨åˆ›å»ºgetter/setteræ–¹æ³•çš„éº»çƒ¦ï¼Œä½†æ˜¯å¤§å¤§é™ä½äº†æºä»£ç çš„å¯è¯»æ€§å’Œå®Œæ•´æ€§ï¼Œé™ä½äº†é˜…è¯»æºä»£ç çš„èˆ’é€‚åº¦ã€‚</li>
</ul>
<h2 id="10-å¤æ‚æŸ¥è¯¢"><a href="#10-å¤æ‚æŸ¥è¯¢" class="headerlink" title="10. å¤æ‚æŸ¥è¯¢"></a>10. å¤æ‚æŸ¥è¯¢</h2><ul>
<li>å¤šå¯¹ä¸€ï¼šå…³è”</li>
<li>ä¸€å¯¹å¤šï¼šé›†åˆ</li>
</ul>
<h3 id="10-1-å¤šå¯¹ä¸€å¤„ç†"><a href="#10-1-å¤šå¯¹ä¸€å¤„ç†" class="headerlink" title="10.1 å¤šå¯¹ä¸€å¤„ç†"></a>10.1 å¤šå¯¹ä¸€å¤„ç†</h3><img src="/images/MyBatis/image-20201113201018723.png" srcset="/img/loading.gif" alt="image-20201113201018723" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201113201147828.png" srcset="/img/loading.gif" alt="image-20201113201147828" style="zoom:50%;" />

<p><img src="/images/MyBatis/image-20201113201222165.png" srcset="/img/loading.gif" alt="image-20201113201222165"></p>
<p>æ³¨æ„ï¼š</p>
<p>åˆ›å»ºç›¸åŒçš„ç›®å½•ç»“æ„</p>
<img src="/images/MyBatis/image-20201113203832658.png" srcset="/img/loading.gif" alt="image-20201113203832658" style="zoom:50%;" />

<p>javaç›®å½•ä¸‹ï¼šä½¿ç”¨com.wen.daoåˆ›å»ºï¼Œè€Œresourcesä¸‹ä½¿ç”¨com/wen/daoåˆ›å»ºã€‚</p>
<img src="/images/MyBatis/image-20201113203920130.png" srcset="/img/loading.gif" alt="image-20201113203920130" style="zoom:50%;" />

<p>åˆ›å»ºæµ‹è¯•ç¯å¢ƒï¼š</p>
<ul>
<li>æ ¸å¿ƒé…ç½®æ–‡ä»¶mybatis-config.xmlå’ŒMyBatisUtilså·¥å…·ç±»</li>
<li>åˆ›å»ºè¡¨ student teacher</li>
<li>åˆ›å»ºå®ä½“ç±» Student Teacher</li>
<li><strong>ç¼–å†™Daoã€Mapper</strong>  åµŒå¥—å¤„ç†</li>
</ul>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StudentMapper</span> </span>&#123;
    <span class="hljs-comment">//æŸ¥è¯¢æ‰€æœ‰çš„å­¦ç”Ÿï¼Œä»¥åŠè€å¸ˆçš„ä¿¡æ¯ï¼ˆæ¶‰åŠå¤šè¡¨æŸ¥è¯¢ï¼‰</span>
    <span class="hljs-function">List&lt;Student&gt; <span class="hljs-title">getStudents</span><span class="hljs-params">()</span></span>;
    <span class="hljs-function">Student <span class="hljs-title">getStudentById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;sid&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;
&#125;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudents&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;Student_Teacher&quot;</span>&gt;</span>
  select * from student
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Student_Teacher&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">            å¤æ‚çš„å±æ€§:æˆ‘ä»¬éœ€è¦å•ç‹¬å¤„ç†</span>
<span class="hljs-comment">            association ï¼š å¯¹è±¡</span>
<span class="hljs-comment">            collection ï¼š é›†åˆ</span>
<span class="hljs-comment">        --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;Teacher&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;getTeacher&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Teacher&quot;</span>&gt;</span>
  select * from teacher where id = #&#123;id&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-comment">&lt;!--ä¸Šé¢çš„è¯­å¥æ”¹æˆid=#&#123;tid&#125;ä¹Ÿä¸€æ ·ï¼Œå¥½åƒä¸å½±å“ä¼ å€¼--&gt;</span></code></pre>

<ul>
<li>æµ‹è¯•</li>
</ul>
<img src="/images/MyBatis/image-20201113210441811.png" srcset="/img/loading.gif" alt="image-20201113210441811" style="zoom:50%;" />

<h4 id="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"><a href="#æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†" class="headerlink" title="æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†"></a>æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†</h4><p>ç±»ä¼¼ï¼šå­æŸ¥è¯¢</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudents&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;Student_Teacher&quot;</span>&gt;</span>
  select * from student
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Student_Teacher&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span>
  <span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">            å¤æ‚çš„å±æ€§:æˆ‘ä»¬éœ€è¦å•ç‹¬å¤„ç†</span>
<span class="hljs-comment">            association ï¼š å¯¹è±¡</span>
<span class="hljs-comment">            collection ï¼š é›†åˆ</span>
<span class="hljs-comment">        --&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;Teacher&quot;</span> <span class="hljs-attr">select</span>=<span class="hljs-string">&quot;getTeacher&quot;</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;Teacher&quot;</span>&gt;</span>
  select * from teacher where id = #&#123;id&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-comment">&lt;!--ä¸Šé¢çš„è¯­å¥æ”¹æˆid=#&#123;tid&#125;ä¹Ÿä¸€æ ·ï¼Œå¥½åƒä¸å½±å“ä¼ å€¼--&gt;</span></code></pre>

<img src="/images/MyBatis/image-20201113212309019.png" srcset="/img/loading.gif" alt="image-20201113212309019" style="zoom:50%;" />

<p><strong>ä¸‹é¢çš„è™½ç„¶å¯ä»¥æ›¿æ¢æˆåˆ«çš„ï¼Œä½†æ˜¯æœ€å¥½å’Œä¸Šé¢çš„ä¿æŒä¸€è‡´ï¼ï¼<img src="/images/MyBatis/image-20201113212424872.png" srcset="/img/loading.gif" alt="image-20201113212424872"></strong></p>
<h4 id="æŒ‰ç…§ç»“æœæŸ¥è¯¢å¤„ç†"><a href="#æŒ‰ç…§ç»“æœæŸ¥è¯¢å¤„ç†" class="headerlink" title="æŒ‰ç…§ç»“æœæŸ¥è¯¢å¤„ç†"></a>æŒ‰ç…§ç»“æœæŸ¥è¯¢å¤„ç†</h4><p>ç±»ä¼¼ï¼šè¿è¡¨æŸ¥è¯¢</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æŒ‰ç…§ç»“æœåµŒå¥—å¤„ç†--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getStudents2&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;Student_Teacher2&quot;</span>&gt;</span>
  select student.id sid,student.name sname,teacher.name tname
  from student,teacher
  where student.tid = teacher.id
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>


<span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Student_Teacher2&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sid&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sname&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">association</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;teacher&quot;</span> <span class="hljs-attr">javaType</span>=<span class="hljs-string">&quot;Teacher&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tname&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">association</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span></code></pre>

<img src="/images/MyBatis/image-20201113212534960.png" srcset="/img/loading.gif" alt="image-20201113212534960" style="zoom:50%;" />

<h3 id="10-2-ä¸€å¯¹å¤šå¤„ç†"><a href="#10-2-ä¸€å¯¹å¤šå¤„ç†" class="headerlink" title="10.2 ä¸€å¯¹å¤šå¤„ç†"></a>10.2 ä¸€å¯¹å¤šå¤„ç†</h3><img src="/images/MyBatis/image-20201113212823953.png" srcset="/img/loading.gif" alt="image-20201113212823953" style="zoom:50%;" />

<pre><code class="hljs java"><span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-comment">//ä¸€å¯¹å¤š</span>
    <span class="hljs-keyword">private</span> List&lt;Student&gt; students;
&#125;

<span class="hljs-meta">@Data</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span> </span>&#123;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> id;
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> tid;
&#125;</code></pre>

<pre><code class="hljs java">TeacherMapper.java
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">TeacherMapper</span> </span>&#123;
    <span class="hljs-comment">//è·å–ä¸€ä¸ªæŒ‡å®šè€å¸ˆä¸‹çš„æ‰€æœ‰å­¦ç”ŸåŠè€å¸ˆçš„ä¿¡æ¯</span>
    <span class="hljs-function">Teacher <span class="hljs-title">getTeacher</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;tid&quot;)</span> <span class="hljs-keyword">int</span> id)</span></span>;
&#125;</code></pre>

<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;getTeacher&quot;</span> <span class="hljs-attr">resultMap</span>=<span class="hljs-string">&quot;Teacher_Student&quot;</span>&gt;</span>
  select student.id sid, student.name sname, teacher.name tname, teacher.id tid
  from student,teacher
  where student.tid = teacher.id
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">resultMap</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;Teacher_Student&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;Teacher&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tname&quot;</span>/&gt;</span>
  <span class="hljs-comment">&lt;!--é›†åˆä¸­çš„æ³›å‹ä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ofType--&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">collection</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;studentList&quot;</span> <span class="hljs-attr">ofType</span>=<span class="hljs-string">&quot;Student&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sid&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;name&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;sname&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">result</span> <span class="hljs-attr">property</span>=<span class="hljs-string">&quot;tid&quot;</span> <span class="hljs-attr">column</span>=<span class="hljs-string">&quot;tid&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">collection</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">resultMap</span>&gt;</span></code></pre>

<img src="/images/MyBatis/image-20201113222454568.png" srcset="/img/loading.gif" alt="image-20201113222454568" style="zoom:50%;" />

<p>//æŒ‰ç…§æŸ¥è¯¢åµŒå¥—å¤„ç†å°±ä¸ç¼–ç äº†ï¼Œå¤ªéº»çƒ¦äº†ï¼ï¼<img src="/images/MyBatis/image-20201113222953722.png" srcset="/img/loading.gif" alt="image-20201113222953722"></p>
<h3 id="10-3-å°ç»“"><a href="#10-3-å°ç»“" class="headerlink" title="10.3 å°ç»“"></a>10.3 å°ç»“</h3><ol>
<li>å…³è” - association  ã€å¤šå¯¹ä¸€ã€‘</li>
<li>é›†åˆ - collection ã€ä¸€å¯¹å¤šã€‘</li>
<li>javaType  &amp;&amp; ofType<ol>
<li>javaTypeç”¨æ¥æŒ‡å®šå®ä½“ç±»ä¸­çš„å±æ€§çš„ç±»å‹</li>
<li>ofType ç”¨æ¥æŒ‡å®šæ˜ å°„åˆ°Listæˆ–è€…é›†åˆä¸­çš„pojoç±»å‹ï¼Œæ³›å‹ä¸­çº¦æŸç±»å‹ï¼</li>
</ol>
</li>
</ol>
<p><strong>æ³¨æ„ç‚¹ï¼š</strong></p>
<ul>
<li>ä¿è¯SQLçš„å¯è¯»æ€§ï¼Œé€šä¿—æ˜“æ‡‚</li>
<li>æ³¨æ„ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€ä¸­ï¼Œå±æ€§åå’Œå­—æ®µçš„é—®é¢˜</li>
<li>å¦‚æœé—®é¢˜ä¸å¥½æ’æŸ¥é”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨æ—¥å¿—ï¼Œå»ºè®®ä½¿ç”¨Log4j</li>
</ul>
<p><strong>é¢è¯•é«˜é¢‘ï¼š</strong></p>
<ul>
<li>MySqlå¼•æ“</li>
<li>InnoDBåº•å±‚åŸç†</li>
<li>ç´¢å¼•</li>
<li>ç´¢å¼•ä¼˜åŒ–</li>
</ul>
<h2 id="11-åŠ¨æ€SQL"><a href="#11-åŠ¨æ€SQL" class="headerlink" title="11. åŠ¨æ€SQL"></a>11. åŠ¨æ€SQL</h2><p><strong>åŠ¨æ€SQLï¼šæ ¹æ®ä¸åŒçš„æ¡ä»¶ç”Ÿæˆä¸åŒçš„SQLè¯­å¥ã€‚</strong></p>
<p>åŠ¨æ€ SQL æ˜¯ MyBatis çš„å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡ JDBC æˆ–å…¶å®ƒç±»ä¼¼çš„æ¡†æ¶ï¼Œä½ åº”è¯¥èƒ½ç†è§£æ ¹æ®ä¸åŒæ¡ä»¶æ‹¼æ¥ SQL è¯­å¥æœ‰å¤šç—›è‹¦ï¼Œä¾‹å¦‚æ‹¼æ¥æ—¶è¦ç¡®ä¿ä¸èƒ½å¿˜è®°æ·»åŠ å¿…è¦çš„ç©ºæ ¼ï¼Œè¿˜è¦æ³¨æ„å»æ‰åˆ—è¡¨æœ€åä¸€ä¸ªåˆ—åçš„é€—å·ã€‚åˆ©ç”¨åŠ¨æ€ SQLï¼Œå¯ä»¥å½»åº•æ‘†è„±è¿™ç§ç—›è‹¦ã€‚</p>
<p>ä½¿ç”¨åŠ¨æ€ SQL å¹¶éä¸€ä»¶æ˜“äº‹ï¼Œä½†å€ŸåŠ©å¯ç”¨äºä»»ä½• SQL æ˜ å°„è¯­å¥ä¸­çš„å¼ºå¤§çš„åŠ¨æ€ SQL è¯­è¨€ï¼ŒMyBatis æ˜¾è‘—åœ°æå‡äº†è¿™ä¸€ç‰¹æ€§çš„æ˜“ç”¨æ€§ã€‚</p>
<p>å¦‚æœä½ ä¹‹å‰ç”¨è¿‡ JSTL æˆ–ä»»ä½•åŸºäºç±» XML è¯­è¨€çš„æ–‡æœ¬å¤„ç†å™¨ï¼Œä½ å¯¹åŠ¨æ€ SQL å…ƒç´ å¯èƒ½ä¼šæ„Ÿè§‰ä¼¼æ›¾ç›¸è¯†ã€‚åœ¨ MyBatis ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œéœ€è¦èŠ±æ—¶é—´äº†è§£å¤§é‡çš„å…ƒç´ ã€‚å€ŸåŠ©åŠŸèƒ½å¼ºå¤§çš„åŸºäº OGNL çš„è¡¨è¾¾å¼ï¼ŒMyBatis 3 æ›¿æ¢äº†ä¹‹å‰çš„å¤§éƒ¨åˆ†å…ƒç´ ï¼Œå¤§å¤§ç²¾ç®€äº†å…ƒç´ ç§ç±»ï¼Œç°åœ¨è¦å­¦ä¹ çš„å…ƒç´ ç§ç±»æ¯”åŸæ¥çš„ä¸€åŠè¿˜è¦å°‘ã€‚</p>
<ul>
<li>if</li>
<li>choose (when, otherwise)</li>
<li>trim (where, set)</li>
<li>foreachï¼ˆæœ€ç—›è‹¦ï¼‰</li>
</ul>
<h3 id="11-1-ç¯å¢ƒæ­å»º"><a href="#11-1-ç¯å¢ƒæ­å»º" class="headerlink" title="11.1 ç¯å¢ƒæ­å»º"></a>11.1 ç¯å¢ƒæ­å»º</h3><p><strong>åˆ›å»ºblogè¡¨</strong></p>
<pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> blog(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">comment</span> <span class="hljs-string">&#x27;åšå®¢id&#x27;</span>,
    title <span class="hljs-built_in">varchar</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">comment</span> <span class="hljs-string">&#x27;åšå®¢æ ‡é¢˜&#x27;</span>,
    author <span class="hljs-built_in">varchar</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">comment</span> <span class="hljs-string">&#x27;åšå®¢ä½œè€…&#x27;</span>,
    create_time datetime <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">comment</span> <span class="hljs-string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,
    views <span class="hljs-built_in">int</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">not</span> <span class="hljs-literal">null</span> <span class="hljs-keyword">comment</span> <span class="hljs-string">&#x27;æµè§ˆé‡&#x27;</span>
)<span class="hljs-keyword">engine</span> = <span class="hljs-keyword">innodb</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">charset</span> = utf8</code></pre>

<p>åˆ›å»ºä¸€ä¸ªåŸºç¡€å·¥ç¨‹</p>
<ol>
<li>å¯¼åŒ…</li>
<li>ç¼–å†™é…ç½®æ–‡ä»¶</li>
<li>ç¼–å†™å®ä½“ç±»</li>
</ol>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Blog</span> </span>&#123;
    <span class="hljs-keyword">private</span> String id;
    <span class="hljs-keyword">private</span> String title;
    <span class="hljs-keyword">private</span> String author;
    <span class="hljs-keyword">private</span> Date createTime;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> views;
&#125;</code></pre>

<ol start="4">
<li>ç¼–å†™å®ä½“ç±»å¯¹åº”çš„æ¥å£åŠMapperæ–‡ä»¶</li>
</ol>
<h3 id="11-2-ifè¯­å¥"><a href="#11-2-ifè¯­å¥" class="headerlink" title="11.2 ifè¯­å¥"></a>11.2 ifè¯­å¥</h3><pre><code class="hljs java"><span class="hljs-comment">/*</span>
<span class="hljs-comment">* å¦‚æœmapä¸­ä¼ é€’çš„æ˜¯titleï¼Œåˆ™æŸ¥æ‰¾å‡ºæ‰€æœ‰titleçš„ä¹¦ç±</span>
<span class="hljs-comment">* å¦‚æœä¼ é€’çš„æ˜¯authorï¼Œåˆ™æŸ¥æ‰¾å‡ºæ‰€æœ‰authorçš„ä¹¦ç±</span>
<span class="hljs-comment">* å¦åˆ™æŸ¥æ‰¾æ‰€æœ‰ä¹¦ç±*/</span>
<span class="hljs-function">List&lt;Blog&gt; <span class="hljs-title">queryBlogIF</span><span class="hljs-params">(Map map)</span></span>;</code></pre>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogIF&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.Blog&quot;</span>&gt;</span>
  select * from blog
  <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span>
      title = #&#123;title&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span>
      and author = #&#123;author&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span></code></pre>

<p><em>where</em> å…ƒç´ åªä¼šåœ¨å­å…ƒç´ è¿”å›ä»»ä½•å†…å®¹çš„æƒ…å†µä¸‹æ‰æ’å…¥ â€œWHEREâ€ å­å¥ã€‚è€Œä¸”ï¼Œè‹¥å­å¥çš„å¼€å¤´ä¸º â€œANDâ€ æˆ– â€œORâ€ï¼Œ<em>where</em> å…ƒç´ ä¹Ÿä¼šå°†å®ƒä»¬å»é™¤ã€‚</p>
<p>è¯´ç™½äº†ï¼Œ<em>where</em>å¯ä»¥æ™ºèƒ½åŒ–ä¿è¯<em>sql</em>è¯­å¥çš„æ­£ç¡®ï¼ï¼<img src="/images/MyBatis/image-20201114084842350.png" srcset="/img/loading.gif" alt="image-20201114084842350" style="zoom:50%;" /></p>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
    SqlSession sqlSession = MybatisUtils.getSqlSession();
    BlogMapper mapper = sqlSession.getMapper(BlogMapper.class);
    HashMap map = <span class="hljs-keyword">new</span> HashMap();
    map.put(<span class="hljs-string">&quot;author&quot;</span>,<span class="hljs-string">&quot;é‡è§ç‹‚ç¥è¯´&quot;</span>);
    List&lt;Blog&gt; blogs = mapper.queryBlogIF(map);
    <span class="hljs-keyword">for</span> (Blog blog : blogs) &#123;
        System.out.println(blog.getTitle());
    &#125;

    sqlSession.close();

&#125;</code></pre>

<h3 id="11-3-å¸¸ç”¨æ ‡ç­¾"><a href="#11-3-å¸¸ç”¨æ ‡ç­¾" class="headerlink" title="11.3 å¸¸ç”¨æ ‡ç­¾"></a>11.3 å¸¸ç”¨æ ‡ç­¾</h3><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸æƒ³ä½¿ç”¨æ‰€æœ‰çš„æ¡ä»¶ï¼Œè€Œåªæ˜¯æƒ³ä»å¤šä¸ªæ¡ä»¶ä¸­é€‰æ‹©ä¸€ä¸ªä½¿ç”¨ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œ<em>MyBatis</em> æä¾›äº† choose å…ƒç´ ï¼Œå®ƒæœ‰ç‚¹åƒ Java ä¸­çš„ switch è¯­å¥ã€‚</p>
<h4 id="choose-when-otherwise"><a href="#choose-when-otherwise" class="headerlink" title="choose  when otherwise"></a><strong><em>choose  when otherwise</em></strong></h4><pre><code class="hljs xml">    <span class="hljs-comment">&lt;!--</span>
<span class="hljs-comment">    æŒ‰é¡ºåºæ‰§è¡Œç¬¬ä¸€ä¸ªç¬¦åˆçš„æ¡ä»¶</span>
<span class="hljs-comment">    --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBlogIF&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.Blog&quot;</span>&gt;</span>
  select * from blog
  <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">choose</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span>
        title = #&#123;title&#125;
      <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">when</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span>
        and author = #&#123;author&#125;/*è¿™ä¸ªandä¸åŠ å¥½åƒä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯æœ€å¥½è§„èŒƒå†™ä»£ç ï¼ŒåŠ ä¸Šandæœ€å¥½*/
      <span class="hljs-tag">&lt;/<span class="hljs-name">when</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">otherwise</span>&gt;</span>
        and views &gt; #&#123;views&#125;
      <span class="hljs-tag">&lt;/<span class="hljs-name">otherwise</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">choose</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<h4 id="set"><a href="#set" class="headerlink" title="set"></a><strong><em>set</em></strong></h4><p><em>set</em> å…ƒç´ ä¼šåŠ¨æ€åœ°åœ¨è¡Œé¦–æ’å…¥ SET å…³é”®å­—ï¼Œå¹¶ä¼šåˆ æ‰é¢å¤–çš„é€—å·ï¼ˆè¿™äº›é€—å·æ˜¯åœ¨ä½¿ç”¨æ¡ä»¶è¯­å¥ç»™åˆ—èµ‹å€¼æ—¶å¼•å…¥çš„ï¼‰</p>
<pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">update</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updateBlogSet&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span>
  update mybatis.blog
  <span class="hljs-tag">&lt;<span class="hljs-name">set</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;title != null&quot;</span>&gt;</span> title = #&#123;title&#125;,<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">if</span> <span class="hljs-attr">test</span>=<span class="hljs-string">&quot;author != null&quot;</span>&gt;</span> author = #&#123;author&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">if</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">set</span>&gt;</span>
  where id = #&#123;id&#125;
<span class="hljs-tag">&lt;/<span class="hljs-name">update</span>&gt;</span></code></pre>

<p><strong>ç¬¬ä¸€å¥ä¸­çš„if é€—å·,å¿…é¡»åŠ ä¸Šï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ï¼</strong></p>
<img src="/images/MyBatis/image-20201114090943589.png" srcset="/img/loading.gif" alt="image-20201114090943589" style="zoom:50%;" />

<p><strong>ä¸Šè¿°æƒ…å†µä¼šæŠ¥é”™ï¼å› ä¸ºupdateæ˜¯ä¸èƒ½æ²¡æœ‰setè¯­å¥çš„ï¼ï¼</strong></p>
<p>æ‰€è°“çš„åŠ¨æ€SQLï¼Œæœ¬è´¨è¿˜æ˜¯SQLè¯­å¥ï¼Œåªæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨SQLå±‚é¢å»æ‰§è¡Œä¸€ä¸ªé€»è¾‘ä»£ç ã€‚</p>
<p><em>if where set choose otherwise when</em></p>
<h3 id="11-4-SQLç‰‡æ®µ-å¤ç”¨"><a href="#11-4-SQLç‰‡æ®µ-å¤ç”¨" class="headerlink" title="11.4 SQLç‰‡æ®µ-å¤ç”¨"></a>11.4 SQLç‰‡æ®µ-å¤ç”¨</h3><p>æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå°†ä¸€äº›å…¬å…±çš„éƒ¨åˆ†æŠ½å–å‡ºæ¥ï¼Œæ–¹ä¾¿å¤ç”¨ï¼</p>
<img src="/images/MyBatis/image-20201114102501988.png" srcset="/img/loading.gif" alt="image-20201114102501988" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201114102529314.png" srcset="/img/loading.gif" alt="image-20201114102529314" style="zoom:50%;" />

<ul>
<li>ä½¿ç”¨sqlæ ‡ç­¾æŠ½å–å…¬å…±éƒ¨åˆ†</li>
<li>åœ¨éœ€è¦çš„åœ°æ–¹ä½¿ç”¨includeæ ‡ç­¾å¼•å…¥</li>
</ul>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>æœ€å¥½åŸºäºå•è¡¨æ¥å®šä¹‰sqlç‰‡æ®µ</li>
<li>ä¸è¦å­˜åœ¨whereæ ‡ç­¾</li>
</ul>
<h3 id="11-5-foreachè¯­å¥"><a href="#11-5-foreachè¯­å¥" class="headerlink" title="11.5 foreachè¯­å¥"></a>11.5 foreachè¯­å¥</h3><p>åŠ¨æ€ SQL çš„å¦ä¸€ä¸ªå¸¸è§ä½¿ç”¨åœºæ™¯æ˜¯å¯¹é›†åˆè¿›è¡Œéå†ï¼ˆå°¤å…¶æ˜¯åœ¨æ„å»º IN æ¡ä»¶è¯­å¥çš„æ—¶å€™ï¼‰</p>
<img src="/images/MyBatis/image-20201114102950034.png" srcset="/img/loading.gif" alt="image-20201114102950034" style="zoom:50%;" />

<p>e.g.(æºäºæ‹‰ä¸æ–‡ï¼Œæ˜¯for exampleçš„ç®€å†™)</p>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æˆ‘ä»¬ä¼ é€’ä¸€ä¸ªmap,mapä¸­å¯ä»¥å­˜åœ¨ä¸€ä¸ªé›†åˆ</span>
<span class="hljs-comment">        select * from blog where (id=1 or id=2)</span>
<span class="hljs-comment">    --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;queryBogForEach&quot;</span> <span class="hljs-attr">resultType</span>=<span class="hljs-string">&quot;com.wen.pojo.Blog&quot;</span> <span class="hljs-attr">parameterType</span>=<span class="hljs-string">&quot;map&quot;</span>&gt;</span>
  select * from mybatis.blog
  <span class="hljs-tag">&lt;<span class="hljs-name">where</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">foreach</span> <span class="hljs-attr">collection</span>=<span class="hljs-string">&quot;ids&quot;</span> <span class="hljs-attr">item</span>=<span class="hljs-string">&quot;id&quot;</span> <span class="hljs-attr">open</span>=<span class="hljs-string">&quot;(&quot;</span> <span class="hljs-attr">separator</span>=<span class="hljs-string">&quot;or&quot;</span> <span class="hljs-attr">close</span>=<span class="hljs-string">&quot;)&quot;</span>&gt;</span>
      id = #&#123;id&#125;
    <span class="hljs-tag">&lt;/<span class="hljs-name">foreach</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">where</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></code></pre>

<p>æµ‹è¯•ï¼š</p>
<pre><code class="hljs java"><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span>&#123;
  SqlSession sqlSession = MybatisUtils.getSqlSession();
  BlogMapper mapper = sqlSession.getMapper(BlogMapper.class);
  HashMap map = <span class="hljs-keyword">new</span> HashMap();
  ArrayList&lt;String&gt; ids = <span class="hljs-keyword">new</span> ArrayList&lt;String&gt;();
  ids.add(<span class="hljs-string">&quot;1&quot;</span>);
  ids.add(<span class="hljs-string">&quot;2&quot;</span>);
  map.put(<span class="hljs-string">&quot;ids&quot;</span>, ids);
  List&lt;Blog&gt; blogs = mapper.queryBogForEach(map);
  <span class="hljs-keyword">for</span> (Blog blog : blogs) &#123;
    System.out.println(blog.getTitle());
  &#125;
  sqlSession.close();
&#125;</code></pre>

<p>==åŠ¨æ€SQLå°±æ˜¯åœ¨æ‹¼æ¥SQLè¯­å¥ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿è¯SQLçš„æ­£ç¡®æ€§ï¼ŒæŒ‰ç…§SQLçš„æ ¼å¼ï¼Œå»æ’åˆ—ç»„åˆå°±å¯ä»¥äº†ï¼==</p>
<p>å»ºè®®ï¼š</p>
<ul>
<li>å…ˆåœ¨mysqlä¸­å†™å‡ºå®Œæ•´çš„SQLï¼Œæµ‹è¯•æˆåŠŸåï¼Œå†å¯¹åº”çš„å»ä¿®æ”¹æˆä¸ºæˆ‘ä»¬çš„åŠ¨æ€SQLå®ç°é€šç”¨ã€‚</li>
</ul>
<h2 id="12-ç¼“å­˜"><a href="#12-ç¼“å­˜" class="headerlink" title="12. ç¼“å­˜"></a>12. ç¼“å­˜</h2><h3 id="12-1-ç®€ä»‹"><a href="#12-1-ç®€ä»‹" class="headerlink" title="12.1 ç®€ä»‹"></a>12.1 ç®€ä»‹</h3><p>æŸ¥è¯¢ï¼šè¿æ¥æ•°æ®åº“-&gt;æ¶ˆè€—èµ„æºï¼ï¼</p>
<p>è§£å†³ï¼šä¸€æ¬¡æŸ¥è¯¢çš„ç»“æœå¯ä»¥æš‚å­˜åœ¨ä¸€ä¸ªå¯ä»¥ç›´æ¥å–åˆ°çš„åœ°æ–¹-&gt;æ”¾å…¥å†…å­˜</p>
<p>å†æ¬¡æŸ¥è¯¢æ—¶ï¼Œç›´æ¥èµ°ç¼“å­˜ï¼Œå°±ä¸éœ€è¦èµ°æ•°æ®åº“ã€‚</p>
<ol>
<li><p><strong>ä»€ä¹ˆæ˜¯ç¼“å­˜[cache]ï¼Ÿ</strong></p>
<p>-å­˜åœ¨å†…å­˜ä¸­çš„ä¸´æ—¶æ•°æ®</p>
<p>-å°†ç”¨æˆ·ç»å¸¸æŸ¥è¯¢çš„æ•°æ®æ”¾åœ¨ç¼“å­˜ï¼ˆå†…å­˜ï¼‰ä¸­ï¼Œç”¨æˆ·å»æŸ¥è¯¢æ•°æ®å°±ä¸ç”¨ä»ç£ç›˜ä¸Šï¼ˆå…³ç³»å‹æ•°æ®åº“æ•°æ®æ–‡ä»¶ï¼‰æŸ¥è¯¢ï¼Œä»ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œè§£å†³äº†é«˜å¹¶å‘ç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚</p>
</li>
<li><p>ä¸ºä»€ä¹ˆä½¿ç”¨ç¼“å­˜ï¼Ÿ</p>
<p>å‡å°‘å’Œæ•°æ®åº“çš„äº¤æ¢æ¬¡æ•°ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œæé«˜ç³»ç»Ÿæ•ˆç‡</p>
</li>
<li><p><strong>ä»€ä¹ˆæ ·çš„æ•°æ®èƒ½ä½¿ç”¨ç¼“å­˜ï¼Ÿ</strong></p>
<p>ç»å¸¸æŸ¥è¯¢å¹¶ä¸”ä¸ç»å¸¸æ”¹å˜çš„æ•°æ®ã€‚</p>
</li>
</ol>
<h3 id="12-2-MyBatisç¼“å­˜"><a href="#12-2-MyBatisç¼“å­˜" class="headerlink" title="12.2 MyBatisç¼“å­˜"></a>12.2 MyBatisç¼“å­˜</h3><ul>
<li><p>MyBatisåŒ…å«ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æŸ¥è¯¢ç¼“å­˜ç‰¹æ€§ï¼Œä»–å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å®šåˆ¶å’Œé…ç½®ç¼“å­˜ã€‚ç¼“å­˜å¯ä»¥æå¤§çš„æå‡æŸ¥è¯¢æ•ˆç‡</p>
</li>
<li><p>MyBatisç³»ç»Ÿä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ï¼š<strong>ä¸€çº§ç¼“å­˜</strong>å’Œ<strong>äºŒçº§ç¼“å­˜</strong>ã€‚</p>
<ul>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜å¼€å¯ã€‚ï¼ˆSqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œä¹Ÿç§°ä¸ºæœ¬åœ°ç¼“å­˜ï¼‰</p>
</li>
<li><p>äºŒçº§ç¼“å­˜éœ€è¦<strong>æ‰‹åŠ¨</strong>å¼€å¯å’Œé…ç½®ï¼Œå®ƒæ˜¯åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ã€‚</p>
</li>
<li><p>ä¸ºäº†æé«˜æ‰©å±•æ€§ï¼ŒMyBatiså®šä¹‰äº†ç¼“å­˜æ¥å£Cacheã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Cacheæ¥å£æ¥å®šä¹‰äºŒçº§ç¼“å­˜ã€‚</p>
</li>
</ul>
</li>
</ul>
<p>  Cacheæ˜¯ä¸€ä¸ªæ¥å£interface,</p>
<pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">Cache</span> </span>&#123;
    <span class="hljs-function">String <span class="hljs-title">getId</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">putObject</span><span class="hljs-params">(Object var1, Object var2)</span></span>;

    <span class="hljs-function">Object <span class="hljs-title">getObject</span><span class="hljs-params">(Object var1)</span></span>;

    <span class="hljs-function">Object <span class="hljs-title">removeObject</span><span class="hljs-params">(Object var1)</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getSize</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">default</span> ReadWriteLock <span class="hljs-title">getReadWriteLock</span><span class="hljs-params">()</span> </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    &#125;
&#125;</code></pre>

<h3 id="12-3ä¸€çº§ç¼“å­˜"><a href="#12-3ä¸€çº§ç¼“å­˜" class="headerlink" title="12.3ä¸€çº§ç¼“å­˜"></a>12.3ä¸€çº§ç¼“å­˜</h3><img src="/images/MyBatis/image-20201114124103438.png" srcset="/img/loading.gif" alt="image-20201114124103438" style="zoom:50%;" />

<p>ç¼“å­˜å¤±æ•ˆçš„æƒ…å†µï¼š</p>
<ul>
<li>æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰ select è¯­å¥çš„ç»“æœå°†ä¼šè¢«ç¼“å­˜ã€‚</li>
<li>æ˜ å°„è¯­å¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰ insertã€update å’Œ delete è¯­å¥ä¼šåˆ·æ–°ç¼“å­˜ã€‚å› ä¸ºå¢åˆ æ”¹æ“ä½œæœ‰å¯èƒ½ä¼šæ”¹å˜æ•°æ®åº“çš„æ•°æ®ã€‚</li>
<li>æŸ¥è¯¢ä¸åŒçš„Mapper.xmlã€‚</li>
<li>æ‰‹åŠ¨æ¸…ç†ç¼“å­˜ï¼</li>
</ul>
<pre><code class="hljs java">sqlSession.clearCache();</code></pre>

<p><strong>å°ç»“ï¼š</strong></p>
<p>ä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªåœ¨ä¸€æ¬¡SqlSessionä¸­æœ‰æ•ˆï¼Œä¹Ÿå°±æ˜¯åœ¨è¿æ¥-&gt;å…³é—­è¿æ¥è¿™ä¸ªæ—¶é—´æ®µã€‚</p>
<p>ä¸€çº§ç¼“å­˜å°±æ˜¯ä¸€ä¸ªMapã€‚ï¼ˆä¸€çº§ç¼“å­˜åˆç§°æœ¬åœ°çš„ä¼šè¯ç¼“å­˜ã€‚ï¼‰</p>
<h3 id="12-4-äºŒçº§ç¼“å­˜"><a href="#12-4-äºŒçº§ç¼“å­˜" class="headerlink" title="12.4 äºŒçº§ç¼“å­˜"></a>12.4 äºŒçº§ç¼“å­˜</h3><ul>
<li>äºŒçº§ç¼“å­˜ä¹Ÿå°±å…¨å±€ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä½œç”¨åŸŸå¤ªä½äº†ï¼Œæ‰€ä»¥è¯ç”Ÿäº†äºŒçº§ç¼“å­˜ã€‚</li>
<li>åŸºäºnamespaceçº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ªå‘½åç©ºé—´ï¼Œå¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ã€‚</li>
<li>å·¥ä½œæœºåˆ¶<ul>
<li>ä¸€ä¸ªä¼šè¯æŸ¥è¯¢ä¸€æ¡æ•°æ®æ—¶ï¼Œè¿™ä¸ªæ•°æ®å°±ä¼šè¢«æ”¾åœ¨å½“å‰ä¼šè¯çš„ä¸€çº§ç¼“å­˜ä¸­ï¼›</li>
<li>å¦‚æœå½“å‰ä¼šè¯å…³é—­äº†ï¼Œè¿™ä¸ªä¼šè¯å¯¹åº”çš„ä¸€çº§ç¼“å­˜å°±æ²¡äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ˜¯(äºŒçº§ç¼“å­˜çš„æœºåˆ¶)ï¼Œä¸€çº§ç¼“å­˜ä¼šè¯å…³é—­äº†ï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®è¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼›</li>
<li>æ–°çš„ä¼šè¯æŸ¥è¯¢ä¿¡æ¯ï¼Œå°±å¯ä»¥ä»äºŒçº§ç¼“å­˜ä¸­è·å–å†…å®¹ï¼›</li>
<li>ä¸åŒçš„mapperæŸ¥å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜mapä¸­ã€‚</li>
</ul>
</li>
</ul>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>å¼€å¯å…¨å±€ç¼“å­˜</li>
</ol>
<pre><code class="hljs xml"><span class="hljs-comment">&lt;!--æ˜¾ç¤ºçš„è®¾ç½®å…¨å±€ç¼“å­˜--&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;cacheEnabled&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;true&quot;</span>/&gt;</span></code></pre>

<ol start="2">
<li>åœ¨è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„mapperæ–‡ä»¶ä¸­å¼€å¯ï¼</li>
</ol>
<p><img src="/images/MyBatis/image-20201114162610558.png" srcset="/img/loading.gif" alt="image-20201114162610558"></p>
<p>ä¹Ÿå¯ä»¥è‡ªå®šå‚æ•°ï¼š</p>
<pre><code class="hljs xml">&lt;cache
  eviction=&quot;FIFO&quot;
  flushInterval=&quot;60000&quot;
  size=&quot;512&quot;
  readOnly=&quot;true&quot;/&gt;</code></pre>

<p>å¯ç”¨çš„æ¸…é™¤ç­–ç•¥æœ‰ï¼š</p>
<ul>
<li><code>LRU</code> â€“ æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼šç§»é™¤æœ€é•¿æ—¶é—´ä¸è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚</li>
<li><code>FIFO</code> â€“ å…ˆè¿›å…ˆå‡ºï¼šæŒ‰å¯¹è±¡è¿›å…¥ç¼“å­˜çš„é¡ºåºæ¥ç§»é™¤å®ƒä»¬ã€‚</li>
<li><code>SOFT</code> â€“ è½¯å¼•ç”¨ï¼šåŸºäºåƒåœ¾å›æ”¶å™¨çŠ¶æ€å’Œè½¯å¼•ç”¨è§„åˆ™ç§»é™¤å¯¹è±¡ã€‚</li>
<li><code>WEAK</code> â€“ å¼±å¼•ç”¨ï¼šæ›´ç§¯æåœ°åŸºäºåƒåœ¾æ”¶é›†å™¨çŠ¶æ€å’Œå¼±å¼•ç”¨è§„åˆ™ç§»é™¤å¯¹è±¡ã€‚</li>
</ul>
<p>é»˜è®¤çš„æ¸…é™¤ç­–ç•¥æ˜¯ LRUã€‚</p>
<p>flushIntervalï¼ˆåˆ·æ–°é—´éš”ï¼‰å±æ€§å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„çš„æ­£æ•´æ•°ï¼Œè®¾ç½®çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªä»¥æ¯«ç§’ä¸ºå•ä½çš„åˆç†æ—¶é—´é‡ã€‚ é»˜è®¤æƒ…å†µæ˜¯ä¸è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰åˆ·æ–°é—´éš”ï¼Œç¼“å­˜ä»…ä»…ä¼šåœ¨è°ƒç”¨è¯­å¥æ—¶åˆ·æ–°ã€‚</p>
<p>sizeï¼ˆå¼•ç”¨æ•°ç›®ï¼‰å±æ€§å¯ä»¥è¢«è®¾ç½®ä¸ºä»»æ„æ­£æ•´æ•°ï¼Œè¦æ³¨æ„æ¬²ç¼“å­˜å¯¹è±¡çš„å¤§å°å’Œè¿è¡Œç¯å¢ƒä¸­å¯ç”¨çš„å†…å­˜èµ„æºã€‚é»˜è®¤å€¼æ˜¯ 1024ã€‚</p>
<p>readOnlyï¼ˆåªè¯»ï¼‰å±æ€§å¯ä»¥è¢«è®¾ç½®ä¸º true æˆ– falseã€‚åªè¯»çš„ç¼“å­˜ä¼šç»™æ‰€æœ‰è°ƒç”¨è€…è¿”å›ç¼“å­˜å¯¹è±¡çš„ç›¸åŒå®ä¾‹ã€‚ å› æ­¤è¿™äº›å¯¹è±¡ä¸èƒ½è¢«ä¿®æ”¹ã€‚è¿™å°±æä¾›äº†å¯è§‚çš„æ€§èƒ½æå‡ã€‚è€Œå¯è¯»å†™çš„ç¼“å­˜ä¼šï¼ˆé€šè¿‡åºåˆ—åŒ–ï¼‰è¿”å›ç¼“å­˜å¯¹è±¡çš„æ‹·è´ã€‚ é€Ÿåº¦ä¸Šä¼šæ…¢ä¸€äº›ï¼Œä½†æ˜¯æ›´å®‰å…¨ï¼Œå› æ­¤é»˜è®¤å€¼æ˜¯ falseã€‚</p>
<ol start="3">
<li>æµ‹è¯•</li>
</ol>
<img src="/images/MyBatis/image-20201114163546331.png" srcset="/img/loading.gif" alt="image-20201114163546331" style="zoom:50%;" />

<img src="/images/MyBatis/image-20201114163531437.png" srcset="/img/loading.gif" alt="image-20201114163531437" style="zoom:50%;" />

<p><strong>é—®é¢˜ï¼š</strong></p>
<p>æˆ‘ä»¬éœ€è¦å°†å®ä½“ç±»åºåˆ—åŒ–ï¼å¦åˆ™ä¼šæŠ¥é”™ï¼(ç¼“å­˜ã€é€šä¿¡éƒ½æœ€å¥½å°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–)</p>
<p>Error serializing object.  Cause: java.io.NotSerializableException: com.wen.pojo.User</p>
<p><strong>å°ç»“ï¼š</strong></p>
<ul>
<li>åªè¦å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œåœ¨åŒä¸€ä¸ªMapperä¸‹å°±æœ‰æ•ˆã€‚</li>
<li>æ‰€æœ‰çš„æ•°æ®éƒ½ä¼šå…ˆæ”¾åœ¨ä¸€çº§ç¼“å­˜ä¸­</li>
<li>åªæœ‰å½“ä¼šè¯æäº¤ï¼Œæˆ–è€…å…³é—­çš„æ—¶å€™ï¼Œæ‰ä¼šæäº¤åˆ°äºŒçº§ç¼“å­˜ä¸­</li>
</ul>
<h3 id="12-5-ç¼“å­˜åŸç†"><a href="#12-5-ç¼“å­˜åŸç†" class="headerlink" title="12.5 ç¼“å­˜åŸç†"></a>12.5 ç¼“å­˜åŸç†</h3><img src="/images/MyBatis/image-20201114165527710.png" srcset="/img/loading.gif" alt="image-20201114165527710" style="zoom:50%;" />

<h3 id="12-6-è‡ªå®šä¹‰ç¼“å­˜-Ehcache"><a href="#12-6-è‡ªå®šä¹‰ç¼“å­˜-Ehcache" class="headerlink" title="12.6 è‡ªå®šä¹‰ç¼“å­˜-Ehcache"></a>12.6 è‡ªå®šä¹‰ç¼“å­˜-Ehcache</h3><p>Ehcacheæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å¼€æºJavaåˆ†å¸ƒå¼ç¼“å­˜ã€‚ä¸»è¦é¢å‘é€šç”¨ç¼“å­˜,Java EEå’Œè½»é‡çº§å®¹å™¨ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ²¡äººç”¨å•Šå“ˆå“ˆå“ˆå“ˆ~<img src="/images/MyBatis/image-20201114170513447.png" srcset="/img/loading.gif" alt="image-20201114170513447"></p>
<img src="/images/MyBatis/image-20201114170535832.png" srcset="/img/loading.gif" alt="image-20201114170535832" style="zoom:50%;" />

<p>æ—¢ç„¶è¿™æ ·ï¼Œé‚£æˆ‘å°±ä¸å­¦äº†ï¼ï¼</p>
<p>Redisæ•°æ®åº“ï¼ˆéå…³ç³»å‹æ•°æ®åº“ï¼‰æ¥åšç¼“å­˜ï¼K-V</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/11/27/Spring5/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Spring5</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/11/27/hello-world/">
                        <span class="hidden-mobile">Hello World</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    document.addEventListener('DOMContentLoaded', function() {
      window.NProgress && window.NProgress.inc();
    })
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.5.3/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js" ></script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>


  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>












  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?7d2fd3d56f2287a0bda354d214258de6";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
